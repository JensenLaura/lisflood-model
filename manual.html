<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="" lang=""><head>
  
  <meta charset="utf-8">

  
  <meta name="generator" content="pandoc">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>lisflood manual</title>

  
  
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style><!--[if lt IE 9]>

    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>

  <![endif]-->
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> 
  <script>
MathJax.Hub.Config({
config: ["MMLorHTML.js"],
extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
jax: ["input/TeX"],
tex2jax: {
inlineMath: [ ['$','$'], ["\\(","\\)"] ],
displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
processEscapes: false
},
TeX: {
TagSide: "right",
TagIndent: ".8em",
MultLineWidth: "85%",
equationNumbers: {
autoNumber: "AMS",
},
unicode: {
fonts: "STIXGeneral,'Arial Unicode MS'"
}
},
showProcessingMessages: false
});
  </script>
</head><body>

<br>

<div style="text-align: center;"><img style="width: 2041px; height: 558px;" alt="EU logo" src="media/image2.png"><img style="width: 276px; height: 184px;" alt="JRC logo" src="media/image3.png"></div>

<h1 style="text-align: center;"><big style="font-family: Helvetica,Arial,sans-serif;">LISFLOOD MANUAL</big></h1>

<br>

<div style="text-align: center;"><img style="width: 557px; height: 211px;" alt="background" src="media/image5.jpg"><br>
</div>

<h1 id="disclaimer">Disclaimer</h1>

<p style="font-family: Helvetica,Arial,sans-serif;">Both the program
code and this manual have been carefully inspected before printing.
However, no warranties, either expressed or implied, are made
concerning the accuracy, completeness, reliability, usability,
performance, or fitness for any particular purpose of the information
contained in this manual, to the software described in this manual, and
to other material supplied in connection therewith. The material is
provided "as is". The entire risk as to its quality and performance is
with the user.</p>

<p style="font-family: Helvetica,Arial,sans-serif;"><strong>CONTENTS</strong></p>

<br>

<table style="font-family: Helvetica,Arial,sans-serif;" border="1" cellpadding="2" cellspacing="2" width="100%">

  <tbody>
    <tr>
      <td><a href="#introduction">1. Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#about-lisflood">About LISFLOOD <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#about-this-user-manual">About this User Manual <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#_Toc353538795">2. Process descriptions <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#overview">Overview <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#treatment-of-meteorological-input-variables">Treatment
of meteorological input variables <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#rain-and-snow">Rain and snow <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#frost-index-soil">Frost index soil <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#adressing-sub-grid-variability-in-land-cover">Adressing
sub-grid variability in land cover <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#soil-model">Soil model <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#interception">Interception <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#evaporation-of-intercepted-water">Evaporation of
intercepted water <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#water-available-for-infiltration-and-direct-runoff">Water
available for infiltration and direct runoff <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#water-uptake-by-plant-roots-and-transpiration">Water
uptake by plant roots and transpiration <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#direct-evaporation-from-the-soil-surface">Direct
evaporation from the soil surface <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#infiltration-capacity">Infiltration capacity <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preferential-bypass-flow">Preferential bypass flow <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#actual-infiltration-and-surface-runoff">Actual
infiltration and surface runoff <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#soil-moisture-redistribution">Soil moisture
redistribution <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#groundwater">Groundwater <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#routing-of-surface-runoff-to-channel">Routing of
surface runoff to channel <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#routing-of-sub-surface-runoff-to-channel">Routing
of sub-surface runoff to channel <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#channel-routing">Channel routing <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#special-simulation-options">Special simulation
options <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#installation-of-the-lisflood-model">3. Installation
of the LISFLOOD model <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#system-requirements">System requirements <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#installation-on-windows-systems">Installation on
Windows systems <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#installation-on-linux-systems">Installation on
Linux systems <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#running-the-model">Running the model <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#_Toc84077416">4. Model setup: input files <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#input-maps">Input maps <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#role-of-mask-and-channels-maps">Role of “mask” and
“channels” maps <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#map-location-attributes-and-distance-units">Map
location attributes and distance units <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#naming-of-meteorological-variable-maps">Naming of
meteorological variable maps <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#leaf-area-index-maps">Leaf area index maps <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#input-tables">Input tables <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#organisation-of-input-data">Organisation of input
data <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#generating-input-base-maps">Generating input base
maps <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#lisflood-setup-the-settings-file">5. LISFLOOD
setup: the settings file<br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#layout-of-the-settings-file">Layout of the settings
file 3</a></td>
    </tr>
    <tr>
      <td><a href="#lfuser-and-and-lfbinding-elements">lfuser and and
lfbinding elements <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#variables-in-the-lfbinding-element">Variables in
the lfbinding element <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#variables-in-the-lfuser-element">Variables in the
lfuser element <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#lfoption-element">lfoption element <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#viewing-available-options">Viewing available
options <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#defining-options">Defining options <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparing-the-settings-file">6. Preparing the
settings file <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#time-related-constants">Time-related constants <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#parameters-related-to-evapotranspiration-and-interception">Parameters
related to evapo(transpi)ration and interception <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#parameters-related-to-snow-and-frost">Parameters
related to snow and frost <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#infiltration-parameters">Infiltration parameters <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#groundwater-parameters">Groundwater parameters <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#routing-parameters">Routing parameters <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#parameters-related-to-numerics">Parameters related
to numerics <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#file-paths">File paths <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#prefixes-of-meteo-and-vegetation-related-variables">Prefixes
of meteo and vegetation related variables <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#initial-conditions">Initial conditions <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#running-the-model-1">Running the model <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#using-options">Using options <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#initialisation-of-lisflood">7. Initialisation of
LISFLOOD<br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-1">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#an-example">An example <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#setting-up-a-lisflood-run-cold-start">Setting up a
LISFLOOD run (cold start) <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#initialisation-of-the-lower-groundwater-zone">Initialisation
of the lower groundwater zone <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#lower-groundwater-zone-steady-state-storage">Lower
groundwater zone: steady state storage <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#steady-state-storage-in-practice">Steady-state
storage in practice <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#use-pre-run-to-calculate-average-recharge">Use
pre-run to calculate average recharge <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#checking-the-lower-zone-initialisation">Checking
the lower zone initialisation <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#using-a-previous-run-warm-start">Using a previous
run (warm start) <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#summary-of-lisflood-initialisation-procedure">Summary
of LISFLOOD initialisation procedure <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#output-generated-by-lisflood">8. Output generated
by LISFLOOD <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#default-lisflood-output">Default LISFLOOD outpu<br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#additional-output">Additional output <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#references">References <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#annex-1-simulation-of-reservoirs">Annex 1:
Simulation of reservoirs <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-2">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#description-of-the-reservoir-routine">Description
of the reservoir routine <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparation-of-input-data">Preparation of input
data <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparation-of-settings-file">Preparation of
settings file <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#reservoir-output-files">Reservoir output files <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#annex-2-polder-option">Annex 2: Polder option <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-3">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#description-of-the-polder-routine">Description of
the polder routine <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#regulated-and-unregulated-polders">Regulated and
unregulated polders <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparation-of-input-data-1">Preparation of input
data<br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparation-of-settings-file-1">Preparation of
settings file <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#polder-output-files">Polder output files <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#limitations">Limitations <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#annex-3-simulation-of-lakes">Annex 3: Simulation of
lakes <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-4">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#description-of-the-lake-routine">Description of the
lake routine <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#initialisation-of-the-lake-routine">Initialisation
of the lake routine <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparation-of-input-data-2">Preparation of input
data <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparation-of-settings-file-2">Preparation of
settings file <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#lake-output-files">Lake output files <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#_Toc353538887">Annex 4: Inflow hydrograph <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-5">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#description-of-the-inflow-hydrograph-routine">Description
of the inflow hydrograph routine <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#using-inflow-hydrographs">Using inflow hydrographs<br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#substituting-subcatchments-with-measured-inflow-hydrographs">Substituting
subcatchments with measured inflow hydrographs <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#exclude-subcatchments-from-maskmap">Exclude
subcatchments from MaskMap <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#make-sure-your-inflow-points-are-where-you-need-them">Make sure
your inflow points are where you need them <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#_Toc353538894">Annex 5: Double kinematic<br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-6">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#background">Background <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#double-kinematic-wave-approach">Double kinematic
wave approach <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#using-double-kinematic-wave">Using double kinematic
wave <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#automatic-change-of-the-number-of-sub-steps-optional">Automatic
change of the number of sub steps (optional) <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#_Toc353538900">Annex 6: Dynamic wave <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-7">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#time-step-selection">Time step selection <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#input-data">Input data <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#layout-of-the-cross-section-parameter-table">Layout
of the cross-section parameter table <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#using-the-dynamic-wave">Using the dynamic wave <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#annex-7-using-the-transmission-loss-option">Annex
7: Using the transmission loss option <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-8">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#description-of-the-transmission-loss-approach">Description
of the transmission loss approach <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#using-transmission-loss">Using transmission loss <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#transmission-loss-output-file">Transmission loss
output file <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#annex-8-including-water-use">Annex 8: Including
water use <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-9">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#calculation-of-water-use">Calculation of water use <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparation-of-input-data-3">Preparation of input
data <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparation-of-settings-file-3">Preparation of
settings file <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#water-use-output-files">Water use output files <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#annex-9-simulation-and-reporting-of-water-levels">Annex
9: Simulation and reporting of water levels <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-10">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#calculation-of-water-levels">Calculation of water
levels <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#reporting-of-water-levels">Reporting of water
levels <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparation-of-settings-file-4">Preparation of
settings file <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#annex-10-simulation-and-reporting-of-soil-moisture-as-pf-values">Annex
10: Simulation and reporting of soil moisture as pF values <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#introduction-11">Introduction <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#calculation-of-pf">Calculation of pF <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#reporting-of-pf">Reporting of pF <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#preparation-of-settings-file-5">Preparation of
settings file <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#annex-11-lisflood-options">Annex 11: LISFLOOD
options <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#annex-12-lisflood-input-maps-and-tables">Annex 12:
LISFLOOD input maps and tables <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#maps">Maps <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#tables">Tables <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#annex-13-lisflood-output">Annex 13: LISFLOOD output
      <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#time-series">Time series <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#maps-1">Maps <br>
      </a></td>
    </tr>
    <tr>
      <td><a href="#index">Index <br>
      </a></td>
    </tr>
  </tbody>
</table>

<h1 id="introduction"><span style="font-family: Helvetica,Arial,sans-serif;">Introduction</span></h1>

<span style="font-family: Helvetica,Arial,sans-serif;">The LISFLOOD
model is a hydrological rainfall-runoff model that is capable of
simulating the hydrological processes that occur in a catchment.
LISFLOOD has been developed by the floods group of the Natural Hazards
Project of the Joint Research Centre (JRC) of the European Commission.
The specific development objective was to produce a tool that can be
used in large and trans-national catchments for a variety of
applications, including:</span>
<ul style="font-family: Helvetica,Arial,sans-serif;">

  <li>Flood forecasting</li>
  <li>Assessing the effects of river regulation measures</li>
  <li>Assessing the effects of land-use change</li>
  <li>Assessing the effects of climate change</li>
</ul>

<span style="font-family: Helvetica,Arial,sans-serif;">Although a wide
variety of existing hydrological models are available that are suitable
for </span><em style="font-family: Helvetica,Arial,sans-serif;">each</em><span style="font-family: Helvetica,Arial,sans-serif;"> of these individual
tasks, few </span><em style="font-family: Helvetica,Arial,sans-serif;">single</em><span style="font-family: Helvetica,Arial,sans-serif;"> models are capable
of doing </span><em style="font-family: Helvetica,Arial,sans-serif;">all</em><span style="font-family: Helvetica,Arial,sans-serif;">
these jobs. Besides this, our objective requires a model that is
spatially distributed and –at least to a certain extent-
physically-based. Also, the focus of our work is on European
catchments. Since several databases exist that contain pan-European
information on soils (King </span><em style="font-family: Helvetica,Arial,sans-serif;">et al.</em><span style="font-family: Helvetica,Arial,sans-serif;">, 1997; Wösten </span><em style="font-family: Helvetica,Arial,sans-serif;">et al.</em><span style="font-family: Helvetica,Arial,sans-serif;">, 1999), land cover
(CEC, 1993), topography (Hiederer &amp; de Roo, 2003) and meteorology
(Rijks </span><em style="font-family: Helvetica,Arial,sans-serif;">et
al.</em><span style="font-family: Helvetica,Arial,sans-serif;">,
1998), it would be advantageous to have a model that makes the best
possible use of these data. Finally, the wide scope of our objective
implies that changes and extensions to the model will be required from
time to time. Therefore, it is essential to have a model code that can
be easily maintained and modified. LISFLOOD has been specifically
developed to satisfy these requirements. The model is designed to be
applied across a wide range of spatial and temporal scales. LISFLOOD is
grid-based, and applications so far have employed grid cells of as
little as 100 metres for medium-sized catchments, to 5000 metres for
modelling the whole of Europe and up to 0.1° (around 10 km) for
modelling globally. Long-term water balance can be simulated (using a
daily time step), as well as individual flood events (using hourly time
intervals, or even smaller). The output of a “water balance run” can be
used to provide the initial conditions of a “flood run”. Although the
model’s primary output product is channel discharge, all internal rate
and state variables (soil moisture, for example) can be written as
output as well. In addition, all output can be written as grids, or
time series at user-defined points or areas. The user has complete
control over how output is written, thus minimising any waste of disk
space or CPU time.</span>
<h2 style="font-family: Helvetica,Arial,sans-serif;" id="about-lisflood">About
LISFLOOD</h2>

<span style="font-family: Helvetica,Arial,sans-serif;">The LISFLOOD
model is implemented in the PCRaster Environmental Modelling language
Version 3.0.0 (Wesseling et al., 1996), wrapped in a Python based
interface. PCRaster is a raster GIS environment that has its own
high-level computer language, which allows the construction of
iterative spatio-temporal environmental models. The Python wrapper of
LISFLOOD enables the user to control the model inputs and outputs and
the selection of the model modules. This approach combines the power,
relative simplicity and maintainability of code written in the the
PCRaster Environmental Modelling language and the flexibility of
Python. LISFLOOD runs on any operating for which Python and PCRaster
are available. Currently these include 32-bits Windows (e.g. Windows
XP, Vista, 7) and a number of Linux distributions.</span>
<h2 style="font-family: Helvetica,Arial,sans-serif;" id="about-this-user-manual">About this User Manual</h2>

<span style="font-family: Helvetica,Arial,sans-serif;">This revised
User Manual documents LISFLOOD version December 1 2013, and replaces
all previous documentation of the model (e.g. van der Knijff &amp; de
Roo, 2008; de Roo </span><em style="font-family: Helvetica,Arial,sans-serif;">et. al.</em><span style="font-family: Helvetica,Arial,sans-serif;">, 2003). The scope of
this document is to give model users all the information that is needed
for successfully using LISFLOOD.
</span><br style="font-family: Helvetica,Arial,sans-serif;">

<span style="font-family: Helvetica,Arial,sans-serif;">"Process
description" chapter&nbsp; explains the theory behind the model,
including all model equations and the changes to the previous version.
The remaining chapters cover all practical aspects of working with
LISFLOOD. Chapter 3 to 8 explains how to setup LISFLOOD, how to modify
the settings and the outputs.
</span><br style="font-family: Helvetica,Arial,sans-serif;">

<span style="font-family: Helvetica,Arial,sans-serif;">A series of
Annexes at the end of this document describe some optional features
that can be activated when running the model. Most model users will not
need these features (which are disabled by default), and for the sake
of clarity we therefore decided to keep their description out of the
main text. The current document does not cover the calculation of the
potential evapo(transpi)ration rates that are needed as input to the
model. A separate pre-processor (LISVAP) exists that calculates these
variables from standard (gridded) meteorological observations. LISVAP
is documented in a separate volume (van der Knijff, 2006).</span>
<h1 style="font-family: Helvetica,Arial,sans-serif;"><span id="_Toc353538795" class="anchor"></span><strong>2. Process
descriptions</strong></h1>

<h2 style="font-family: Helvetica,Arial,sans-serif;">Overview</h2>

<p style="font-family: Helvetica,Arial,sans-serif;">Figure 2.1 gives an
overview of the structure of the LISFLOOD model. Basically, the model
is made up of the following components:</p>

<ul style="font-family: Helvetica,Arial,sans-serif;">

  <li>
    <p>a 2-layer soil water balance sub-model</p>
  </li>
  <li>
    <p>sub-models for the simulation of groundwater and subsurface flow
(using 2 parallel interconnected linear reservoirs)</p>
  </li>
  <li>
    <p>a sub-model for the routing of surface runoff to the nearest
river channel</p>
  </li>
  <li>
    <p>a sub-model for the routing of channel flow (not shown in the
Figure)</p>
  </li>
</ul>

<p style="font-family: Helvetica,Arial,sans-serif;">The processes that
are simulated by the model include snow melt (not shown in the Figure),
infiltration, interception of rainfall, leaf drainage, evaporation and
water uptake by vegetation, surface runoff, preferential flow (bypass
of soil layer), exchange of soil moisture between the two soil layers
and drainage to the groundwater, sub-surface and groundwater flow, and
flow through river channels. Each of these processes is described in
more detail in the following.</p>

<div style="text-align: center;"><img style="width: 473px; height: 555px;" alt="LF_Cycle" src="media/image4.jpg"><br>
</div>


<embed src="e:%5Cgh-pages%5C/media/image6.emf" style="width: 5.75in; height: 7.32292in; font-family: Helvetica,Arial,sans-serif;"><span style="font-family: Helvetica,Arial,sans-serif;">Figure 2.1
Overview of the LISFLOOD model. P = precipitation; Int = interception;
EWint = evaporation of intercepted water; Dint = leaf drainage; ESa =
evaporation from soil surface; Ta = transpiration (water uptake by
plant roots); INFact = infiltration; Rs = surface runoff; D1,2 =
drainage from top- to subsoil; D2,gw = drainage from subsoil to upper
groundwater zone; Dpref,gw = preferential flow to upper groundwater
zone; Duz,lz = drainage from upper- to lower groundwater zone; Quz =
outflow from upper groundwater zone; Ql = outflow from lower
groundwater zone; Dloss = loss from lower groundwater zone. Note that
snowmelt is not included in the Figure (even though it is simulated by
the model).
</span><br>

<br>

<h2 style="font-family: Helvetica,Arial,sans-serif;">Treatment of
meteorological input variables</h2>

<span style="font-family: Helvetica,Arial,sans-serif;">The
meteorological conditions provide the driving forces behind the water
balance. LISFLOOD uses the following meteorological input variables:<br>
</span>
<table style="font-family: Helvetica,Arial,sans-serif;">

  <thead>
  <tr class="header">
    <th><em>P</em></th>
    <th>:</th>
    <th>Precipitation</th>
    <th>[mm day<sup>-1</sup>]</th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><em>ET0</em></td>
      <td>:</td>
      <td>Potential (reference) evapotranspiration rate</td>
      <td>[mm day<sup>-1</sup>]</td>
    </tr>
    <tr class="even">
      <td><em>EW0</em></td>
      <td>:</td>
      <td>Potential evaporation rate from open water surface</td>
      <td>[mm day<sup>-1</sup>]</td>
    </tr>
    <tr class="odd">
      <td><em>ES0</em></td>
      <td>:</td>
      <td>Potential evaporation rate from bare soil surface</td>
      <td>[mm day<sup>-1</sup>]</td>
    </tr>
    <tr class="even">
      <td><em>T<sub>avg</sub></em></td>
      <td>:</td>
      <td>Average <em>daily</em> temperature<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></td>
      <td>[°C]</td>
    </tr>
  </tbody>
</table>

<span style="font-family: Helvetica,Arial,sans-serif;">Both
precipitation and evaporation are internally converted from </span><em style="font-family: Helvetica,Arial,sans-serif;">intensities</em><span style="font-family: Helvetica,Arial,sans-serif;"> [mm day</span><sup style="font-family: Helvetica,Arial,sans-serif;">-1</sup><span style="font-family: Helvetica,Arial,sans-serif;">] to </span><em style="font-family: Helvetica,Arial,sans-serif;">quantities per time
step</em><span style="font-family: Helvetica,Arial,sans-serif;"> [mm]
by multiplying them with the time step, </span><em style="font-family: Helvetica,Arial,sans-serif;">∆t</em><span style="font-family: Helvetica,Arial,sans-serif;"> (in days). For the
sake of consistency, all in- and outgoing fluxes will also be described
as </span><em style="font-family: Helvetica,Arial,sans-serif;">quantities
per time step</em><span style="font-family: Helvetica,Arial,sans-serif;">
[mm] in the following, unless stated otherwise. </span><em style="font-family: Helvetica,Arial,sans-serif;">ET0</em><span style="font-family: Helvetica,Arial,sans-serif;">, </span><em style="font-family: Helvetica,Arial,sans-serif;">EW0</em><span style="font-family: Helvetica,Arial,sans-serif;"> and </span><em style="font-family: Helvetica,Arial,sans-serif;">ES0</em><span style="font-family: Helvetica,Arial,sans-serif;">
can be calculated using standard meteorological observations. To this
end a dedicated pre-processing application has been developed (LISVAP),
which is documented in a separate volume (van der Knijff, 2006).</span>
<h2 style="font-family: Helvetica,Arial,sans-serif;" id="rain-and-snow">Rain
and snow</h2>

<span style="font-family: Helvetica,Arial,sans-serif;">If the average
temperature is below 1°C, all precipitation is assumed to be snow. A
snow correction factor is used to correct for undercatch of snow
precipitation. Unlike rain, snow accumulates on the soil surface until
it melts. The rate of snowmelt is estimated using a simple degree-day
factor method. Degree-day factor type snow melt models usually take the
following form (e.g. see WMO, 1986):</span>
<p>(2-1) $$\alpha <br>
</p>

<p>where <em>M</em> is the rate of snowmelt, <em>T<sub>avg</sub></em>
is the average daily temperature, <em>T<sub>m</sub></em> is some
critical temperature and <em>C<sub>m</sub></em> is a degree-day factor
[mm °C<sup>-1</sup> day<sup>-1</sup>]. Speers <em>et al.</em>
(1979) developed an extension of this equation which accounts for
accelerated snowmelt that takes place when it is raining (cited in
Young, 1985). The equation is supposed to apply when rainfall is
greater than 30 mm in 24 hours. Moreover, although the equation is
reported to work sufficiently well in forested areas, it is not valid
in areas that are above the tree line, where radiation is the main
energy source for snowmelt). LISFLOOD uses a variation on the equation
of Speers <em>et al.</em> The modified equation simply assumes that
for each mm of rainfall, the rate of snowmelt increases with 1%
(compared to a ‘dry’ situation). This yields the following equation:</p>

<p>(2-2)</p>

<p>where <em>M</em> is the snowmelt per time step [mm], <em>R</em> is
rainfall (not snow!) intensity [mm day<sup>-1</sup>], and <em>Δt</em>
is the time interval [days]. <em>T<sub>m</sub></em> has a value of 0
°C, and <em>C<sub>m</sub></em> is a degree-day factor [mm °C<sup>-1</sup>
day<sup>-1</sup>]. However, it should be stressed that the value of <em>C<sub>m</sub></em>
can actually vary greatly both in space and time (e.g. see Martinec <em>et
al</em>., 1998).</p>

<p>Therefore, in practice this parameter is often treated as a
calibration constant. A low value of C<sub>m</sub> indicates slow snow
melt. C<sub>Seasonal</sub>
is a seasonal variable melt factor which is also used in several other
models (e.g. Anderson 2006, Viviroli et&nbsp;al., 2009). There are
mainly two reasons to use a seasonally variable melt factor:</p>

<ul>

  <li>
    <p>The solar radiation has an effect on the energy balance and
varies with the time of the year.</p>
  </li>
  <li>
    <p>The albedo of the snow has a seasonal variation, because fresh
snow is more common in the mid winter and aged snow in the late
winter/spring. This produce an even greater seasonal variation in the
amount of net solar radiation</p>
  </li>
</ul>

<p>Figure 2.2 shows an example where a mean value of: 3.0 mm °C<sup>-1</sup>
d<sup>-1</sup>is used. The value of C<sub>m</sub> is reduced by 0.5 at
21<sup>st</sup> December and a 0.5 is added on the 21<sup>st</sup>
June. In between a sinus function is applied</p>


<embed src="e:%5Cgh-pages%5C/media/image9.emf" style="width: 5.51042in; height: 2.91667in;">
<p><em><strong>Figure 2.2</strong> Sinus shaped snow melt coefficient (C<sub>m</sub>)
as a function of days of year</em></p>

<p>At high altitudes, where the temperature never exceeds 1ºC, the
model accumulates snow without any reduction because of melting loss.
In these altitudes runoff from glacier melt is an important part. The
snow will accumulate and converted into firn. Then firn is converted to
ice and transported to the lower regions. This can take decades or even
hundred years. In the ablation area the ice is melted. In LISFLOOD this
process is emulated by melting the snow in higher altitudes on an
annual basis over summer. A sinus function is used to start ice melting
in summer, starting on the 15 June and ending on the 15 September (see
fig 2.3) and using the temperature of zone B (see fig 2.3.)</p>

<p><img src="e:%5Cgh-pages%5C/media/image10.png" style="width: 5.51181in; height: 2.91736in;"></p>

<p><em><strong>Figure 2.3</strong> Sinus shaped ice melt coefficient as
a function of days of year</em></p>

<p>The amount of snowmelt and icemelt together can never exceed the
actual snow cover that is present on the surface.</p>

<p>For large pixel sizes, there may be considerable sub-pixel
heterogeneity in snow accumulation and melt, which is a particular
problem if there are large elevation differences within a pixel.
Because of this, snow melt and accumulation are modelled separately for
3 separate elevation zones, which are defined at the sub-pixel level.
This is shown in Figure 2.4.</p>

<p>The division in elevation zones was changed from a uniform
distribution in the previous LISFLOOD version to a normal distribution,
which fits better to the real distribution of e.g. 100m SRTM DEM pixels
in a 5x5km grid cell. 3 elevation zones <em>A</em>, <em>B</em>, and <em>C</em>
are defined with each zone occupying one third of the pixel surface.
Assuming further that <em>T<sub>avg</sub></em> is valid for the
average pixel elevation, average temperature is extrapolated to the
centroids of the lower (<em>A</em>) and upper (<em>C</em>) elevation
zones, using a fixed temperature lapse rate, <em>L</em>,
of 0.0065 °C per meter elevation difference. Snow, snowmelt and snow
accumulation are subsequently modelled separately for each elevation
zone, assuming that temperature can be approximated by the temperature
at the centroid of each respective zone.</p>

<p><img src="e:%5Cgh-pages%5C/media/image12.png" style="width: 4.71875in; height: 4.5in;"></p>

<p><em><strong>Figure 2.4</strong> Definition of sub-pixel elevation
zones for snow accumulation and melt modelling. Snowmelt and
accumulation calculations in each zone are based on elevation (and
derived temperature) in centroid of each zone</em></p>

<p><em>StD: Standard Deviation of the DEM</em></p>

<p><em>quant: 0.9674 Quantile of the normal distribution: u<sub>0,833</sub>=0.9674</em></p>

<p><em>L temperature lapse rate.</em></p>

<h2 id="frost-index-soil">Frost index soil</h2>

<p>When the soil surface is frozen, this affects the hydrological
processes occurring near the soil surface. To estimate whether the soil
surface is frozen or not, a frost index <em>F</em> is calculated. The
equation is based on Molnau &amp; Bissell (1983, cited in Maidment
1993), and adjusted for variable time steps. The rate at which the
frost index changes is given by:</p>

<p>(2-4)</p>

<p><em>dF/dt</em> is expressed in [°C day<sup>-1</sup> day<sup>-1</sup>
]. <em>A<sub>f</sub></em> is a decay coefficient [day<sup>-1</sup>], <em>K</em>
is a a snow depth reduction coefficient [cm<sup>-1</sup>], <em>d<sub>s</sub></em>
is the (pixel-average) depth of the snow cover (expressed as mm
equivalent water depth), and <em>we<sub>s</sub></em>
is a parameter called snow water equivalent, which is the equivalent
water depth water of a snow cover (Maidment, 1993). In LISFLOOD, <em>A<sub>f</sub></em>
and <em>K</em> are set to 0.97 and 0.57 cm<sup>-1</sup> respectively,
and <em>we<sub>s</sub></em> is taken as 0.1, assuming an average snow
density of 100 kg/m<sup>3</sup>
(Maidment, 1993). The soil is considered frozen when the frost index
rises above a critical threshold of 56. For each time step the value of
<em>F</em> [°C day<sup>-1</sup>] is updated as:</p>

<p>(2-5)</p>

<p><em>F</em> is not allowed to become less than 0.</p>

<p>When the frost index rises above a threshold of 56, every soil
process is frozen and transpiration, evaporation, infiltration and the
outflow to the second soil layer and to upper groundwater layer is set
to zero. Any rainfall is bypassing the soil and transformed into
surface runoff till the frost index is equal or less than 56.</p>

<h2 id="adressing-sub-grid-variability-in-land-cover">Adressing
sub-grid variability in land cover</h2>

<p>In the previous versions of LISFLOOD a number of parameters are
linked directly to land cover classes by using lookup tables. The
spatially dominant value has been used to assign the corresponding grid
parameter values. This implies that some of the sub-grid variability in
land use, and consequently in the parameter of interest, is lost
(figure 2.5)</p>

<p><img src="e:%5Cgh-pages%5C/media/image16.png" style="width: 5.66875in; height: 1.8125in;"></p>

<p><em><strong>Figure 2.5</strong></em> Land cover aggregation approach
in previous versions of LISFLOOD</p>

<p>In order account properly for land use dynamics, some conceptual
changes have been made to render LISFLOOD more land-use sensitive. To
account for the sub-grid variability in land use, we model the
within-grid variability. In the modified version of the hydrological
model, the spatial distribution and frequency of each class is defined
as a percentage of the whole represented area of the new pixel.
Combining land cover classes and modeling aggregated classes, is known
as the concept of hydrological response units (HRU). The logic behind
this approach is that the non-linear nature of the rainfall runoff
processes on different land cover surfaces observed in reality will be
better captured. This concept is also used in models such as SWAT
(Arnold and Fohrer, 2005) and PREVAH (Viviroli et al., 2009). LISFLOOD
has been transferred a HRU approach on sub-grid level, as shown in
figure 2.6.</p>

<p><img src="e:%5Cgh-pages%5C/media/image16.png" style="width: 5.67778in; height: 3.025in;"></p>

<p><em><strong>Figure 2.6</strong></em> LISFLOOD land cover aggregation
by modelling aggregated land use classes separately: Percentages of
forest (dark green); water (blue), impervious surface (red), other
classes (light green)</p>

<h2 id="soil-model">Soil model</h2>

<p>If a part of a pixel is made up of built-up areas this will
influence that pixel’s water-balance. LISFLOOD’s ‘direct runoff
fraction’ parameter (<em>f<sub>dr</sub></em>) defines the fraction of a
pixel that is impervious. For impervious areas, LISFLOOD assumes that:</p>

<ol type="1">

  <li>
    <p>A depression storage is filled by precipitation and snowmelt and
emptied by evaporation</p>
  </li>
  <li>
    <p>Any water that is not filling the depression storage, reaches
the surface is added directly to surface runoff</p>
  </li>
  <li>
    <p>The storage capacity of the soil is zero (i.e. no soil moisture
storage in the direct runoff fraction)</p>
  </li>
  <li>
    <p>There is no groundwater storage</p>
  </li>
</ol>

<p>For open water (e.g. lakes, rivers) the water fraction parameter (f<sub>water</sub>)
defines the fraction that is covered with water (large lakes that are
in direct connection with major river channels can be modelled using
LISFLOOD’s lake option, which is described in Annex 5 of this manual).
For water covered areas, LISFLOOD assumes that:</p>

<ol type="1">

  <li>
    <p>The loss of actual evaporation is equal to the potential
evaporation on open water</p>
  </li>
  <li>
    <p>Any water that is not evaporated, reaches the surface is added
directly to surface runoff</p>
  </li>
  <li>
    <p>The storage capacity of the soil is zero (i.e. no soil moisture
storage in the water fraction)</p>
  </li>
  <li>
    <p>There is no groundwater storage</p>
  </li>
</ol>

<p>For the part of a pixel that is forest (f<sub>forest</sub>) or other
land cover (f<sub>other</sub>=1-f<sub>forest</sub>-f<sub>dr</sub>-f<sub>water</sub>)
the description of all soil- and groundwater-related processes below
(evaporation, transpiration, infiltration, preferential flow, soil
moisture redistribution and groundwater flow) are valid. While the
modelling structure for forest and other classes is the same, the
difference is the use of different map sets for leaf area index, soil
and soil hydraulic properties. Because of the nonlinear nature of the
rainfall runoff processes this should yield better results than running
the model with average parameter values. Table 2 summarises the
profiles of the four individually modelled categories of land cover
classes</p>

<p><strong>Table 2.1</strong> S<em>ummary of hydrological properties of
the four categories modelled individually in the modified version of
LISFLOOD.</em></p>

<table>

  <thead>
  <tr class="header">
    <th><strong>Category</strong></th>
    <th><strong>Evapotranspiration</strong></th>
    <th><strong>Soil</strong></th>
    <th><strong>Runoff</strong></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>Forest</td>
      <td>High level of evapo-transpiration (high Leaf area index);<br>
seasonally dependant</td>
      <td>Large rooting depth</td>
      <td>Low concentration time</td>
    </tr>
    <tr class="even">
      <td>Impervious surface</td>
      <td>Not applicable</td>
      <td>Not applicable</td>
      <td>Surface runoff but initial loss and depression storage, fast
concentration time</td>
    </tr>
    <tr class="odd">
      <td>Inland water</td>
      <td>Maximum evaporation</td>
      <td>Not applicable</td>
      <td>Fast concentration time</td>
    </tr>
    <tr class="even">
      <td>Other (agricultural areas, non-forested natural area,
pervious surface of urban areas)</td>
      <td>Evapotranspiration lower than for forest but still significant</td>
      <td>Rooting depth lower than for forest but still significant</td>
      <td>Medium concentration time</td>
    </tr>
  </tbody>
</table>

<p>If you activate any of LISFLOOD’s options for writing internal model
fluxes to time series or maps (described in Chapter 8), the model will
report the real fluxes, which are the fluxes multiplied by the
corresponding fraction. Figure 2.7 illustrates this for
evapotranspiration (evaporation and transpiration) which calculated
differently for each of this four aggregated classes. The total sum of
evapotranspiration for a pixel is calculated by adding up the fluxes
for each class multiplied by the fraction of each class.</p>


<embed src="e:%5Cgh-pages%5C/media/image28.emf" style="width: 6.12014in; height: 2.81944in;">
<p><em><strong>Figure 2.7</strong> Simulation of aggregated land cover
classes in LISFLOOD. In this example, evapotranspiration (ET) is
simulated for each aggregated class separately (ET<sub>fores</sub>t, ET<sub>dr</sub>,
ET<sub>water</sub>, ET<sub>other</sub>)</em></p>

<p>As result of the soil model you get four different surface fluxes
weighted by the corresponding fraction (f<sub>dr</sub>,f<sub>water</sub>,f<sub>forest</sub>,f<sub>other</sub>),
respectively two fluxes for the upper and lower groundwater zone and
for groundwater loss also weighted by the corresponding fraction (f<sub>forest</sub>,f<sub>other</sub>).
However a lot of the internal flux or states (e.g. preferential flow
for forested areas) can be written to disk as map or timeseries by
activate LISFLOOD’s options (described in Chapter 8).</p>

<h2 id="interception">Interception</h2>

<p>Interception is estimated using the following storage-based equation
(Aston, 1978, Merriam, 1960):</p>

<p>(2-6)</p>

<p>where <em>Int</em> [mm] is the interception per time step, <em>S<sub>max</sub></em>
[mm] is the maximum interception, <em>R</em> is the rainfall intensity
[mm day<sup>-1</sup>] and the factor <em>k</em> accounts for the
density of the vegetation. <em>S<sub>max</sub></em> is calculated
using an empirical equation (Von Hoyningen-Huene, 1981):</p>

<p>(2-7)</p>

<p>where <em>LAI</em> is the average Leaf Area Index [m<sup>2</sup> m<sup>-2</sup>]
of each model element (pixel). <em>k</em> is estimated as:</p>

<p>(2-8)</p>

<p>The value of <em>Int</em> can never exceed the interception storage
capacity, which is defined as the difference between <em>S<sub>max</sub></em>
and the accumulated amount of water that is stored as interception, <em>Int<sub>cum</sub></em>.</p>

<h2 id="evaporation-of-intercepted-water">Evaporation of intercepted
water</h2>

<p>Evaporation of intercepted water, <em>EW<sub>int</sub></em>, occurs
at the potential evaporation rate from an open water surface, <em>EW0</em>.
The <em>maximum</em> evaporation per time step is proportional to the
fraction of vegetated area in each pixel (Supit <em>et al.</em>,1994):</p>

<p>(2-9)</p>

<p>where <em>EW0</em> is the potential evaporation rate from an open
water surface [mm day<sup>-1</sup>], and <em>EW<sub>max</sub></em> is
in [mm] per time step. Constant <em>κ<sub>gb</sub></em>
is the extinction coefficient for global solar radiation [-]. Since
evaporation is limited by the amount of water stored on the leaves, the
actual amount of evaporation from the interception store equals:</p>

<p>(2-10)</p>

<p>where <em>EW<sub>int</sub></em> is the actual evaporation from the
interception store [mm] per time step, and <em>EW0</em> is the
potential evaporation rate from an open water surface [mm day<sup>-1</sup>]</p>

<p>It is assumed that on average all water in the interception store (<em>Int<sub>cum</sub></em>)
will have evaporated or fallen to the soil surface as leaf drainage
within one day. Leaf drainage is therefore modelled as a linear
reservoir with a time constant (or residence time) of one day, i.e:</p>

<p>(2-11)</p>

<p>where <em>D<sub>int</sub></em> is the amount of leaf drainage per
time step [mm] and <em>T<sub>int</sub></em> is a time constant for the
interception store [days], which is set to 1 day.</p>


<h2 id="water-available-for-infiltration-and-direct-runoff">Water
available for infiltration and direct runoff</h2>

<p>In the permeable fraction of each pixel (1- <em>f<sub>dr</sub></em>),
the amount of water that is available for infiltration, <em>W<sub>av</sub></em>
[mm] equals (Supit <em>et al.</em>,1994):</p>

<p>(2-12)</p>

<p>where:</p>

<table>

  <thead>
  <tr class="header">
    <th><em>R</em></th>
    <th>: Rainfall [mm day<sup>-1</sup>]</th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><em>M</em></td>
      <td>: Snow melt [mm]</td>
    </tr>
    <tr class="even">
      <td><em>D<sub>int</sub></em></td>
      <td>: Leaf drainage [mm]</td>
    </tr>
    <tr class="odd">
      <td><em>Int</em></td>
      <td>: Interception [mm]</td>
    </tr>
    <tr class="even">
      <td><em>Δt</em></td>
      <td>: time step [days]</td>
    </tr>
  </tbody>
</table>

<p>Since no infiltration can take place in each pixel’s ‘direct runoff
fraction’, direct runoff is calculated as:</p>

<p>(2-13)</p>

<p>where <em>R<sub>d</sub></em> is in [mm] per time step. Note here
that <em>W<sub>av</sub></em> is valid for the permeable fraction only,
whereas <em>R<sub>d</sub></em> is valid for the direct runoff fraction.</p>

<h2 id="water-uptake-by-plant-roots-and-transpiration">Water uptake by
plant roots and transpiration</h2>

<p>Water uptake and transpiration by vegetation and direct evaporation
from the soil surface are modelled as two separate processes. The
approach used here is largely based on Supit <em>et al</em>. (1994)
and Supit &amp; Van Der Goot (2000). The maximum transpiration per time
step [mm] is given by:</p>

<p>(2-14)</p>

<p>Where <em>ET0</em> is the potential (reference) evapotranspiration
rate [mm day<sup>-1</sup>],</p>

<p>Constant <em>κ<sub>gb</sub></em> is the extinction coefficient for
global solar radiation [-] and</p>

<p><em>k<sub>crop</sub></em> is a crop coefficient, a ration between
the potential (reference) evapotranspiration rate and the potential
evaporation rate of a specific crop. <em>k<sub>crop</sub></em> is 1
for most vegetation types, except for some excessively transpiring
crops like sugarcane or rice.</p>

<p>Note that the energy that has been ‘consumed’ already for the
evaporation of intercepted water is simply subtracted here in order to
respect the overall energy balance. The actual transpiration rate is
reduced when the amount of moisture in the soil is small. In the model,
a reduction factor is applied to simulate this effect:</p>

<p>(2-15)</p>

<p>where <em>w<sub>1</sub></em> is the amount of moisture in the upper
soil layer [mm], <em>w<sub>wp1</sub></em> [mm] is the amount of soil
moisture at wilting point (pF 4.2) and <em>w<sub>crit1</sub></em>
[mm] is the amount of moisture below which water uptake is reduced and
plants start closing their stomata. The critical amount of soil
moisture is calculated as:</p>

<p>(2-16)</p>

<p>where <em>w<sub>fc1</sub></em> [mm] is the amount of soil moisture
at field capacity and <em>p</em> is the soil water depletion fraction.
<em>R<sub>WS</sub></em> varies between 0 and 1: negative values and
values greater than 1 are truncated to 0 and 1, respectively. <em>p</em>
represents the fraction of soil moisture between <em>w<sub>fc1</sub></em>
and <em>w<sub>wp1</sub></em>
that can be extracted from the soil without reducing the transpiration
rate. Its value is a function of both vegetation type and the potential
evapotranspiration rate. The procedure to estimate <em>p</em> is
described in detail in Supit &amp; Van Der Goot (2003). Figure 2.8
further illustrates the relation between <em>RWS</em>, <em>w</em>, <em>w<sub>crit</sub></em>,
<em>w<sub>fc</sub></em>, <em>w<sub>wp</sub></em>.</p>


<embed src="e:%5Cgh-pages%5C/media/image41.emf" style="width: 5.70833in; height: 3.40625in;">
<table>

  <thead>
  <tr class="header">
    <th>Name:</th>
    <th>W<sub>wp</sub></th>
    <th><br>
    </th>
    <th>W<sub>crit</sub></th>
    <th><br>
    </th>
    <th>W<sub>fc</sub></th>
    <th><br>
    </th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>Soil moisture:</td>
      <td>at wilting point</td>
      <td><br>
      </td>
      <td>critical amount for plants</td>
      <td><br>
      </td>
      <td>at field capacity</td>
      <td>saturated</td>
    </tr>
    <tr class="even">
      <td>pF-value:</td>
      <td>4.2</td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td>1.8</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>Characteristic:</td>
      <td>Residual water</td>
      <td>Effective field capacity</td>
      <td>Air capacity</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td>Usable porosity – from residual to saturated soil moisture</td>
    </tr>
  </tbody>
</table>

<p><em>Figure 2.8 Reduction of transpiration in case of water stress. R<sub>ws</sub>
decreases linearly to zero between</em> w<sub>crit</sub> <em>and</em> w<sub>wp</sub><em>.</em></p>

<p>The actual transpiration <em>T<sub>a</sub></em> is now calculated
as:</p>

<p>(2-17)</p>

<p>with <em>T<sub>a</sub></em> and <em>T<sub>max</sub></em> in [mm].</p>

<p>Transpiration is set to zero when the soil is frozen (i.e. when
frost index <em>F</em>
exceeds its critical threshold). The amount of moisture in the upper
soil layer is updated after the transpiration calculations:</p>

<p>(2-18)</p>

<h2 id="direct-evaporation-from-the-soil-surface">Direct evaporation
from the soil surface</h2>

<p>The maximum amount of evaporation from the soil surface equals the
maximum evaporation from a shaded soil surface, <em>ES<sub>max</sub></em>
[mm], which is computed as:</p>

<p>(2-19)</p>

<p>where <em>ES0</em> is the potential evaporation rate from bare soil
surface [mm day<sup>-1</sup>].
The actual evaporation from the soil mainly depends on the amount of
soil moisture near the soil surface: evaporation decreases as the
topsoil is drying. In the model this is simulated using a reduction
factor which is a function of the number of days since the last rain
storm (Stroosnijder, 1987, 1982):</p>

<p>(2-20)</p>

<p>The variable <em>D<sub>slr</sub></em> represents the number of days
since the last rain event. Its value accumulates over time: if the
amount of water that is available for infiltration (<em>W<sub>av</sub></em>)
remains below a critical threshold it increases by an amount of <em>Δt</em>
[days] for each time step. It is reset to 1 only if the critical amount
of water is exceeded<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.
The actual soil evaporation is always the smallest value out of the
result of the equation above and the available amount of moisture in
the soil, i.e.:</p>

<p>(2-21)</p>

<p>where <em>w<sub>1</sub></em> [mm] is the amount of moisture in the
upper soil layer and <em>w<sub>res1</sub></em>
[mm] is the residual amount of soil moisture. Like transpiration,
direct evaporation from the soil is set to zero if the soil is frozen.
The amount of moisture in the upper soil layer is updated after the
evaporation calculations:</p>

<p>(2-22)</p>

<h2 id="infiltration-capacity">Infiltration capacity</h2>

<p>The infiltration capacity of the soil is estimated using the
widely-used Xinanjiang (also known as VIC/ARNO) model (e.g. Zhao &amp;
Lui, 1995; Todini, 1996). This approach assumes that the fraction of a
grid cell that is contributing to surface runoff (read: saturated) is
related to the total amount of soil moisture, and that this
relationship can be described through a non-linear distribution
function. For any grid cell, if <em>w<sub>1</sub></em> is the total
moisture storage in the upper soil layer and <em>w<sub>s1</sub></em>
is the maximum storage, the corresponding saturated fraction <em>A<sub>s</sub></em>
is approximated by the following distribution function:</p>

<p>(2-23)</p>

<p>where <em>w<sub>s1</sub></em> and <em>w<sub>1</sub></em> are the
maximum and actual amounts of moisture in the upper soil layer,
respectively [mm], and <em>b</em> is an empirical shape parameter. In
the LISFLOOD implementation of the Xinanjiang model, <em>A<sub>s</sub></em>
is defined as a fraction of the permeable fraction of each pixel (i.e.
as a fraction of (1-<em>d<sub>rf</sub></em>)). The infiltration
capacity <em>INF<sub>pot</sub></em> [mm] is a function of <em>w<sub>s</sub></em>
and <em>A<sub>s</sub></em>:</p>

<p>(2-24)</p>

<p>Note that the shape parameter <em>b</em> is related to the
heterogeneity within each grid cell. For a totally homogeneous grid
cell <em>b</em>
approaches zero, which reduces the above equations to a simple
‘overflowing bucket’ model. Before any water is draining from the soil
to the groundwater zone the soil has to be completely filled up. See
also red line in figure 2.9: e.g. a soil of 60% soil moisture has 40%
potential infiltration capacity. A b value of 1.0 is comparable to a
leaking bucket. See black line in figure 2.9: e.g. a soil of 60% soil
moisture has only 10% potential infiltration capacity while 30% is
draining directly to groundwater. Increasing b even further than 1 is
comparable to a sieve (see figure 2.10). Most of the water is going
directly to groundwater and the potential infiltration capacity is
going toward 0.</p>


<embed src="e:%5Cgh-pages%5C/media/image50.emf" style="width: 3.19792in; height: 2.97917in;">
<p><strong>Figure 2.9</strong> Soil moisture and potential infiltration
capacity relation</p>


<embed src="e:%5Cgh-pages%5C/media/image51.emf" style="width: 6.5in; height: 2.38264in;">
<p><strong>Figure 2.10</strong> Analogy picture of increasing
Xinanjiang empirical shape parameter&nbsp;b</p>

<h2 id="preferential-bypass-flow">Preferential bypass flow</h2>

<p>For the simulation of preferential bypass flow –i.e. flow that
bypasses the soil matrix and drains directly to the groundwater- no
generally accepted equations exist. Because ignoring preferential flow
completely will lead to unrealistic model behaviour during extreme
rainfall conditions, a very simple approach is used in LISFLOOD. During
each time step, a fraction of the water that is available for
infiltration is added to the groundwater directly (i.e. without first
entering the soil matrix). It is assumed that this fraction is a power
function of the relative saturation of the topsoil, which results in an
equation that is somewhat similar to the excess soil water equation
used in the HBV model (e.g. Lindström <em>et al</em>., 1997):</p>

<p>(2-25)</p>

<p>where <em>D<sub>pref,gw</sub></em> is the amount of preferential
flow per time step [mm], <em>W<sub>av</sub></em> is the amount of
water that is available for infiltration, and <em>c<sub>pref</sub></em>
is an empirical shape parameter. <em>f<sub>dr</sub></em>
is the ‘direct runoff fraction’ [-], which is the fraction of each
pixel that is made up by urban area and open water bodies (i.e.
preferential flow is only simulated in the permeable fraction of each
pixel) . The equation results in a preferential flow component that
becomes increasingly important as the soil gets wetter.</p>

<p>Figure 2.11 shows with <em>c<sub>pref</sub></em> = 0 (red line)
every available water for infiltration is converted into preferential
flow and bypassing the soil. <em>c<sub>pref</sub></em>
= 1 (black line) gives a linear relation e.g. at 60% soil saturation
60% of the available water is bypassing the soil matrix. With
increasing <em>c<sub>pref</sub></em> the percentage of preferential
flow is decreasing.</p>


<embed src="e:%5Cgh-pages%5C/media/image58.emf" style="width: 2.98958in; height: 2.875in;">
<p><strong>Figure 2.11</strong> Soil moisture and preferential flow
relation</p>

<h2 id="actual-infiltration-and-surface-runoff">Actual infiltration and
surface runoff</h2>

<p>The actual infiltration <em>INF<sub>act</sub></em> [mm] is now
calculated as:</p>

<p>(2-26)</p>

<p>Finally, the surface runoff <em>R<sub>s</sub></em> [mm] is
calculated as:</p>

<p>(2-27)</p>

<p>where <em>R<sub>d</sub></em> is the direct runoff (generated in the
pixel’s ‘direct runoff fraction’). If the soil is frozen (<em>F</em>
&gt; critical threshold) no infiltration takes place. The amount of
moisture in the upper soil layer is updated after the infiltration
calculations:</p>

<p>(2-28)</p>

<h2 id="soil-moisture-redistribution">Soil moisture redistribution </h2>

<p>The description of the moisture fluxes out of the subsoil (and also
between the upper- and lower soil layer) is based on the simplifying
assumption that the flow of soil moisture is entirely gravity-driven.
Starting from Darcy’s law for 1-D vertical flow:</p>

<p>(2-29)</p>

<p>where <em>q</em> [mm day<sup>-1</sup>] is the flow rate out of the
soil (e.g. upper soil layer, lower soil layer); <em>K(θ)</em> [mm day<sup>-1</sup>]
is the hydraulic conductivity (as a function of the volumetric moisture
content of the soil, <em>θ</em> [mm<sup>3</sup> mm<sup>-3</sup>]) and
is the matric potential gradient. If we assume a matric potential
gradient of zero, the equation reduces to:</p>

<p>(2-30)</p>

<p>This implies a flow that is always in downward direction, at a rate
that equals the conductivity of the soil. The relationship between
hydraulic conductivity and soil moisture status is described by the Van
Genuchten equation (van Genuchten, 1980), here re-written in terms of
mm water slice, instead of volume fractions:</p>

<p>(2-31)</p>

<p>where <em>K<sub>s</sub></em> is the saturated conductivity of the
soil [mm day<sup>-1</sup>], and <em>w</em>, <em>w<sub>r</sub></em>
and <em>w<sub>s</sub></em> are the actual, residual and maximum
amounts of moisture in the soil respectively (all in [mm]). Parameter <em>m</em>
is calculated from the pore-size index, <em>λ</em> (which is related
to soil texture):</p>

<p>(2-32)</p>

<p>For large values of <em>Δt</em> (e.g. 1 day) the above equation
often results in amounts of outflow that exceed the available soil
moisture storage, i.e:</p>

<p>(2-33)</p>

<p>In order to solve the soil moisture equations correctly an iterative
procedure is used. At the beginning of each time step, the
conductivities for both soil layers [<em>K<sub>1</sub>(w<sub>1</sub>)</em>,
<em>K<sub>2</sub>(w<sub>2</sub>)</em>]
are calculated using the Van Genuchten equation. Multiplying these
values with the time step and dividing by the available moisture gives
a Courant-type numerical stability indicator for each respective layer:</p>

<p>(2-34a)</p>

<p>(2-34b)</p>

<p>A Courant number that is greater than 1 implies that the calculated
outflow exceeds the available soil moisture, resulting in loss of mass
balance. Since we need a stable solution for both soil layers, the
‘overall’ Courant number for the soil moisture routine is the largest
value out of <em>C<sub>1</sub></em> and <em>C<sub>2</sub></em>:</p>

<p>(2-35)</p>

<p>In principle, rounding <em>C<sub>soil</sub></em> up to the nearest
integer gives the number sub-steps needed for a stable solution. In
practice, it is often preferable to use a critical Courant number that
is lower than 1, because high values can result in unrealistic ‘jumps’
in the simulated soil moisture pattern when the soil is near saturation
(even though mass balance is preserved). Hence, making the critical
Courant number a user-defined value <em>C<sub>crit</sub></em>, the
number of sub-steps becomes:</p>

<p>(2-36)</p>

<p>and the corresponding sub-time-step, <em>Δ’t</em>:</p>

<p>(2-37)</p>

<p>In brief, the iterative procedure now involves the following steps.
First, the number of sub-steps and the corresponding sub-time-step are
computed as explained above. The amounts of soil moisture in the upper
and lower layer are copied to temporary variables <em>w’<sub>1</sub></em>
and <em>w’<sub>2</sub></em>. Two variables, <em>D<sub>1,2</sub></em>
(flow from upper to lower soil layer) and <em>D<sub>2,gw</sub></em>
(flow from lower soil layer to groundwater) are initialized (set to
zero). Then, for each sub-step, the following sequence of calculations
is performed:</p>

<ol type="1">

  <li>
    <p>compute hydraulic conductivity for both layers</p>
  </li>
  <li>
    <p>compute flux from upper to lower soil layer for this sub-step (<em>D’<sub>1,2</sub></em>,
can never exceed storage capacity in lower layer):</p>
  </li>
</ol>

<p>(2-38)</p>

<ol start="3" type="1">

  <li>
    <p>compute flux from lower soil layer to groundwater for this
sub-step (<em>D’<sub>2,gw</sub></em>, can never exceed available water
in lower layer):</p>
  </li>
</ol>

<p>(2-39)</p>

<ol start="4" type="1">

  <li>
    <p>update <em>w’<sub>1</sub></em> and <em>w’<sub>2</sub></em></p>
  </li>
  <li>
    <p>add <em>D’<sub>1,2</sub></em> to <em>D<sub>1,2</sub></em>; add
    <em>D’<sub>2,gw</sub></em> to <em>D<sub>2,gw</sub></em></p>
  </li>
</ol>

<p>If the soil is frozen (<em>F</em> &gt; critical threshold), both <em>D<sub>1,2</sub></em>
and <em>D<sub>2,gw</sub></em> are set to zero. After the iteration
loop, the amounts of soil moisture in both layers are updated as
follows:</p>

<p>(2-40)</p>

<p>(2-41)</p>

<h2 id="groundwater">Groundwater</h2>

<p>Groundwater storage and transport are modelled using two parallel
linear reservoirs, similar to the approach used in the HBV-96 model
(Lindström et al., 1997). The upper zone represents a quick runoff
component, which includes fast groundwater and subsurface flow through
macro-pores in the soil. The lower zone represents the slow groundwater
component that generates the base flow. The outflow from the upper zone
to the channel, <em>Q<sub>uz</sub></em> [mm] equals:</p>

<p>(2-42)</p>

<p>where <em>T<sub>uz</sub></em> is a reservoir constant [days] and <em>UZ</em>
is the amount of water that is stored in the upper zone [mm. Similarly,
the outflow from the lower zone is given by:</p>

<p>(2-43)</p>

<p>Here, <em>T<sub>lz</sub></em> is again a reservoir constant [days],
and <em>LZ</em> is the amount of water that is stored in the lower
zone [mm]. The values of both <em>T<sub>uz</sub></em> and <em>T<sub>lz</sub></em>
are obtained by calibration. The upper zone also provides the inflow
into the lower zone. For each time step, a fixed amount of water
percolates from the upper to the lower zone:</p>

<p>(2-44)</p>

<p>Here, <em>GW<sub>perc</sub></em> [mm day<sup>-1</sup>] is a
user-defined value that can be used as a calibration constant. For many
catchments it is quite reasonable to treat the lower groundwater zone
as a system with a closed lower boundary (i.e. water is either stored,
or added to the channel). However, in some cases the closed boundary
assumption makes it impossible to obtain realistic simulations. Because
of this, it is possible to percolate a fixed amount of water out of the
lower zone, as a loss <em>D<sub>loss</sub></em>:</p>

<p>(2-45)</p>

<p>In the previous version of LISFLOOD <em>D<sub>loss</sub></em>, was
calculated as a fixed fraction of Q<sub>lz</sub>, but this leads to a
high dependency of D<sub>loss</sub> from GW<sub>perc</sub> and LZ. For
example if either GW<sub>perc</sub> or LZ is quite low the parameter <em>D<sub>loss</sub></em>
turns out to be meaningless.</p>

<p>The loss fraction, <em>f<sub>loss</sub></em> [-], equals 0 for a
completely closed lower boundary. If <em>f<sub>loss</sub></em> is set
to 1, all outflow from the lower zone is treated as a loss. Water that
flows out of the lower zone through <em>D<sub>loss</sub></em>
is quite literally ‘lost’ forever. Physically, the loss term could
represent water that is either lost to deep groundwater systems (that
do not necessarily follow catchment boundaries), or even groundwater
extraction wells. When using the model, it is suggested to use <em>f<sub>oss</sub></em>
with some care; start with a value of zero, and only use any other
value if it is impossible to get satisfactory results by adjusting the
other calibration parameters.</p>

<p>At each time step, the amounts of water in the upper and lower zone
are updated for the in- and outgoing fluxes, i.e.:</p>

<p>(2-46)</p>

<p>(2-47)</p>

<p>Note that these equations are again valid for the permeable fraction
of the pixel only: storage in the direct runoff fraction equals 0 for
both <em>UZ</em> and <em>LZ</em>.</p>

<h2 id="routing-of-surface-runoff-to-channel">Routing of surface runoff
to channel</h2>

<p>Surface runoff is routed to the nearest downstream channel using a
4-point implicit finite-difference solution of the kinematic wave
equations (Chow, 1988). The basic equations used are the equations of
continuity and momentum. The continuity equation is:</p>

<p>(2-48)</p>

<p>where <em>Q<sub>sr</sub></em> is the surface runoff [m<sup>3</sup> s<sup>-1</sup>],
<em>A<sub>sr</sub></em> is the cross-sectional area of the flow [m<sup>2</sup>]
and <em>q<sub>sr</sub></em> is the amount of lateral inflow per unit
flow length [m<sup>2</sup> s<sup>-1</sup>]. The momentum equation is
defined as:</p>

<p>(2-49)</p>

<p>where <em>ρ</em> is the density of the flow [kg m<sup>-3</sup>], <em>g</em>
is the gravity acceleration [m s<sup>-2</sup>], <em>S<sub>0</sub></em>
is the topographical gradient and <em>S<sub>f</sub></em> is the
friction gradient. From the momentum equation it follows that <em>S<sub>0</sub>=
S<sub>f</sub></em>,
which means that for the kinematic wave equations it is assumed that
the water surface is parallel to the topographical surface. The
continuity equation can also be written in the following
finite-difference form (please note that for the sake of readability
the ‘sr’ subscripts are omitted here from <em>Q</em>, <em>A</em> and <em>q</em>):</p>

<p>(2-50)</p>

<p>where <em>j</em> is a time index and <em>i</em> a space index
(such that <em>i=1</em> for the most upstream cell, <em>i=2</em> for
its downstream neighbour, etcetera). The momentum equation can also be
expressed as (Chow et al., 1988):</p>

<p>(2-51)</p>

<p>Substituting the right-hand side of this expression in the
finite-difference form of the continuity equation gives a nonlinear
implicit finite-difference solution of the kinematic wave:</p>

<p>(2-52)</p>

<p>If <em>α<sub>k,sr</sub></em> and <em>β<sub>k</sub></em> are known,
this non-linear equation can be solved for each pixel and during each
time step using an iterative procedure. This numerical solution scheme
is available as a built-in function in the PCRaster software. The
coefficients <em>α<sub>k,sr</sub></em> and <em>β<sub>k</sub></em> are
calculated by substituting Manning's equation in the right-hand side of
Equation 2-51:</p>

<p>(2-53)</p>

<p>where <em>n</em> is Manning's roughness coefficient and <em>P<sub>sr</sub></em>
is the wetted perimeter of a cross-section of the surface flow.
Substituting the right-hand side of this equation for <em>A<sub>sr</sub></em>
in equation 2-51 gives:</p>

<p>(2-54)</p>

<p>At present, LISFLOOD uses values for <em>α<sub>k,sr</sub></em>
which are based on a static (reference) flow depth, and a flow width
that equals the pixel size, <em>Δx</em>. For each time step, all
runoff that is generated (<em>R<sub>s</sub></em>) is added as side-flow
(<em>q<sub>sr</sub></em>).
For each flowpath, the routing stops at the first downstream pixel that
is part of the channel network. In other words, the routine only routes
the surface runoff <em>to</em> the nearest channel; no runoff <em>through</em>
the channel network is simulated at this stage (runoff- and channel
routing are completely separated).</p>

<h2 id="routing-of-sub-surface-runoff-to-channel">Routing of
sub-surface runoff to channel</h2>

<p>All water that flows out of the upper- and lower groundwater zone is
routed to the nearest downstream channel pixel within one time step.
Recalling once more that the groundwater equations are valid for the
pixel’s permeable fraction only, the contribution of each pixel to the
nearest channel is made up of (<em>f<sub>forest+</sub>f<sub>other</sub>)∙(Q<sub>uz</sub></em>
+ <em>Q<sub>lz</sub>)</em>.
Figure 2.12 illustrates the routing procedure: for each pixel that
contains a river channel, its contributing pixels are defined by the
drainage network. For every 'river pixel' the groundwater outflow that
is generated by its upstream pixels is simply summed. For instance,
there are two flow paths that are contributing to the second 'river
pixel' from the left in Figure 2.12. Hence, the amount of water that is
transported to this pixel equals the sum of the amounts of water
produced by these flowpaths, q1 + q2. Note that, as with the surface
runoff routing, no water is routed <em>through</em> the river network
at this stage.</p>

<p><img src="e:%5Cgh-pages%5C/media/image90.png" alt="ROUTING" style="width: 6in; height: 3.13542in;"></p>

<p><em>Figure 2.12 Routing of groundwater to channel network.
Groundwater flow is routed to the nearest ‘channel’ pixel.</em></p>

<h2 id="channel-routing">Channel routing</h2>

<p>Flow through the channel is simulated using the kinematic wave
equations. The basic equations and the numerical solution are identical
to those used for the surface runoff routing:</p>

<p>(2-55)</p>

<p>where <em>Q<sub>ch</sub></em> is the channel discharge [m<sup>3</sup>
s<sup>-1</sup>], <em>A<sub>ch</sub></em> is the cross-sectional area
of the flow [m<sup>2</sup>] and <em>q<sub>ch</sub></em> is the amount
of lateral inflow per unit flow length [m<sup>2</sup> s<sup>-1</sup>].
The momentum equation then becomes:</p>

<p>(2-56)</p>

<p>where <em>S<sub>0</sub></em> now equals the gradient of the channel
bed, and <em>S<sub>0</sub>= S<sub>f</sub></em>. As with the surface
runoff, values for parameter <em>α<sub>k,ch</sub></em> are estimated
using Manning’s equation:</p>

<p>(2-57)</p>

<p>At present, LISFLOOD uses values for <em>α<sub>k,ch</sub></em>
which are based on a static (reference) channel flow depth (half
bankfull) and measured channel dimensions. The term <em>q<sub>ch</sub></em>
(sideflow) now represents the runoff that enters the channel per unit
channel length:</p>

<p>(2-58)</p>

<p>Here, <em>Q<sub>sr</sub></em>, <em>Q<sub>uz</sub></em> and <em>Q<sub>lz</sub></em>
denote the contributions of surface runoff, outflow from the upper zone
and outflow from the lower zone, respectively. <em>Q<sub>in</sub></em>
is the inflow from an external inflow hydrograph; by default its value
is 0, unless the ‘inflow hydrograph’ option is activated (see Annex 2).
<em>Q<sub>res</sub></em> is the water that flows out of a reservoir
into the channel; by default its value is 0, unless the ‘reservoir’
option is activated (see Annex 1). <em>Q<sub>sr</sub></em>, <em>Q<sub>uz</sub></em>,
<em>Q<sub>lz</sub></em>, <em>Q<sub>in</sub></em> and <em>Q<sub>res</sub></em>
are all expressed in [m<sup>3</sup>] per time step. <em>L<sub>ch</sub></em>
is the channel length [m], which may exceed the pixel size (<em>Δx</em>)
in case of meandering channels. The kinematic wave channel routing can
be run using a smaller time-step than the over simulation timestep, <em>Δt</em>,
if needed.</p>

<h2 id="special-simulation-options">Special simulation options</h2>

<p>The above model description covers the processes that are simulated
in a ‘standard’ LISFLOOD run. By default, special structures in the
river channel e.g. lakes and regulated reservoirs are not taken into
account. However, LISFLOOD has some optional features to model these
structures. The description of these features can be found in a series
of Annexes at the end of this manual.</p>

<p>Features are:</p>

<ul>

  <li>
    <p>Including reservoirs, polder, lakes (Annex 1-3)</p>
  </li>
  <li>
    <p>including inflow hydrographs (Annex 4)</p>
  </li>
  <li>
    <p>using a double kinematic wave approach for channel routing
(Annex 5)</p>
  </li>
  <li>
    <p>using the diffusion wave approach instead of kinematic wave for
channel routing (Annex 6)</p>
  </li>
  <li>
    <p>Including transmission loss (Annex 7)</p>
  </li>
  <li>
    <p>Using water use maps (Annex 8)</p>
  </li>
  <li>
    <p>Simulating water levels (Annex 9)</p>
  </li>
</ul>

<h1 id="installation-of-the-lisflood-model"><br>
3. Installation of the LISFLOOD model</h1>

<h2 id="system-requirements">System requirements</h2>

<p>Currently LISFLOOD is available on both 64-bit Linux and 32-bit
Windows systems. Either way, the model requires that a recent version
of the PCRaster software is available, or at least PCRaster’s ‘pcrcalc’
application and all associated libraries. LISFLOOD require ‘pcrcalc’
version November 30, 2009, or more recent. Older ‘pcrcalc’ versions
will either not work at all, or they might produce erroneous results.
Unless you are using a ‘sealed’ version of LISFLOOD (i.e. a version in
which the source code is made unreadable), you will also need a
licensed version of ‘pcrcalc’. For details on how to install PCRaster
we refer to the PCRaster documentation.</p>

<h2 id="installation-on-windows-systems">Installation on Windows systems</h2>

<p>For Windows users the installation involves two steps:</p>

<ol type="1">

  <li>
    <p>Unzip the contents of ‘lisflood_win32.zip’ to an empty folder on
your PC (e.g. ‘lisflood’)</p>
  </li>
  <li>
    <p>Open the file ‘config.xml’ in a text editor. This file contains
the full path to all files and applications that are used by LISFLOOD.
The items in the file are:</p>
  </li>
</ol>

<ul>

  <li>
    <p><em>Pcrcalc application</em> : this is the name of the pcrcalc
application, including the full path</p>
  </li>
  <li>
    <p><em>LISFLOOD Master Code</em> (optional). This item is usually
omitted, and LISFLOOD assumes that the master code is called
‘lisflood.xml’, and that it is located in the root of the ‘lisflood’
directory (i.e. the directory that contains ‘lisflood.exe’ and all
libraries). If –for whatever reason- you want to overrule this
behaviour, you can add a ‘mastercode’ element, e.g.:</p>
  </li>
</ul>

<blockquote>
  <p><strong>&lt;mastercode&gt;</strong>d:\Lisflood\mastercode\lisflood.xml<strong>&lt;/mastercode&gt;</strong></p>
</blockquote>

<p>The configuration file should look something like this:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</p>
      <p>&lt;!-- Lisflood configuration file, JvdK, 8 July 2004 --&gt;</p>
      <p>&lt;!-- !! This file MUST be in the same directory as
lisflood.exe --&gt;</p>
      <p>&lt;!-- (or lisflood) !!! --&gt;</p>
      <p><strong>&lt;lfconfig&gt;</strong></p>
      <p>&lt;!-- location of pcrcalc application --&gt;</p>
      <p><strong>&lt;pcrcalcapp&gt;</strong>C:\pcraster\apps\pcrcalc.exe<strong>&lt;/pcrcalcapp&gt;</strong></p>
      <p><strong>&lt;/lfconfig&gt;</strong></p>
      </td>
    </tr>
  </tbody>
</table>

<p>The lisflood executable is a command-line application which can be
called from the command prompt (‘DOS’ prompt). To make life easier you
may include the full path to ‘lisflood.exe’ in the ’Path’ environment
variable. In Windows XP you can do this by selecting ‘settings’ from
the ‘Start’ menu; then go to ‘control panel’/’system’ and go to the
‘advanced’ tab. Click on the ‘environment variables’ button. Finally,
locate the ‘Path’ variable in the ‘system variables’ window and click
on ‘Edit’ (this requires local Administrator privileges).</p>

<h2 id="installation-on-linux-systems">Installation on Linux systems</h2>

<p>Under Linux LISFLOOD requires that the Python interpreter (version
2.5 or more recent) is installed on the system. Most Linux
distributions already have Python pre-installed. If needed you can
download Python free of any charge from the following location:</p>

<p><em>http://www.python.org/</em></p>

<p>The installation process is largely identical to the Windows
procedure: unzip the contents of ‘lisflood_llinux.zip’ to an empty
directory. Check if the file ‘lisflood’ is executable. If not, make it
executable using:</p>

<p>chmod 755 lisflood</p>

<p>Then update the paths in the configuration file. The configuration
file will look something like this:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</p>
      <p>&lt;!-- Lisflood configuration file, JvdK, 8 July 2004 --&gt;</p>
      <p>&lt;!-- !! This file MUST be in the same directory as
lisflood.exe --&gt;</p>
      <p>&lt;!-- (or lisflood) !!! --&gt;</p>
      <p><strong>&lt;lfconfig&gt;</strong></p>
      <p>&lt;!-- location of pcrcalc application --&gt;</p>
      <p><strong>&lt;pcrcalcapp&gt;/software/PCRaster/bin/pcrcalc&lt;/pcrcalcapp&gt;</strong></p>
      <p><strong>&lt;/lfconfig&gt;</strong></p>
      </td>
    </tr>
  </tbody>
</table>

<h2 id="running-the-model">Running the model</h2>

<p>Type ‘lisflood’ at the command prompt. You should see something like
this:</p>

<p>LISFLOOD version March 24 2008</p>

<p>Water balance and flood simulation model for large catchments</p>

<p>(C) Institute for Environment and Sustainability</p>

<p>Joint Research Centre of the European Commission</p>

<p>TP261, I-21020 Ispra (Va), Italy</p>

<p>usage (1): lisflood [switches] &lt;InputFile&gt;</p>

<p>usage (2): lisflood --listoptions (show options only)</p>

<p>InputFile : LISFLOOD input file (see documentation</p>

<p>for description of format)</p>

<p>switches:</p>

<p>-s : keep temporary script after simulation</p>

<p>You can run LISFLOOD by typing ‘lisflood’ followed by a
specially-formatted settings file. The layout of this file is described
in Chapters 4 and 5. Chapter 3 explains all other input files.</p>

<p><span id="_Toc84077416" class="anchor"></span><strong>4. Model
setup: input files</strong></p>

<p>In the current version of LISFLOOD, all model input is provided as
either maps (grid files in PCRaster format) or tables. This chapter
describes all the data that are required to run the model. Files that
are specific to <em>optional</em> LISFLOOD features (e.g. inflow
hydrographs, reservoirs) are not listed here; they are described in the
documentation for each option.</p>

<h2 id="input-maps">Input maps</h2>

<p>PCRaster requires that all maps must have <em>identical</em>
location attributes (number of rows, columns, cellsize, upper x and y
coordinate!</p>

<p>All input maps roughly fall into any of the following six categories:</p>

<ul>

  <li>
    <p>maps related to topography</p>
  </li>
  <li>
    <p>maps related to land cover – fraction of land cover</p>
  </li>
  <li>
    <p>maps related to land cover and soil</p>
  </li>
  <li>
    <p>maps related to soil texture (soil hydraulic properties)</p>
  </li>
  <li>
    <p>maps related to channel geometry</p>
  </li>
  <li>
    <p>maps related to the meteorological conditions</p>
  </li>
  <li>
    <p>maps related to the development of vegetation over time</p>
  </li>
  <li>
    <p>maps that define at which locations output is generated as time
series</p>
  </li>
</ul>

<p>All maps that are needed to run the model are listed in the table<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> of Annex
12.</p>

<h3 id="role-of-mask-and-channels-maps">Role of “mask” and “channels”
maps </h3>

<p>The mask map (i.e. “area.map”) defines the model domain. In order to
avoid unexpected results, <strong>it is vital that all maps that are
related to topography, land use and soil are defined (i.e. don’t
contain a missing value)</strong>
for each pixel that is “true” (has a Boolean 1 value) on the mask map.
The same applies for all meteorological input and the Leaf Area Index
maps. Similarly, all pixels that are “true” on the channels map must
have some valid (non-missing) value on each of the channel parameter
maps. Undefined pixels can lead to unexpected behaviour of the model,
output that is full of missing values, loss of mass balance and
possibly even model crashes. Some maps needs to have values in a
defined range e.g. gradient.map has to be greater than 0.</p>

<h3 id="map-location-attributes-and-distance-units">Map location
attributes and distance units</h3>

<p>LISFLOOD needs to know the size properties of each grid cell
(length, area) in order to calculate water <em>volumes</em> from
meteorological forcing variables that are all defined as water <em>depths</em>.
By default, LISFLOOD obtains this information from the location
attributes of the input maps. This will only work if all maps are in an
“equal area” (equiareal) projection, and the map co-ordinates (and cell
size) are defined in meters. For datasets that use, for example, a
latitude-longitude system, neither of these conditions is met. In such
cases you can still run LISFLOOD if you provide two additional maps
that contain the length and area of each grid cell:</p>

<table>

  <thead>
  <tr class="header">
    <th><em><strong>Table 4.1</strong> Optional maps that define grid
size</em></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>Map</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>PixelLengthUser</td>
      <td>pixleng.map</td>
      <td>
      <p>Map with pixel length</p>
      <p>Unit: [m], <em>Range of values: map &gt; 0</em></p>
      </td>
    </tr>
    <tr class="even">
      <td>PixelAreaUser</td>
      <td>pixarea.map</td>
      <td>
      <p>Map with pixel area</p>
      <p><em>Unit:</em> [m<sup>2</sup>], <em>Range of values: map &gt;
0</em></p>
      </td>
    </tr>
  </tbody>
</table>

<p>Both maps should be stored in the same directory where all other
input maps are. The values on both maps may vary in space. A limitation
is that a pixel is always represented as a square, so length and width
are considered equal (no rectangles). In order to tell LISFLOOD to
ignore the default location attributes and use the maps instead, you
need to activate the special option “<em>gridSizeUserDefined</em>”,
which involves adding the following line to the LISFLOOD settings file:</p>

<p>&lt;setoption choice="1" name="gridSizeUserDefined" /&gt;</p>

<p>LISFLOOD settings files and the use of options are explained in
detail in Chapter 5 of this document.</p>

<h3 id="naming-of-meteorological-variable-maps">Naming of
meteorological variable maps</h3>

<p>The meteorological forcing variables (and Leaf Area Index) are
defined in <em>map stacks</em>. A <em>map stack</em>
is simply a series of maps, where each map represents the value of a
variable at an individual time step. The name of each map is made up of
a total of 11 characters: 8 characters, a dot and a 3-character suffix.
Each map name starts with a <em>prefix</em>, and ends with the time
step number. All character positions in between are filled with zeros
(“0”). Take for example a stack of precipitation maps. Table 4.1 shows
that the default prefix for precipitation is “pr”, which produces the
following file names:</p>

<table>

  <thead>
  <tr class="header">
    <th>pr000000.007</th>
    <th>: at time step 7</th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>pr000035.260</td>
      <td>: at time step 35260</td>
    </tr>
  </tbody>
</table>

<p>LISFLOOD can handle two types of stacks. First, there are <em>regular</em>
stacks, in which a map is defined for each time step. For instance, the
following 10-step stack is a regular stack:</p>

<table>

  <thead>
  <tr class="header">
    <th><strong>t </strong></th>
    <th><strong>map name</strong></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>1</td>
      <td>pr000000.001</td>
    </tr>
    <tr class="even">
      <td>2</td>
      <td>pr000000.002</td>
    </tr>
    <tr class="odd">
      <td>3</td>
      <td>pr000000.003</td>
    </tr>
    <tr class="even">
      <td>4</td>
      <td>pr000000.004</td>
    </tr>
    <tr class="odd">
      <td>5</td>
      <td>pr000000.005</td>
    </tr>
    <tr class="even">
      <td>6</td>
      <td>pr000000.006</td>
    </tr>
    <tr class="odd">
      <td>7</td>
      <td>pr000000.007</td>
    </tr>
    <tr class="even">
      <td>8</td>
      <td>pr000000.008</td>
    </tr>
    <tr class="odd">
      <td>9</td>
      <td>pr000000.009</td>
    </tr>
    <tr class="even">
      <td>10</td>
      <td>pr000000.010</td>
    </tr>
  </tbody>
</table>

<p>In addition to regular stacks, it is also possible to define <em>sparse</em>
stacks. A <em>sparse</em> stack is a stack in which maps are not
defined for all time steps, for instance:</p>

<table>

  <thead>
  <tr class="header">
    <th><strong>t </strong></th>
    <th><strong>map name</strong></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>1</td>
      <td>pr000000.001</td>
    </tr>
    <tr class="even">
      <td>2</td>
      <td>-</td>
    </tr>
    <tr class="odd">
      <td>3</td>
      <td>-</td>
    </tr>
    <tr class="even">
      <td>4</td>
      <td>pr000000.004</td>
    </tr>
    <tr class="odd">
      <td>5</td>
      <td>-</td>
    </tr>
    <tr class="even">
      <td>6</td>
      <td>-</td>
    </tr>
    <tr class="odd">
      <td>7</td>
      <td>pr000000.007</td>
    </tr>
    <tr class="even">
      <td>8</td>
      <td>-</td>
    </tr>
    <tr class="odd">
      <td>9</td>
      <td>-</td>
    </tr>
    <tr class="even">
      <td>10</td>
      <td>-</td>
    </tr>
  </tbody>
</table>

<p>Here, maps are defined <em>only</em> for time steps 1, 4 and 7. In
this case, LISFLOOD will use the map values of <em>pr000000.001</em>
during time steps 1, 2 and 3, those of <em>pr000000.004</em> during
time steps 4, 5 and 6, and those of <em>pr000000.007</em> during time</p>

<p>steps 7, 8, 9 and 10. Since both regular and sparse stacks can be
combined within one single run, sparse stacks can be very useful to
save disk space. For instance, LISFLOOD always needs the <em>average
daily</em>
temperature, even when the model is run on an hourly time step. So,
instead of defining 24 identical maps for each hour, you can simply
define 1 for the first hour of each day and leave out the rest, for
instance:</p>

<table>

  <thead>
  <tr class="header">
    <th><strong>t </strong></th>
    <th><strong>map name</strong></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>1</td>
      <td>ta000000.001</td>
    </tr>
    <tr class="even">
      <td>2</td>
      <td>-</td>
    </tr>
    <tr class="odd">
      <td>:</td>
      <td>:</td>
    </tr>
    <tr class="even">
      <td>:</td>
      <td>:</td>
    </tr>
    <tr class="odd">
      <td>25</td>
      <td>ta000000.025</td>
    </tr>
    <tr class="even">
      <td>:</td>
      <td>:</td>
    </tr>
    <tr class="odd">
      <td>:</td>
      <td>:</td>
    </tr>
    <tr class="even">
      <td>49</td>
      <td>ta000000.049</td>
    </tr>
    <tr class="odd">
      <td>:</td>
      <td>:</td>
    </tr>
  </tbody>
</table>

<p>Similarly, potential evapo(transpi)ration is usually calculated on a
daily basis. So for hourly model runs it is often convenient to define <em>E0</em>,
<em>ES0</em> and <em>ET0</em> in sparse stacks as well. Leaf Area
Index (<em>LAI</em>) is a variable that changes relatively slowly over
time, and as a result it is usually advantageous to define <em>LAI</em>
in a sparse map stack.</p>

<h2 id="leaf-area-index-maps">Leaf area index maps </h2>

<p>Because Leaf area index maps follow a yearly circle, only a map
stack of one year is necessary which is then used again and again for
the following years (this approach can be used for all input maps
following a yearly circle e.g. water use). LAI is therefore defined as
sparse map stack with a map every 10 days or a month, for example for a
monthly changing LAI:</p>

<table>

  <thead>
  <tr class="header">
    <th><strong>t </strong></th>
    <th><strong>map name</strong></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>1</td>
      <td>lai00000.001</td>
    </tr>
    <tr class="even">
      <td>2</td>
      <td>lai00000.032</td>
    </tr>
    <tr class="odd">
      <td>3</td>
      <td>lai00000.060</td>
    </tr>
    <tr class="even">
      <td>4</td>
      <td>lai00000.091</td>
    </tr>
    <tr class="odd">
      <td>5</td>
      <td>lai00000.121</td>
    </tr>
    <tr class="even">
      <td>6</td>
      <td>lai00000.152</td>
    </tr>
    <tr class="odd">
      <td>7</td>
      <td>lai00000.182</td>
    </tr>
    <tr class="even">
      <td>8</td>
      <td>lai00000.213</td>
    </tr>
    <tr class="odd">
      <td>9</td>
      <td>lai00000.244</td>
    </tr>
    <tr class="even">
      <td>
      <p>10</p>
      <p>11</p>
      <p>12</p>
      </td>
      <td>
      <p>lai00000.274</p>
      <p>lai00000.305</p>
      <p>lai00000.335</p>
      </td>
    </tr>
  </tbody>
</table>

<p>After one year the first map is taken again for simulation. For
example the simulation started on the 5<sup>th</sup> March 2010 and the
first LAI is lai00000.060. On the 1<sup>st</sup>
March 2011 the map lai00000.060 is taken again as LAI input. To let
LISFLLOD know which map has to be used at which day a lookup table
(LaiOfDay.txt) is necessary.</p>


<h2 id="input-tables">Input tables</h2>

<p>In the previous version of LISFLOOD a number of model parameters are
read through tables that are linked to the classes on the land use and
soil (texture) maps. Those tables are replaced by maps (e.g. soil
hydraulic property maps) in order to include the sub-grid variability
of each parameter. Therefore only one table is used in the standard
LISFLOOD setting (without lake or reservoir option)</p>

<p>The following table gives an overview:</p>

<table>

  <thead>
  <tr class="header">
    <th>
    <p><em><strong>Table 4.3</strong> LISFLOOD input tables</em></p>
    </th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><strong>LAND USE</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Table</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>Day of the year -&gt; LAI</td>
      <td>LaiOfDay.txt</td>
      <td>Lookup table: Day of the year -&gt; LAI map</td>
    </tr>
  </tbody>
</table>

<h2 id="organisation-of-input-data">Organisation of input data</h2>

<p>It is up to the user how the input data are organised. However, it
is advised to keep the base maps, meteorological maps and tables
separated (i.e. store them in separate directories). For practical
reasons the following input structure is suggested:</p>

<ul>

  <li>
    <p>all base maps are in one directory (e.g. ‘maps’)</p>
    <ul>
      <li>
        <p>fraction maps in a subfolder (e.g. ‘fraction’)</p>
      </li>
      <li>
        <p>soil hydraulic properties in a subfolder (e.g.’soilhyd’)</p>
      </li>
      <li>
        <p>land cover depending maps in a subfolder (e.g.’table2map’)</p>
      </li>
    </ul>
  </li>
  <li>
    <p>all tables are in one directory (e.g. ‘tables’)</p>
  </li>
  <li>
    <p>all meteorological input maps are in one directory (e.g. ‘meteo’)</p>
  </li>
  <li>
    <p>a folder Leaf Area Index (e.g. ‘lai’)</p>
    <ul>
      <li>
        <p>all Leaf Area Index for forest in a subfolder (e.g.’forest’)</p>
      </li>
      <li>
        <p>all Leaf Area Index for other in a subfolder (e.g.’other’)</p>
      </li>
    </ul>
  </li>
  <li>
    <p>all output goes to one directory (e.g. ‘out’)</p>
  </li>
</ul>

<p>The following Figure illustrates this:</p>


<embed src="e:%5Cgh-pages%5C/media/image95.emf" style="width: 5.80208in; height: 4.54167in;">
<p><em>Figure 4.1 Suggested file structure for LISFLOOD</em></p>

<h2 id="generating-input-base-maps">Generating input base maps</h2>

<p>At the time of writing this document, complete sets of LISFLOOD base
maps covering the whole of Europe have been compiled at 1- and 5-km
pixel resolution. A number of automated procedures have been written
that allow you to generate sub-sets of these for pre-defined areas
(using either existing mask maps or co-ordinates of catchment outlets).</p>

<h1 id="lisflood-setup-the-settings-file"><br>
5. LISFLOOD setup: the settings file</h1>

<p>In LISFLOOD, all file and parameter specifications are defined in a
settings file. The purpose of the settings file is to link variables
and parameters in the model to in- and output files (maps, time series,
tables) and numerical values. In addition, the settings file can be
used to specify several <em>options</em>. The settings file has a
special (XML) structure. In the next sections the general layout of the
settings file is explained. Although the file layout is not
particularly complex, a basic understanding of the general principles
explained here is essential for doing any successful model runs.</p>

<p>The settings file has an XML (‘E<strong>x</strong>tensible <strong>M</strong>arkup
<strong>L</strong>anguage’)
structure. You can edit it using any text editor (e.g. Notepad,
Editpad, Emacs, vi). Alternatively, you can also use a dedicated XML
editor such as XMLSpy.</p>

<h2 id="layout-of-the-settings-file">Layout of the settings file</h2>

<p>A LISFLOOD settings file is made up of 4 elements, each of which has
a specific function. The general structure of the file is described
using XML-tags. XML stands for ‘E<strong>x</strong>tensible <strong>M</strong>arkup
<strong>L</strong>anguage’,
and it is really nothing more than a way to describe data in a file. It
works by putting information that goes into a (text) file between tags,
and this makes it very easy add structure. For a LISFLOOD settings
file, the basic structure looks like this:</p>

<table>

  <thead>
  <tr class="header">
    <th><strong>&lt;lfsettings&gt;</strong></th>
    <th>Start of settings element</th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>&lt;lfuser&gt;</strong></td>
      <td>Start of element with user-defined variables</td>
    </tr>
    <tr class="odd">
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>&lt;/lfuser&gt;</strong></td>
      <td>End of element with user-defined variables</td>
    </tr>
    <tr class="odd">
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>&lt;lfoptions&gt;</strong></td>
      <td>Start of element with options</td>
    </tr>
    <tr class="odd">
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>&lt;/lfoptions&gt;</strong></td>
      <td>End of element with options</td>
    </tr>
    <tr class="odd">
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>&lt;lfbinding&gt;</strong></td>
      <td>Start of element with ‘binding’ variables</td>
    </tr>
    <tr class="odd">
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>&lt;/lfbinding&gt;</strong></td>
      <td>End of element with ‘binding’ variables</td>
    </tr>
    <tr class="odd">
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>&lt;prolog&gt;</strong></td>
      <td>Start of prolog</td>
    </tr>
    <tr class="odd">
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>&lt;/prolog&gt;</strong></td>
      <td>End of prolog</td>
    </tr>
    <tr class="odd">
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>&lt;lfsettings&gt;</strong></td>
      <td>End of settings element</td>
    </tr>
  </tbody>
</table>

<p>From this you can see the following things:</p>

<ul>

  <li>
    <p>The settings file is made up of the elements ‘lfuser’,
‘lfoptions’ and ‘lfbinding’; in addition, there is a ‘prolog’ element
(but this will ultimately disappear in future LISFLOOD versions)</p>
  </li>
  <li>
    <p>The start of each element is indicated by the element’s name
wrapped in square brackets, e.g. &lt;element&gt;</p>
  </li>
  <li>
    <p>The end of each element is indicated by a forward slash followed
by the element’s name, all wrapped in square brackets, e.g.
&lt;/element&gt;</p>
  </li>
  <li>
    <p>All elements are part of a ‘root’ element called
‘&lt;lfsettings&gt;’.</p>
  </li>
</ul>

<p>In brief, the main function of each element is:</p>

<table>

  <thead>
  <tr class="header">
    <th><em>lfuser</em></th>
    <th>: definition of paths to all in- and output files, and main
model parameters (calibration + time-related)</th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><em>lfbinding</em></td>
      <td>: definition of all individual in- and output files, and
model parameters</td>
    </tr>
    <tr class="even">
      <td><em>lfoptions</em></td>
      <td>: switches to turn specific components of the model on or off</td>
    </tr>
  </tbody>
</table>

<p>The following sections explain the function of each element in more
detail. This is mainly to illustrate the main concepts and how it all
fits together. A detailed description of all the variables that are
relevant for setting up and running LISFLOOD is given in Chapter 6.</p>

<h3 id="lfuser-and-and-lfbinding-elements">lfuser and and lfbinding
elements</h3>

<p>The ‘lfbinding’ element provides a very low-level way to define all
model parameter values as well as all in- and output maps, time series
and tables. The ‘lfuser’ element is used to define (user-defined) text
variables. These text variables can be used to substitute repeatedly
used expressions in the binding element. This greatly reduces the
amount of work that is needed to prepare the settings file. Each
variable is defined as a ‘textvar’ element within ‘lfuser’/’lfbinding’.
Each ‘textvar’ element has the attributes ‘name’ and ‘value’. The
following example demonstrates the main principle (note that in the
examples below the prolog element is left out, but you will never need
to edit this anyway) :</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p>
      <p>&lt;!DOCTYPE lfsettings SYSTEM "lisflood.dtd"&gt;</p>
      <p><strong>&lt;lfsettings&gt;</strong></p>
      <p><strong>&lt;lfuser&gt;</strong></p>
      <p>&lt;textvar name="PathMaps"
value="//cllx01/floods2/knijfjo/test/maps"&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p><strong>&lt;/lfuser&gt;</strong></p>
      <p><strong>&lt;lfoptions&gt;</strong></p>
      <p><strong>&lt;/lfoptions&gt;</strong></p>
      <p><strong>&lt;lfbinding&gt;</strong></p>
      <p>&lt;textvar name="LandUse" value="$(PathMaps)/landuse.map"&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="SoilDepth"
value="$(PathMaps)/soildep.map"&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p><strong>&lt;/lfbinding&gt;</strong></p>
      <p><strong>&lt;/lfsettings&gt;</strong></p>
      </td>
    </tr>
  </tbody>
</table>

<p>In the example two input files (maps) are defined. Both maps are in
the same directory. Instead of entering the full file path for every
map, we define a variable called <em>PathMaps</em> in the ‘lfuser’
element. This variable can then be used in the ‘lfbinding’ element.
Note that in the ‘lfbinding’ element you should always wrap
user-defined variables in brackets and add a leading dollar sign, e.g. <em>$(PathMaps)</em>.
Since the names of the in- and output files are usually the same for
each model run, the use of user-defined variables greatly simplifies
setting up the model for new catchments. In general, it is a good idea
to use user-defined variables for <em>everything</em> that needs to be
changed on a regular basis (paths to input maps, tables, meteorological
data, parameter values). This way you only have to deal with the
variables in the ‘lfuser’ element, without having to worry about
anything in ‘lfbinding’ at all.</p>

<p>Now for a somewhat more realistic example:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p>
      <p>&lt;!DOCTYPE lfsettings SYSTEM "lisflood.dtd"&gt;</p>
      <p><strong>&lt;lfsettings&gt;</strong></p>
      <p><strong>&lt;lfuser&gt;</strong></p>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>CALIBRATION PARAMETERS</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="UpperZoneTimeConstant" value="10"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Time constant for water in upper zone [days*mm^GwAlpha]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>FILE PATHS</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="PathMeteo"
value="//cllx01/floods2/knijfjo/test/meteo"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Meteo path</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>PREFIXES OF METEO VARIABLES</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="PrefixPrecipitation" value="pr"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>prefix precipitation maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p><strong>&lt;/lfuser&gt;</strong></p>
      <p><strong>&lt;lfoptions&gt; &lt;/lfoptions&gt;</strong></p>
      <p><strong>&lt;lfbinding&gt;</strong></p>
      <p>&lt;textvar name="UpperZoneTimeConstant"
value="$(UpperZoneTimeConstant)"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Time constant for water in upper zone [days*mm^GwAlpha]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrecipitationMaps"
value="$(PathMeteo)/$(PrefixPrecipitation)"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>precipitation [mm/day]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p><strong>&lt;/lfbinding&gt;</strong></p>
      <p><strong>&lt;/lfsettings&gt;</strong></p>
      </td>
    </tr>
  </tbody>
</table>

<p>From this example, note that <em>anything</em> can be defined with
‘lfuser’ variables, whether it be paths, file prefixes or parameter
value. At first sight it might seem odd to define model parameter like <em>UpperZoneTimeConstant</em>
as a text variable when it is already defined in the ‘lfbinding’
element. However, in practice it is much easier to have all the
important variables defined in the same element: in total the model
needs around 200 variables, parameters and file names. By specifying
each of those in the ‘lfbinding’ element you need to specify each of
them separately. Using the ‘lfuser’ variables this can be reduced to
about 50, which greatly simplifies things. You should think of the
‘lfbinding’ element as a low-level way of describing the model in- and
output structure: anything can be changed and any file can be in any
given location, but the price to pay for this flexibility is that the
definition of the input structure will take a lot of work. By using the
‘lfuser’ variables in a smart way, custom template settings files can
be created for specific model applications (calibration, scenario
modelling, operational flood forecasting). Typically, each of these
applications requires its own input structure, and you can use the
‘lfuser’ variables to define this structure. Also, note that the both
the <em>name</em> and <em>value</em> of each variable must be wrapped
in (single or double) quotes. Dedicated XML-editors like XmlSpy take
care of this automatically, so you won’t usually have to worry about
this.</p>

<p><strong><span class="underline">NOTES:</span></strong></p>

<ol type="1">

  <li>
    <p>It is important to remember that the <em>only</em> function of
the ‘lfuser’ element is to <em>define</em> text variables; you can not
    <em>use</em> any of these text variables within the ‘lfuser’
element. For example, the following ‘lfuser’ element is <em>wrong</em>
and <em>will not work</em>:</p>
  </li>
</ol>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p><strong>&lt;lfuser&gt;</strong></p>
      <p>&lt;textvar name="PathInit"
value="//cllx01/floods2/knijfjo/test/init"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Path to initial conditions maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="LZInit" value="$(PathInit)/lzInit.map)"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Initial lower zone storage</p>
      <p>** USE OF USER VARIABLE WITHIN LFUSER</p>
      <p>** IS NOT ALLOWED, SO THIS EXAMPLE WILL NOT WORK!!</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p><strong>&lt;/lfuser&gt;</strong></p>
      </td>
    </tr>
  </tbody>
</table>

<ol start="2" type="1">

  <li>
    <p>It <em>is</em> possible to define <em>everything</em> directly
in the ‘lfbinding’ element without using any text variables at all! In
that case the ‘lfuser’ element can remain empty, even though it <em>has</em>
to be present (i.e. &lt;lfuser&gt; &lt;/lfuser&gt;). In general this is
not recommended.</p>
  </li>
  <li>
    <p>Within the <em>lfuser</em> and <em>lfbinding</em> elements,
model variables are organised into <em>groups</em>. This is just to
make navigation in an xml editor easier.</p>
  </li>
</ol>

<h3 id="variables-in-the-lfbinding-element">Variables in the lfbinding
element</h3>

<p>The variables that are defined in the ‘lfbinding’ element fall in
either of the following categories:</p>

<ol type="1">

  <li>
    <p><strong>Single map</strong></p>
  </li>
</ol>

<blockquote>
  <p>Example:</p>
  <p>&lt;textvar name="LandUse" value="$(PathMaps)/landuse.map"&gt;</p>
  <p>&lt;comment&gt;</p>
  <p>Land Use Classes</p>
  <p>&lt;/comment&gt;</p>
  <p>&lt;/textvar&gt;</p>
</blockquote>

<ol start="2" type="1">

  <li>
    <p><strong>Table</strong></p>
  </li>
</ol>

<blockquote>
  <p>Example:</p>
  <p>&lt;textvar name="TabKSat1" value="$(PathTables)/ksat1.txt"&gt;</p>
  <p>&lt;comment&gt;</p>
  <p>Saturated conductivity [cm/day]</p>
  <p>&lt;/comment&gt;</p>
  <p>&lt;/textvar&gt;</p>
</blockquote>

<ol start="3" type="1">

  <li>
    <p><strong>Stack of maps</strong></p>
  </li>
</ol>

<blockquote>
  <p>Example:</p>
  <p>&lt;textvar name="PrecipitationMaps"</p>
  <p>value="$(PathMeteo)/$(PrefixPrecipitation)"&gt;</p>
  <p>&lt;comment&gt;</p>
  <p>precipitation [mm/day]</p>
  <p>&lt;/comment&gt;</p>
  <p>&lt;/textvar&gt;</p>
</blockquote>

<p><strong><span class="underline">Note:</span></strong></p>

<blockquote>
  <p>Taking -as an example- a prefix that equals “<em>pr</em>”, the
name of each map in the stack starts with “<em>pr</em>”,
and ends with the number of the time step. The name of each map is made
up of a total of 11 characters: 8 characters, a dot and a 3-character
suffix. For instance:</p>
</blockquote>

<table>

  <thead>
  <tr class="header">
    <th>pr000000.007</th>
    <th>: at time step 7</th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>pr000035.260</td>
      <td>: at time step 35260</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>To avoid unexpected behaviour, do <strong>not</strong> use
numbers in the prefix! For example:</p>
  <p>&lt;textvar name="PrecipitationMaps"</p>
  <p>value="$(PathMeteo)/pr10 "&gt;</p>
  <p>&lt;comment&gt;</p>
  <p>precipitation [mm/day]</p>
  <p>&lt;/comment&gt;</p>
  <p>&lt;/textvar&gt;</p>
  <p>For the first time step this yields the following file name:</p>
</blockquote>

<table>

  <tbody>
    <tr class="odd">
      <td>pr100000.001</td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>But this is actually interpreted as time step 100,000,001!</p>
</blockquote>

<ol start="4" type="1">

  <li>
    <p><strong>Time series file</strong></p>
  </li>
</ol>

<blockquote>
  <p>Example:</p>
</blockquote>

<p>&lt;textvar name="DisTS" value="$(PathOut)/dis.tss"&gt;</p>

<p>&lt;comment&gt;</p>

<p>Reported discharge [cu m/s]</p>

<p>&lt;/comment&gt;</p>

<p>&lt;/textvar&gt;</p>

<ol start="5" type="1">

  <li>
    <p><strong>Single parameter value</strong></p>
  </li>
</ol>

<blockquote>
  <p>Example:</p>
  <p>&lt;textvar name="UpperZoneTimeConstant"
value="$(UpperZoneTimeConstant)"&gt;</p>
  <p>&lt;comment&gt;</p>
  <p>Time constant for water in upper zone [days]</p>
  <p>&lt;/comment&gt;</p>
  <p>&lt;/textvar&gt;</p>
</blockquote>

<h3 id="variables-in-the-lfuser-element">Variables in the lfuser element</h3>

<p>As said before the variables in the ‘lfuser’ elements are all text
variables, and they are used simply to substitute text in the
‘lfbinding’ element. In practice it is sometimes convenient to use the
same name for a text variable that is defined in the ‘lfuser’ element
and a ‘lfbinding’ variable. For example:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p><strong>&lt;lfuser&gt;</strong></p>
      <p>&lt;textvar name="UpperZoneTimeConstant" value="10"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Time constant for water in upper zone [days]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p><strong>&lt;/lfuser&gt;</strong></p>
      <p><strong>&lt;lfbinding&gt;</strong></p>
      <p>&lt;textvar name="UpperZoneTimeConstant"
value="$(UpperZoneTimeConstant)"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Time constant for water in upper zone [days]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p><strong>&lt;/lfbinding&gt;</strong></p>
      </td>
    </tr>
  </tbody>
</table>

<p>In this case ‘UpperZoneTimeConstant’ in the ‘lfuser’ element (just a
text variable) is something different from ‘UpperZoneTimeConstant’ in
the ‘lfbinding’ element!</p>


<h3 id="lfoption-element">lfoption element</h3>

<p>The ‘lfoption’ element effectively allows you to switch certain
parts of the model on or off. Within LISFLOOD, there are two categories
of options:</p>

<ol type="1">

  <li>
    <p>Options to activate the reporting of additional output maps and
time series (e.g. soil moisture maps)</p>
  </li>
  <li>
    <p>Options that activate special LISFLOOD features, such as inflow
hydrographs and the simulation of reservoirs</p>
  </li>
</ol>

<h3 id="viewing-available-options">Viewing available options</h3>

<p>You can view all options by running LISFLOOD with the <em>--listoptions</em>
flag. For each option, the following information is listed:</p>

<p>OptionName Choices DefaultValue</p>

<p>‘OptionName’ -as you might have guessed already- simply is the name
of the option. ‘Choices’ indicates the possible values of the option,
and ‘DefaultValue’ describes the default behaviour. For instance, if
you look at the reservoir option:</p>

<p>simulateReservoirs choices=(1,0) default=0</p>

<p>you see that the value of this option is either 0 (off) or 1 (on),
and that the default value is 0 (off, i.e. do not simulate any
reservoirs).</p>

<p>The information on the reporting options is a little bit different
(and slightly confusing). Looking at the option for reporting discharge
maps:</p>

<p>repDischargeMaps choices=(1) noDefault</p>

<p>By default, discharge maps are not reported, so you would expect
something like “default=0”. However, due to the way options are defined
internally in the model, in this case we have no default value, which
means it is switched off.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>
Report options that are switched <em>on</em> by default look like this:</p>

<p>repStateMaps choices=(1) default=1</p>

<p>To minimise the confusion, you should:</p>

<ol type="1">

  <li>
    <p>Ignore the “Choices” item</p>
  </li>
  <li>
    <p>Interpret “noDefault” as “default=0”</p>
  </li>
</ol>

<p>This is all a bit confusing, and the displaying of option
information may well change in future LISFLOOD versions.</p>

<h3 id="defining-options">Defining options</h3>

<p>Within the ‘lfoptions’ element of the settings file, each option is
defined using a ‘setoption’ element, which has the attributes ‘name’
and ‘choice’ (i.e. the actual value). For example:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p><strong>&lt;lfoptions&gt;</strong></p>
      <p>&lt;setoption choice="1" name="inflow" /&gt;</p>
      <p><strong>&lt;/lfoptions&gt;</strong></p>
      </td>
    </tr>
  </tbody>
</table>

<p>You are not obliged to use any options: if you leave the ‘lfoptions’
element empty, LISFLOOD will simply run using the default values (i.e.
run model without optional modules; only report most basic output
files). However, the ‘lfoptions’ element itself (i.e. &lt;lfoptions&gt;
&lt;/lfoptions&gt;) <em>has</em> to be present, even if empty!</p>

<h1 id="preparing-the-settings-file">6. Preparing the settings file</h1>

<p>This chapter describes how to prepare your own settings file.
Instead of writing the settings file completely from scratch, we
suggest to use the settings template that is provided with LISFLOOD as
a starting point. In order to use the template, you should make sure
the following requirements are met:</p>

<ul>

  <li>
    <p>All input maps and tables are named according to default file
names (see Chapter 4 and Annex 12)</p>
  </li>
  <li>
    <p>All base maps are in the right directories</p>
  </li>
  <li>
    <p>All tables are in one directory</p>
  </li>
  <li>
    <p>All meteo input is in one directory</p>
  </li>
  <li>
    <p>All Leaf Area Index input is in the right directories</p>
  </li>
  <li>
    <p>An (empty) directory where all model data can be written exists</p>
  </li>
</ul>

<p>If this is all true, the settings file can be prepared very quickly
by editing the items in the ‘lfuser’ element. The following is a
detailed description of the different sections of the ‘lfuser’ element.
The present LISFLOOD version contains process-related parameters (not
taking into account the parameters that are defined through the maps).
These are all defined in the ‘lfuser’ element, and default values are
given for each of them. Even though <em>any</em> of these parameters
can be treated as calibration constants, doing so for <em>all</em>
of them would lead to serious over-parameterisation problems. In the
description of these parameters we will therefore provide some
suggestions as to which parameters should be used for calibration, and
which one are better left untouched.</p>

<h2 id="time-related-constants">Time-related constants</h2>

<p>The ‘lfuser’ section starts with a number of constants that are
related to the simulation period and the time interval used. These are
all defined as single values.</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>TIME-RELATED CONSTANTS</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="CalendarDayStart" value="01/01/1990"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Calendar day of 1st day in model run</p>
      <p>Day of the year of first map (e.g. xx0.001) even if the model
start from map e.g. 500</p>
      <p>e.g. 1st of January: 1; 1st of June 151 (or 152 in leap year)</p>
      <p>Needed to read out LAI tables correctly</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="DtSec" value="86400"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>timestep [seconds]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="DtSecChannel" value="86400"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Sub time step used for kinematic wave channel routing [seconds]</p>
      <p>Within the model,the smallest out of DtSecChannel and DtSec is
used</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="StepStart" value="1"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Number of first time step in simulation</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="StepEnd" value="10"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Number of last time step in simulation</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="ReportSteps" value="endtime"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Time steps at which to write model state maps (i.e. only</p>
      <p>those maps that would be needed to define initial conditions</p>
      <p>for succeeding model run)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>CalendarDayStart</em> is the calendar day of the first map in
a
map stack e.g. pr000000.001. Even if you start the model from time step
500, this has to be set to the calendar day of the 001 map in your map
stacks.<br>
Format can be a number:</p>
  <p><em>Value=”1” = 1<sup>st</sup> January, Value=”151” = 1<sup>st</sup>
June</em></p>
  <p>Or date (in different format):</p>
  <p><em>Value=”01/01/1990” = 1<sup>st</sup> January 1990,
Value=”05.07.1990” = 5th June 1990,</em></p>
  <p><em>Value=”15-11-1990” = 15<sup>th</sup> November 1990</em></p>
  <p><em>DtSec</em> is the simulation time interval in seconds. It has
a
value of 86400 for a daily time interval, 3600 for an hourly interval,
etcetera</p>
  <p><em>DtSecChannel</em> is the simulation time interval used by the
kinematic wave channel routing (in seconds). Using a value that is
smaller than <em>DtSec</em>
may result in a better simulation of the overall shape the calculated
hydrograph (at the expense of requiring more computing time)</p>
  <p><em>StepStart</em> is the number of the first time step in your
simulation. It is normally set to 1. Other (larger) values can be used
if you want to run LISFLOOD for only a part of the time period for
which you have meteo and LAI maps.</p>
  <p><em>StepEnd</em> is the number of the last time step in your
simulation.</p>
  <p><em>ReportSteps</em> defines the time step number(s) at which the
model state (i.e. all maps that you would need to define the initial
conditions of a succeeding model run) is written. You can define this
parameter as a (comma separated) list of time steps. For example:</p>
  <p>&lt;textvar name="ReportSteps" value="10,20,40"&gt;</p>
  <p>will result in state maps being written at time steps 10, 20 and
40. For the <em>last</em> time step of a model run you can use the
special ‘endtime’ keyword, e.g.:</p>
  <p>&lt;textvar name="ReportSteps" value="endtime"&gt;</p>
  <p>Alternatively, in some cases you may need the state maps at
regular intervals. In that case you can use the following syntax:</p>
  <p>&lt;textvar name="ReportSteps" value="start+increment..end"&gt;</p>
  <p>For instance, in the following example state maps are written
every 5<sup>th</sup> time step, starting at time step 10, until the
last time step:</p>
  <p>&lt;textvar name="ReportSteps" value="10+5..endtime"&gt;</p>
</blockquote>

<h2 id="parameters-related-to-evapotranspiration-and-interception">Parameters
related to evapo(transpi)ration and interception</h2>

<p>The following parameters are all related to the simulation of
evapo(transpi)ration and rainfall interception. Although they can all
be defined as either a single value or as a map, we recommend using the
single values that are included in the template. We do not recommend
using any of these parameters as calibration constants.</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>PARAMETERS RELATED TO EVAPO(TRANSPI)RATION AND INTERCEPTION</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="PrScaling" value="1"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Multiplier applied to potential precipitation rates</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="CalEvaporation" value="1"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Multiplier applied to potential evapo(transpi)ration rates</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="LeafDrainageTimeConstant" value="1"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Time constant for water in interception store [days]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="kdf" value="0.72"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Average extinction coefficient for the diffuse radiation flux</p>
      <p>varies with crop from 0.4 to 1.1 (Goudriaan (1977))</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="AvWaterRateThreshold" value="5"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Critical amount of available water (expressed in [mm/day]!),
above which 'Days Since Last Rain' parameter is set to 1</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="SMaxSealed" value="1.0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>maximum depression storage for water on impervious surface</p>
      <p>which is not immediatly causing surface runoff [mm]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>PrScaling</em> is a multiplier that is applied to
precipitation input (pr) [-]</p>
  <p><em>CalEvaporation</em> is a multiplier that is applied to the
potential evapo(transpi)ration input (<em>ET0</em>, <em>EW0</em> and <em>ES0</em>)
[-]</p>
  <p><em>LeafDrainageTimeConstant</em> (<em>T<sub>int</sub></em> in Eq
2-11) is the time constant for the interception store [days]</p>
  <p><em>kdf</em> is the average extinction for the diffuse radiation
flux (Goudriaan, 1977). it is used to calculate the extinction
coefficient for global radiation, <em>κ<sub>gb</sub></em> ,which is
used in Equations 2-9, 2-14 and 2-19 [-]</p>
  <p><em>AvWaterRateThreshold</em> defines a critical amount of water
that is used as a threshold for resetting the variable <em>D<sub>slr</sub></em>
in Eq 2-20. Because the equation was originally developed for daily
timesteps only, the threshold is currently defined (somewhat
confusingly) as an equivalent <em>intensity</em> in [mm day<sup>-1</sup>]</p>
  <p><em>SMaxSealed</em> is the maximum depression storage on
impervious surface [mm]. This storage is emptied by evaporation (EW0).</p>
</blockquote>

<h2 id="parameters-related-to-snow-and-frost">Parameters related to
snow and frost</h2>

<p>The following parameters are all related to the simulation of snow
accumulation, snowmelt and frost. All these parameters can be defined
as either single values or maps. We recommend to start out by leaving
them all at their default values. If prior data suggest major under- or
overcatch problems in the observed snowfall, <em>SnowFactor</em> can
be adjusted accordingly. <em>SnowMeltCoef</em>
may be used as a calibration constant, but since snow observations are
typically associated with large uncertainty bands, the calibration may
effectively just be compensating for these input errors.</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>SNOW AND FROST RELATED PARAMETERS</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="SnowFactor" value="1"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Multiplier applied to precipitation that falls as snow</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="SnowSeasonAdj" value="1.0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>range [mm C-1 d-1] of the seasonal variation</p>
      <p>SnowMeltCoef is the average value</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="SnowMeltCoef" value="4.5"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Snowmelt coefficient [mm/deg C /day]</p>
      <p>See also Martinec et al., 1998.</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="TempMelt" value="0.0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Average temperature at which snow melts</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="TempSnow" value="1.0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Average temperature below which precipitation is snow</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="TemperatureLapseRate" value="0.0065"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Temperature lapse rate with altitude [deg C / m]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="Afrost" value="0.97"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Daily decay coefficient, (Handbook of Hydrology, p. 7.28)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="Kfrost" value="0.57"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Snow depth reduction coefficient, [cm-1], (HH, p. 7.28)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="SnowWaterEquivalent" value="0.45"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Snow water equivalent, (based on snow density of 450 kg/m3)
(e.g. Tarboton and Luce, 1996)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="FrostIndexThreshold" value="56"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Degree Days Frost Threshold (stops infiltration, percolation
and capillary rise)</p>
      <p>Molnau and Bissel found a value 56-85 for NW USA.</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>SnowFactor</em> is a multiplier that is applied to the rate of
precipitation in case the precipitation falls as snow. Since snow is
commonly underestimated in meteorological observation data, setting
this multiplier to some value greater than 1 can counteract for this [-]</p>
  <p><em>SnowSeasonAdj</em> is the range [mm C-1 d-1] of the seasonal
variation of snow melt. SnowMeltCoef is the average value.</p>
  <p><em>SnowMeltCoef</em> (<em>C<sub>m</sub></em> in Eq 2-3) is the
degree-day factor that controls the rate of snowmelt [mm °C<sup>-1</sup>
day<sup>-1</sup>]</p>
  <p><em>TempMelt</em> (<em>T<sub>m</sub></em> in Eq 2-3) is the
average temperature above which snow starts to melt [°C]</p>
  <p><em>TempSnow</em> is the average temperature below which
precipitation is assumed to be snow [°C]</p>
  <p><em>TemperatureLapseRate</em> (<em>L</em> in Figure 2.2) is the
temperature lapse rate that is used to estimate average temperature at
the centroid of each pixel’s elevation zones [°C m<sup>-1</sup>]</p>
  <p><em>Afrost</em> (<em>A</em> in Eq 2-4) is the frost index decay
coefficient [day<sup>-1</sup>]. It has a value in the range 0-1.</p>
  <p><em>Kfrost</em> (<em>K</em> in Eq 2-4) is a snow depth reduction
coefficient [cm<sup>-1</sup>]</p>
  <p><em>SnowWaterEquivalent</em> (<em>we<sub>s</sub></em> in Eq 2-4)
is the equivalent water depth of a given snow cover, expressed as a
fraction [-]</p>
  <p><em>FrostIndexThreshold</em> is the critical value of the frost
index (Eq 2-5) above which the soil is considered frozen [°C day<sup>-1</sup>]</p>
</blockquote>

<h2 id="infiltration-parameters">Infiltration parameters </h2>

<p>The following two parameters control the simulation of infiltration
and preferential flow. Both are empirical parameters that are treated
as calibration constants, and both can be defined as single values or
maps.</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>INFILTRATION PARAMETERS</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="b_Xinanjiang" value="0.1"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Power in Xinanjiang distribution function</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PowerPrefFlow" value="3"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Power that controls increase of proportion of preferential</p>
      <p>flow with increased soil moisture storage</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>b_Xinanjiang</em> (<em>b</em> in Eq 2-23) is the power in the
infiltration equation [-]</p>
  <p><em>PowerPrefFlow</em> (<em>c<sub>pref</sub></em> in Eq 2-25) is
the power in the preferential flow equation [-]</p>
</blockquote>

<h2 id="groundwater-parameters">Groundwater parameters </h2>

<p>The following parameters control the simulation shallow and deeper
groundwater. <em>GwLossFraction</em>
should be kept at 0 unless prior information clearly indicates that
groundwater is lost beyond the catchment boundaries (or to deep
groundwater systems). The other parameters are treated as calibration
constants. All these parameters can be defined as single values or maps.</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>GROUNDWATER RELATED PARAMETERS</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="UpperZoneTimeConstant" value="10"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Time constant for water in upper zone [days]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="LowerZoneTimeConstant" value="1000"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Time constant for water in lower zone [days]</p>
      <p>This is the average time a water 'particle' remains in the
reservoir</p>
      <p>if we had a stationary system (average inflow=average outflow)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="GwPercValue" value="0.5"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Maximum rate of percolation going from the Upper to the Lower</p>
      <p>response box [mm/day]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="GwLoss" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Maximum rate of percolation from the Lower response box
(groundwater loss) [mm/day].</p>
      <p>A value of 0 (closed lower boundary) is recommended as a
starting value</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>UpperZoneTimeConstant</em> (<em>T<sub>uz</sub></em> in Eq
2-42) is the time constant for the upper groundwater zone [days]</p>
  <p><em>LowerZoneTimeConstant</em> (<em>T<sub>lz</sub></em> in Eq
2-43) is the time constant for the lower groundwater zone [days]</p>
  <p><em>GwPercValue</em> (<em>GW<sub>perc</sub></em> in Eq 2-44) is
the maximum rate of percolation going from the upper to the lower
groundwater zone [mm day<sup>-1</sup>]</p>
  <p><em>GwLoss</em> (<em>f<sub>loss</sub></em> in Eq 2-45) is the
maximum rate of percolation from the lower groundwater zone
(groundwater loss) zone [mm day<sup>-1</sup>]. A value of 0 (closed
lower boundary) is recommended as a starting value.</p>
</blockquote>

<h2 id="routing-parameters">Routing parameters </h2>

<p>These parameters are all related to the routing of water in the
channels as well as the routing of surface runoff. The multiplier <em>CalChanMan</em>
can be used to fine-tune the timing of the channel routing, and it may
be defined as either a single value or a map. All other parameters
should be kept at their default values.</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>ROUTING PARAMETERS</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="CalChanMan" value="1"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Multiplier applied to Channel Manning's n</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="beta" value="0.6"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>kinematic wave parameter: 0.6 is for broad sheet flow</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="OFDepRef" value="5"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Reference depth of overland flow [mm], used to compute</p>
      <p>overland flow Alpha for kin. wave</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="GradMin" value="0.001"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Minimum slope gradient (for kin. wave: slope cannot be 0)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="ChanGradMin" value="0.0001"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Minimum channel gradient (for kin. wave: slope cannot be 0)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>CalChanMan</em> is a multiplier that is applied to the
Manning’s roughness maps of the channel system [-]</p>
  <p><em>beta</em> is routing coefficient <em>β<sub>k</sub></em> in
Equations 2-51, 2-52, 2-54 and 2-57 [-]</p>
  <p><em>OFDepRef</em> is a reference flow depth from which the flow
velocity of the surface runoff is calculated [mm]</p>
  <p><em>GradMin</em> is a lower limit for the slope gradient used in
the calculation of the surface runoff flow velocity [m m<sup>-1</sup>]</p>
  <p><em>ChanGradMin</em> is a lower limit for the channel gradient
used in the calculation of the channel flow velocity [m m<sup>-1</sup>]</p>
</blockquote>

<h2 id="parameters-related-to-numerics">Parameters related to numerics</h2>

<p>This category only contains one parameter at the moment, which can
only be a single value. We strongly recommend keeping this parameter at
its default value.</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>PARAMETERS RELATED TO NUMERICS</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="CourantCrit" value="0.4"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Minimum value for Courant condition in soil moisture routine</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>CourantCrit</em> (<em>C<sub>crit</sub></em> in Eq 2-36) is the
critical Courant number which controls the numerical accuracy of the
simulated soil moisture fluxes [-]. Any value between 0 and 1 can be
used, but using values that are too high can lead to unrealistic
“jumps” in the simulated soil moisture, whereas very low values result
in reduced computational performance (because many iterations will be
necessary to obtain the required accuracy). Values above 1 should never
be used, as they will result in a loss of mass balance. In most cases
the default value of 0.4 results in sufficiently realistic simulations
using just a few iterations.</p>
</blockquote>

<h2 id="file-paths">File paths</h2>

<p>Here you can specify where all the input files are located, and
where output should be written. Note that you can use both forward and
backward slashes on both Windows and Linux-based systems without any
problem (when LISFLOOD reads the settings file it automatically formats
these paths according to the conventions used by the operating system
used). The default settings template contains relative paths, which in
most cases allows you to run the model directly without changing these
settings (assuming that you execute LISFLOOD from the root directory of
your catchment).</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>FILE PATHS</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="PathOut" value="./out"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Output path</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PathInit" value="./out"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Path of the initial value maps e.g. lzavin.map</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PathMaps" value="./maps"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Maps path</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PathSoilHyd" value="./maps/soilhyd"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Maps instead tables for soil hydraulics path</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PathMapsFraction" value="./maps/fraction"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Maps of fraction of land cover (forest, water, sealed,other)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar</p>
      <p>&lt;textvar name="PathMapsTables" value="./maps/table2map"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Maps which replaced tables e.g. CropCoeff</p>
      <p>/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PathTables" value="./tables"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Tables path</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PathMeteo" value="./meteo"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Meteo path</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PathLAI" value="./lai"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Leaf Area Index maps path</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PathWaterUse" value="./wateruse"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Water use maps path</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>PathOut</em> is the directory where all output files are
written. It must be an existing directory (if not you will get an error
message – not immediately but after 256 timesteps, when the time series
are written for the first time)</p>
  <p><em>PathInit</em> is the directory where the initial files are
located, to initialize a “warm” start. It can be also the PathOut
directory</p>
  <p><em>PathMaps</em> is the directory where all input base maps are
located</p>
  <p><em>PathSoilHyd</em> is the directory where the soil hydraulic
property maps are located</p>
  <p><em>PathMapsFraction</em> is the directory where the land cover
fraction maps are located</p>
  <p><em>PathMapsTables</em> is the directory where maps are located
which were calculated from lookup tables in the previous version (e.g.
cropcoeff)</p>
  <p><em>PathTables</em> is the directory where all input tables are
located</p>
  <p><em>PathMeteo</em> is the directory where all maps with
meteorological input are located (rain, evapo(transpi)ration,
temperature)</p>
  <p><em>PathLAI</em> is the directory where you Leaf Area Index maps
are located</p>
  <p><em>PathWaterUse</em> is the directory where water use maps are
located (optional)</p>
</blockquote>

<h2 id="prefixes-of-meteo-and-vegetation-related-variables">Prefixes of
meteo and vegetation related variables</h2>

<p>Here you can define the prefix that is used for each meteorological
variable (and LAI and water use).</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>PREFIXES OF METEO AND VEGETATION RELATED VARIABLES</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="PrefixPrecipitation" value="pr"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>prefix precipitation maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrefixTavg" value="ta"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>prefix average temperature maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrefixE0" value="e"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>prefix E0 maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrefixES0" value="es"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>prefix ES0 maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrefixET0" value="et"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>prefix ET0 maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrefixLAI" value="olai"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>prefix LAI maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrefixLAIForest" value="flai"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>prefix forest LAI maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrefixWaterUse" value="wuse"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>prefix water use maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>Each variable is read as a stack of maps. The name of each map
starts with prefix, and ends with the number of the time step. All
characters in between are filled with zeroes. The name of each map is
made up of a total of 11 characters: 8 characters, a dot and a
3-character suffix. For instance, using a prefix ‘pr’ we get:</p>
</blockquote>

<table>

  <thead>
  <tr class="header">
    <th>pr000000.007</th>
    <th>: at time step 7</th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>pr000035.260</td>
      <td>: at time step 35260</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>To avoid unexpected behaviour, <strong>never</strong> use numbers
in the prefix! For example:</p>
  <p>PrefixRain=pr10</p>
  <p>For the first time step this yields the following file name:</p>
</blockquote>

<table>

  <tbody>
    <tr class="odd">
      <td>pr100000.001</td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>But this is actually interpreted as time step 100,000,001! <strong>Therefore,
do not use numbers in the prefix!</strong></p>
  <p>The corresponding part of the settings file is pretty
self-explanatory:</p>
  <p><em>PrefixPrecipitation</em> is the prefix of the precipitation
maps</p>
  <p><em>PrefixTavg</em> is the prefix of the daily average temperature
maps</p>
  <p><em>PrefixE0</em> is the prefix of the potential open-water
evaporation maps</p>
  <p><em>PrefixES0</em> is the prefix of the potential bare-soil
evaporation maps</p>
  <p><em>PrefixET0</em> is the prefix of the potential (reference)
evapotranspiration maps</p>
  <p><em>PrefixLAI</em> is the prefix of the Leaf Area Index maps</p>
  <p><em>PrefixLAIForest</em> is the prefix of the forest Leaf Area
Index maps</p>
  <p><em>PrefixWaterUse</em> is the prefix of the water use maps
(optional)</p>
</blockquote>

<h2 id="initial-conditions">Initial conditions</h2>

<p>As with the calibration parameters you can use both maps and single
values to define the catchment conditions at the start of a simulation.
Note that a couple of variables can be initialized internally in the
model (explained below). Also, be aware that the initial conditions
define the state of the model at <em>t=(StepStart -1)</em>. As long as
<em>StepStart</em> equals 1 this corresponds to <em>t=0</em>, but for
larger values of <em>StepStart</em> this is (obviously) not the case!</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>INITIAL CONDITIONS</p>
      <p>(maps or single values)</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="WaterDepthInitValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial overland flow water depth [mm]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="SnowCoverAInitValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial snow depth in snow zone A [mm]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="SnowCoverBInitValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial snow depth in snow zone B [mm]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="SnowCoverCInitValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial snow depth in snow zone C [mm]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="FrostIndexInitValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial Frost Index value</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="CumIntInitValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>cumulative interception [mm]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="UZInitValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>water in upper store [mm]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="DSLRInitValue" value="1"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>days since last rainfall</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="CumIntSealedInitValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>cumulative depression storage [mm]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>The following variables can also be initialized in the model</p>
      <p>internally. if you want this to happen set them to bogus value
of -9999</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="LZInitValue" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>water in lower store [mm]</p>
      <p>-9999: use steady-state storage</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="TotalCrossSectionAreaInitValue"
value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial cross-sectional area of flow in channel[m2]</p>
      <p>-9999: use half bankfull</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="ThetaInit1Value" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial soil moisture content layer 1</p>
      <p>-9999: use field capacity values</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="ThetaInit2Value" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial soil moisture content layer 2</p>
      <p>-9999: use field capacity values</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrevDischarge" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial discharge from previous run for lakes, reservoirs and
transmission loss</p>
      <p>only needed for lakes reservoirs and transmission loss</p>
      <p>-9999: use discharge of half bankfull</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>WaterDepthInitValue</em> is the initial amount of water on the
soil surface [mm]</p>
  <p><em>SnowCoverInitAValue</em> is the initial snow cover on the soil
surface in elevation zone <em>A</em> [mm]</p>
  <p><em>SnowCoverInitBValue</em> is the initial snow cover on the soil
surface in elevation zone <em>B</em> [mm]</p>
  <p><em>SnowCoverInitCValue</em> is the initial snow cover on the soil
surface in elevation zone <em>C</em> [mm]</p>
  <p><em>FrostIndexInitValue</em> (<em>F</em> in Eq 2-5) initial value
of the frost index [°C day<sup>-1</sup>]</p>
  <p><em>CumIntInitValue</em> is the initial interception storage [mm]</p>
  <p><em>UZInitValue</em> is the initial storage in the upper
groundwater zone [mm]</p>
  <p><em>DSLRInitValue</em> (<em>D<sub>slr</sub></em> in Eq 2-20) is
the initial number of days since the last rainfall event [days]</p>
  <p><em>CumIntSealedInitValue</em> is the initial value of the
depression storage for the sealed part of a pixel [mm]</p>
  <p><em>LZInitValue</em> is the initial storage in the lower
groundwater
zone [mm]. In order to avoid initialization problems it is possible to
let the model calculate a ‘steady state’ storage that will usually
minimize any initialization problems. This feature is described in
detail in Chapter 7 of this User Manual. To activate it, set <em>the</em>
lfoptions element InitLisflood to 1.</p>
  <p><em>TotalCrossSectionAreaInitValue</em> is the initial
cross-sectional area [m<sup>2</sup>] of the water in the river channels
(a substitute for initial discharge, which is directly dependent on
this). A value of <em>-9999</em> sets the initial amount of water in
the channel to half bankfull.</p>
  <p><em>ThetaInit1Value</em> is the initial moisture content [mm<sup>3</sup>
mm<sup>-3</sup>] of the upper soil layer. A value of -<em>9999</em>
will set the initial soil moisture content to field capacity.</p>
  <p><em>ThetaInit2Value</em> is the initial moisture content [mm<sup>3</sup>
mm<sup>-3</sup>] of the lower soil layer. A value of -<em>9999</em>
will set the initial soil moisture content to field capacity</p>
  <p><em>PrevDischarge</em> is the initial discharge from previous run
[m<sup>3</sup>s<sup>-1</sup>]
used for lakes, reservoirs and transmission loss (only needed if option
is on for lakes or reservoirs or transmission loss). Note that
PrevDischarge is discharge as an average over the time step (a flux) .
A value of <em>-9999</em> sets the initial amount of discharge to
equivalent of half bankfull.</p>
</blockquote>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>INITIAL CONDITIONS FOREST</p>
      <p>(maps or single values)</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="CumIntForestInitValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>cumulative interception [mm]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="UZForestInitValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>water in upper store [mm]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="DSLRForestInitValue" value="1"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>days since last rainfall</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="LZForestInitValue" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>water in lower store [mm]</p>
      <p>-9999: use steady-state storage</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="ThetaForestInit1Value" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial soil moisture content layer 1</p>
      <p>-9999: use field capacity values</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="ThetaForestInit2Value" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial soil moisture content layer 2</p>
      <p>-9999: use field capacity values</p>
      <p>&lt;/comment&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>CumIntForestInitValue, UZForestInitValue, DSLRForestInitValue,</em>
  <em>LZForestInitValue,</em> <em>ThetaForestInit1Value,
ThetaForestInit2Value are</em> the initial value for the forest part of
a pixel</p>
</blockquote>

<h2 id="running-the-model-1">Running the model</h2>

<p>To run the model, start up a command prompt (Windows) or a console
window (Linux) and type ‘lisflood’ followed by the name of the settings
file, e.g.:</p>

<p>lisflood settings.xml</p>

<p>If everything goes well you should see something like this:</p>

<p>LISFLOOD version March 01 2013 <strong>PCR2009W2M095</strong></p>

<p>Water balance and flood simulation model for large catchments</p>

<p>(C) Institute for Environment and Sustainability</p>

<p>Joint Research Centre of the European Commission</p>

<p>TP261, I-21020 Ispra (Va), Italy</p>

<p>Todo report checking within pcrcalc/newcalc</p>

<p>Created: /nahaUsers/burekpe/newVersion/CWstjlDpeO.tmp</p>

<p>pcrcalc version: Mar 22 2011 (linux/x86_64)</p>

<p>Executing timestep 1</p>

<p>The LISFLOOD version “March 01 2013 PCR2009W2M095” indicates the
date of the source code (01/03/2013), the oldest PCRASTER version it
works with (PCR2009), the version of XML wrapper (W2) and the model
version (M095).</p>

<h2 id="using-options">Using options</h2>

<p>As explained in Chapter 5, the ‘lfoptions’ element gives you
additional control over what LISFLOOD is doing. Using options it is
possible to switch certain parts of the model on or off. This way you
can tell the model exactly which output files are reported and which
ones aren’t. Also, they can be used to activate a number of additional
model features, such as the simulation of reservoirs and inflow
hydrographs.</p>

<p>The table in Annex 11 lists all currently implemented options and
their corresponding defaults. All currently implemented options are
switches (1= on, 0=off). You can set as many options as you want (or
none at all). Annex 11 lists all currently implemented options. Note
that each option generally requires additional items in the settings
file. For instance, using the inflow hydrograph option requires an
input map and time series, which have to be specified in the settings
file. If you want to report discharge maps at each time step, you will
first have to specify under which name they will be written. The
template settings file that is provided with LISFLOOD always contains
file definitions for all optional output maps and time series. The use
of the <em>output</em> options is described in detail in Chapter 8.</p>

<p>Within the ‘lfoptions’ element of the settings file, each option is
defined using a ‘setoption’ element, which has the attributes ‘name’
and ‘choice’ (i.e. the actual value). For example:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p><strong>&lt;lfoptions&gt;</strong></p>
      <p>&lt;setoption choice="1" name="inflow" /&gt;</p>
      <p><strong>&lt;/lfoptions&gt;</strong></p>
      </td>
    </tr>
  </tbody>
</table>

<h1 id="initialisation-of-lisflood"><br>
7. Initialisation of LISFLOOD</h1>

<h2 id="introduction-1">Introduction</h2>

<p>Just as any other hydrological model, LISFLOOD needs to have some
estimate of the initial state (i.e. amount of water stored) of its
internal state variables. Two situations can occur:</p>

<ol type="1">

  <li>
    <p>The initial state of all state variables is known (for example,
the “end maps” of a daily water balance run are used to define the
initial conditions of an hourly flood-event run)</p>
  </li>
  <li>
    <p>The initial state of all state variables is unknown</p>
  </li>
</ol>

<p>The second situation is the most common one, and this chapter
presents an in-depth look at the initialisation of LISFLOOD. First the
effect of the model’s initial state on the results of a simulation is
demonstrated using a simple example. Then, LISFLOOD’s various
initialisation options are discussed. Most of this chapter focuses on
the initialisation of the lower groundwater zone, as this is the model
storage component that is the most difficult to in initialise.</p>

<h2 id="an-example">An example</h2>

<p>To better understand the impact of the initial model state on
simulation results, let’s start with a simple example. Figure 7.1 shows
3 LISFLOOD simulations of soil moisture for the upper soil layer. In
the first simulation, it was assumed that the soil is initially
completely saturated. In the second one, the soil was assumed to be
completely dry (i.e. at residual moisture content). Finally, a third
simulation was done where the initial soil moisture content was assumed
to be in between these two extremes.</p>


<embed src="e:%5Cgh-pages%5C/media/image96.emf" style="width: 5.625in; height: 3.69792in;">
<p><em><strong>Figure 7.1</strong> Simulation of soil moisture in upper
soil layer for a soil that is initially at saturation (s), at residual
moisture content (r) and in between ([s+r]/2) </em></p>

<p>What is clear from the Figure is that the initial amount of moisture
in the soil only has a marked effect on the start of each simulation;
after a couple of months the three curves converge. In other words, the
“memory” of the upper soil layer only goes back a couple of months (or,
more precisely, for time lags of more than about 8 months the
autocorrelation in time is negligible).</p>

<p>In theory, this behaviour provides a convenient and simple way to
initialise a model such as LISFLOOD. Suppose we want to do a simulation
of the year 1995. We obviously don’t know the state of the soil at the
beginning of that year. However, we can get around this by starting the
simulation a bit earlier than 1995, say one year. In that case we use
the year 1994 as a <em>warm-up</em> period, assuming that by the start
of 1995 the influence of the initial conditions (i.e. 1-1-1994) is
negligible. The very same technique can be applied to initialise
LISFLOOD’s other state variables, such as the amounts of water in the
lower soil layer, the upper groundwater zone, the lower groundwater
zone, and in the channel.</p>

<h2 id="setting-up-a-lisflood-run-cold-start">Setting up a LISFLOOD run
(cold start)</h2>

<p>When setting up a model run that includes a warm-up period, most of
the internal state variables can be simply set to 0 at the start of the
run. This applies to the initial amount of water on the soil surface (<em>WaterDepthInitValue</em>),
snow cover (<em>SnowCoverInitValue</em>), frost index (<em>FrostIndexInitValue</em>),
interception storage (<em>CumIntInitValue</em>), and storage in the
upper groundwater zone (<em>UZInitValue</em>). The initial value of the
‘days since last rainfall event’ (<em>DSLRInitValue</em>) is typically
set to 1.</p>

<p>For the remaining state variables, initialisation is somewhat less
straightforward. The amount of water in the channel (defined by <em>TotalCrossSectionAreaInitValue</em>)
is highly spatially variable (and limited by the channel geometry). The
amount of water that can be stored in the upper and lower soil layers (<em>ThetaInit1Value</em>,
<em>ThetaInit2Value</em>)
is limited by the soil’s porosity. The lower groundwater zone poses
special problems because of its overall slow response (discussed in a
separate section below). Because of this, LISFLOOD provides the
possibility to initialise these variables internally, and these special
initialisation methods can be activated by setting the initial values
of each of these variables to a special ‘bogus’ value of <em>-9999</em>.
Table 7.1 summarises these special initialisation methods:</p>

<table>

  <thead>
  <tr class="header">
    <th><em><strong>Table 7.1</strong> LISFLOOD special initialisation
methods<sup>1</sup></em></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><strong>Variable</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Initialisation method</strong></td>
    </tr>
    <tr class="even">
      <td>
      <p>ThetaInit1Value /</p>
      <p>ThetaForestInit2Value</p>
      </td>
      <td>initial soil moisture content upper soil layer (V/V)</td>
      <td>set to soil moisture content at field capacity</td>
    </tr>
    <tr class="odd">
      <td>ThetaInit2Value / ThetaForestInit2Value</td>
      <td>initial soil moisture content lower soil layer (V/V)</td>
      <td>set to soil moisture content at field capacity</td>
    </tr>
    <tr class="even">
      <td>
      <p>LZInitValue /</p>
      <p>LZForestInitValue</p>
      </td>
      <td>initial water in lower groundwater zone (mm)</td>
      <td>set to steady-state storage</td>
    </tr>
    <tr class="odd">
      <td>TotalCrossSectionAreaInitValue</td>
      <td>initial cross-sectional area of water in channels</td>
      <td>set to half of bankfull depth</td>
    </tr>
    <tr class="even">
      <td>PrevDischarge</td>
      <td>Initial discharge</td>
      <td>set to half of bankfull depth</td>
    </tr>
    <tr class="odd">
      <td><em><sup>1</sup>) These special initialisation methods are
activated by setting the value of each respective variable to a ‘bogus’
value of “-9999”</em></td>
    </tr>
  </tbody>
</table>

<p>Note that the “-9999” ‘bogus’ value can <em>only</em> be used with
the variables in Table 7.1; for all other variables they will produce
nonsense results! The initialisation of the lower groundwater zone will
be discussed in the next sections.</p>

<h2 id="initialisation-of-the-lower-groundwater-zone">Initialisation of
the lower groundwater zone</h2>

<p>Even though the use of a sufficiently long warm-up period usually
results in a correct initialisation, a complicating factor is that the
time needed to initialise any storage component of the model is
dependent on the average residence time of the water in it. For
example, the moisture content of the upper soil layer tends to respond
almost instantly to LISFLOOD’s meteorological forcing variables
(precipitation, evapo(transpi)ration). As a result, relatively short
warm-up periods are sufficient to initialise this storage component. At
the other extreme, the response of the lower groundwater zone is
generally very slow (especially for large values of <em>T<sub>lz</sub></em>).
Consequently, to avoid unrealistic trends in the simulations, very long
warm-up periods may be needed. Figure 7.2 shows a typical example for
an 8-year simulation, in which a decreasing trend in the lower
groundwater zone is visible throughout the whole simulation period.
Because the amount of water in the lower zone is directly proportional
to the baseflow in the channel, this will obviously lead to an
unrealistic long-term simulation of baseflow. Assuming the long-term
climatic input is more or less constant, the baseflow (and thus the
storage in the lower zone) should be free of any long-term trends
(although some seasonal variation is normal). In order to avoid the
need for excessive warm-up periods, LISFLOOD is capable of calculating
a ‘steady-state’ storage amount for the lower groundwater zone. This <em>steady
state</em> storage is very effective for reducing the lower zone’s
warm-up time. In the next sections the concept of <em>steady state</em>
is first explained, and it is shown how it can be used to speed up the
initialisation of a LISFLOOD run.</p>


<embed src="e:%5Cgh-pages%5C/media/image97.emf" style="width: 5.98958in; height: 3.70833in;">
<p><em><strong>Figure 7.2</strong> 8-year simulation of lower zone
storage. Note how the influence of the initial storage persists
throughout the simulation period. </em></p>

<h2 id="lower-groundwater-zone-steady-state-storage">Lower groundwater
zone: steady state storage</h2>

<p>The response of the lower groundwater zone is defined by two simple
equations. First, we have the inflow into the lower zone, which occurs
at the following rate [mm day<sup>-1</sup>]:</p>

<p>(7-1)</p>

<p>Here, <em>GW<sub>perc</sub></em> [mm day<sup>-1</sup>] is a
user-defined value (calibration constant), and <em>UZ</em> is the
amount of water available in the upper groundwater zone [mm]. The rate
of flow out of the lower zone [mm day<sup>-1</sup>] equals:</p>

<p>(7-2)</p>

<p>where <em>T<sub>lz</sub></em> is a reservoir constant [days], and <em>LZ</em>
is the amount of water that is stored in the lower zone [mm].</p>

<p>Now, let’s do a simple numerical experiment: assuming that <em>D<sub>uz,lz</sub></em>
is a constant value, we can take some arbitrary initial value for <em>LZ</em>
and then simulate (e.g. in a spreadsheet) the development over <em>LZ</em>
over time. Figure 7.3 shows the results of 2 such experiments. In the
upper Figure, we start with a very high initial storage (1500 mm). The
inflow rate is fairly small (0.2 mm/day), and <em>T<sub>lz</sub></em>
is quite small as well (which means a relatively short residence time
of the water in the lower zone). What is interesting here is that, over
time, the storage evolves asymptotically towards a constant state. In
the lower Figure, we start with a much smaller initial storage (50 mm),
but the inflow rate is much higher here (1.5 mm/day) and so is <em>T<sub>lz</sub></em>
(1000 days). Here we see an upward trend, again towards a constant
value. However, in this case the constant ‘end’ value is not reached
within the simulation period, which is mainly because <em>T<sub>lz</sub></em>
is set to a value for which the response is very slow.</p>

<p>At this point it should be clear that what you see in these graphs
is exactly the same behaviour that is also apparent in the ‘real’
LISFLOOD simulation in Figure 7.2. Being able to know the ‘end’
storages in Figure 7.3 in advance would be very helpful, because it
would eliminate any trends. As it happens, this can be done very easily
from the model equations. A storage that is constant over time means
that the in- and outflow terms balance each other out. This is known as
a <em>steady state</em> situation, and the constant ‘end’ storage is
in fact the <em>steady state storage</em>. The rate of change of the
lower zone’s storage at any moment is given by the continuity equation:</p>

<p>(7-3)</p>

<p>where <em>I</em> is the (time dependent) inflow (i.e. groundwater
recharge) and <em>O</em> is the outflow rate. For a situation where
the storage remains constant, we can write:</p>

<p>(7-4)</p>


<embed src="e:%5Cgh-pages%5C/media/image102.emf" style="width: 5.44792in; height: 7.40625in;">
<p><em><strong>Figure 7.3</strong> Two 10-year simulations of lower
zone storage with constant inflow. Upper Figure: high initial storage,
storage approaches steady-state storage (dashed) after about 1500 days.
Lower Figure: low initial storage, storage doesn’t reach steady-state
within 10 years.</em></p>

<p>This equation can be re-written as:</p>

<p>(7-5)</p>

<p>Solving this for <em>LZ</em> gives the steady state storage:</p>

<p>(7-6)</p>

<p>We can check this for our numerical examples:</p>

<table>

  <thead>
  <tr class="header">
    <th><em>T<sub>lz</sub></em></th>
    <th><em>I</em></th>
    <th><em>LZ<sub>ss</sub></em></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>250</td>
      <td>0.2</td>
      <td>50</td>
    </tr>
    <tr class="even">
      <td>1000</td>
      <td>1.5</td>
      <td>1500</td>
    </tr>
  </tbody>
</table>

<p>which corresponds exactly to the results of Figure 7.3.</p>

<h2 id="steady-state-storage-in-practice">Steady-state storage in
practice</h2>

<p>An actual LISFLOOD simulation differs from the previous example in 2
ways. First, in any real simulation the inflow into the lower zone is
not constant, but varies in time. This is not really a problem, since <em>LZ<sub>ss</sub></em>
can be computed from the <em>average</em>
recharge. However, this is something we do not know until the end of
the simulation! Also, the inflow into the lower zone is controlled by
the availability of water in the upper zone, which, in turn, depends on
the supply of water from the soil. Hence, it is influenced by any
calibration parameters that control behaviour of soil- and subsoil
(e.g. <em>T<sub>uz</sub></em>, <em>GW<sub>perc</sub></em>, <em>b</em>,
and so on). This means that –when calibrating the model- the average
recharge will be different for every parameter set. Note, however, that
it will <em>always</em> be smaller than the value of <em>GW<sub>perc</sub></em>,
which is used as an upper limit in the model.. Note that the pre-run
procedures include a sufficiently long warm-up period.</p>


<h3 id="use-pre-run-to-calculate-average-recharge">Use pre-run to
calculate average recharge</h3>

<p>Here, we first do a “pre-run” that is used to calculate the average
inflow into the lower zone. This average inflow can be reported as a
map, which is then used in the actual run. This involves the following
steps:</p>

<ol type="1">

  <li>
    <p>Set all the initial conditions to either 0,1 or -9999</p>
  </li>
  <li>
    <p>Activate the “InitLisflood” option by setting it active in the
‘lfoptions’ in the settings file:</p>
  </li>
</ol>

<blockquote>
  <p>&lt;setoption choice="1" name="InitLisflood"/&gt;</p>
</blockquote>

<ol start="3" type="1">

  <li>
    <p>Run the model for a longer period (if possible more than 3
years, best for the whole modelling period)</p>
  </li>
  <li>
    <p>Go back to the LISFLOOD settings file, and set the InitLisflood
inactive:</p>
  </li>
</ol>

<blockquote>
  <p>&lt;setoption choice="0" name="InitLisflood"/&gt;</p>
</blockquote>

<ol start="5" type="1">

  <li>
    <p>Run the model again using the modified settings file</p>
  </li>
</ol>

<p>In this case, the initial state of <em>LZ</em> is computed for the
correct average inflow, and the simulated storage in the lower zone
throughout the simulation shouldl not show any systematic (long-term)
trends. The obvious price to pay for this is that the pre-run increase
the computational load. However the pre-run will use a simplified
routing to decrease the computational run-time. As long as the
simulation period for the actual run and the pre-run are identical, the
procedure gives a 100% guarantee that the development of the lower zone
storage will be free of any systematic bias. Since the computed
recharge values are dependent on the model parameterisation used, in a
calibration setting the whole procedure must be repeated for each
parameter set!</p>

<h3 id="checking-the-lower-zone-initialisation">Checking the lower zone
initialisation </h3>

<p>The presence of any initialisation problems of the lower zone can be
checked by adding the following line to the ‘lfoptions’ element of the
settings file:</p>

<blockquote>
  <p>&lt;setoption name=" repStateUpsGauges"
choice="1"&gt;&lt;/setoption&gt;</p>
</blockquote>

<p>This tells the model to write the values of all state variables
(averages, upstream of contributing area to each gauge) to time series
files. The default name of the lower zone time series is ‘lzUps.tss’.
Figure 7.4 shows an example of an 8-year simulation that was done both
without (dashed line) and with a pre-run. The simulation without the
pre-run shows a steady decreasing trend throughout the 8-year period,
whereas the simulation for which the pre-run was used doesn’t show this
long-term trend (although in this specific case a modest increasing
trend is visible throughout the first 6 years of the simulation, but
this is related to trends in the meteorological input).</p>

<p><img src="e:%5Cgh-pages%5C/media/image105.png" alt="initLZDemo" style="width: 5.77083in; height: 3.23958in;"></p>

<p><em><strong>Figure 7.4</strong> Initialisation of lower groundwater
zone with and without using a pre-run. Note the strong decreasing trend
in the simulation without pre-run. </em></p>

<h2 id="using-a-previous-run-warm-start">Using a previous run (warm
start)</h2>

<p>At the end of each model run, LISFLOOD writes maps of all internal
state variables at the last time step. You can use these maps as the
initial conditions for a succeeding simulation. This is particularly
useful if you are simulating individual flood events on a small time
interval (e.g. hourly). For instance, to estimate the initial
conditions just before the flood you can do a ‘pre-run’ on a <em>daily</em>
time interval for the year before the flood. You can then use the ‘end
maps’ as the initial conditions for the hourly simulation.</p>

<p>In any case, you should be aware that values of some internal state
variables of the model (especially lower zone storage) are very much
dependent on the parameterisation used. Hence, suppose we have ‘end
maps’ that were created using some parameterisation of the model (let’s
say parameter set <em>A</em>), then these maps should <em>not</em> be
used as initial conditions for a model run with another
parameterisation (parameter set <em>B</em>).
If you decide to do this anyway, you are likely to encounter serious
initialisation problems (but these may not be immediately visible in
the output!). If you do this while calibrating the model (i.e.
parameter set <em>B</em> is the calibration set), this will render the
calibration exercise pretty much useless (since the output is the
result of a mix of different parameter sets). However, for <em>FrostIndexInitValue</em>
and <em>DSLRInitValue</em>
it is perfectly safe to use the ‘end maps’, since the values of these
maps do not depend on any calibration parameters (that is, only if you
do not calibrate on any of the frost-related parameters!). If you need
to calibrate for individual events (i.e.hourly), you should apply <em>each</em>
parameterisation on <em>both</em>
the (daily) pre-run and the ‘event’ run! This may seem awkward, but
there is no way of getting around this (except from avoiding
event-based calibration at all, which may be a good idea anyway).</p>

<h2 id="summary-of-lisflood-initialisation-procedure">Summary of
LISFLOOD initialisation procedure</h2>

<p>From the foregoing it is clear that the initialisation of LISFLOOD
can be done in a number of ways. Figure 7.5 gives an overview. As
already stated in the introduction section, any LISFLOOD simulation
will fall into either of the following two categories:</p>

<ol type="1">

  <li>
    <p>The initial state of all state variables is known and defined by
the end state of a previous run. In this case you can use the ‘end’
maps of the previous run’s state variables as the initial conditions of
you current run. Note that this requires that both simulations are run
using exactly the same parameter set! Mixing parameter sets here will
introduce unwanted artefacts into your simulation results.</p>
  </li>
  <li>
    <blockquote>
      <p>The initial state of all state variables is unknown. In this
case
you should run the model with a sufficient pre-run (if possible more
than 3 years, best for the whole modelling period) and InitLisflood=1.
The average recharge map that is generated from the pre-run can
subsequently be used as the average lower zone inflow estimate (<em>LZAvInflowEstimate</em>)
in the actual simulation, which will avoid any initialisation problems
of the lower groundwater zone</p>
    </blockquote>
  </li>
  <li>
    <blockquote>
      <p>Is it possible not to use the first year for further analysis
of
results, because this is the “warm-up” period for all the other
variables like snow, vegetation, soil (see e.g. figure 7.1 for soil
moisture)?<br>
Then leave or set all the initial conditions to either 0,1 or -9999 and
run the model with InitLisflood=0</p>
    </blockquote>
  </li>
  <li>
    <p>If you want to include the first year of modelling into your
analysis, you have to do a “warm-up” run (one year will usually do) to
initialize all the initial conditions. You have to set option
repEndMaps=1 to report end maps. Best possible solution is to use the
year before the actual modelling period. Second best is to use any one
year period to set up the initial conditions. After that you will have
the ‘end’ maps and you can proceed with 1. again</p>
  </li>
</ol>


<embed src="e:%5Cgh-pages%5C/media/image106.emf" style="width: 5.76042in; height: 4.32292in;">
<p><em><strong>Figure 7.5</strong> LISFLOOD initialisation flowchart </em></p>

<p><em><br>
</em></p>

<h1 id="output-generated-by-lisflood"><br>
8. Output generated by LISFLOOD</h1>

<h2 id="default-lisflood-output">Default LISFLOOD output</h2>

<p>LISFLOOD can generate a wide variety of output. Output is generated
as either maps or time series (PCRaster format, which can be visualised
with PCRaster’s ‘aguila’ application). Reporting of output files can be
switched on and off using options in the LISFLOOD settings file. Also,
a number of output files are specific to other optional modules, such
as the simulation of reservoirs. The following table lists all the
output time series that are reported by default (note that the file
names can always be changed by the user, although this is not
recommended):</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p><em><strong>Table 8.1</strong> LISFLOOD default output time
series</em></p>
      </td>
    </tr>
    <tr class="even">
      <td><strong>RATE VARIABLES AT GAUGES</strong></td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>File name</strong></td>
    </tr>
    <tr class="even">
      <td><strong><sup>1,2</sup></strong> channel discharge</td>
      <td>m<sup>3</sup> s<sup>-1</sup></td>
      <td>dis.tss</td>
    </tr>
    <tr class="odd">
      <td><strong>NUMERICAL CHECKS</strong></td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>File name</strong></td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> cumulative mass balance error</td>
      <td>m<sup>3</sup></td>
      <td>mbError.tss</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> cumulative mass balance error,
expressed as mm water slice (average over catchment)</td>
      <td>mm</td>
      <td>mbErrorMm.tss</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> number of sub-steps needed for
channel routing</td>
      <td>-</td>
      <td>NoSubStepsChannel.tss</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> number of sub-steps needed for
gravity-based soil moisture routine</td>
      <td>-</td>
      <td>steps.tss</td>
    </tr>
    <tr class="odd">
      <td>
      <p><strong><sup>1</sup></strong> Output only if option
‘InitLisflood’ = 1 (pre-run)</p>
      <p><strong><sup>2</sup></strong> Output only if option
‘InitLisflood’ = 0</p>
      </td>
    </tr>
  </tbody>
</table>

<p>To speed up the pre-run and to prevent that results are taken from
the pre-run, all additional output is disabled if option ‘InitLisflood’
= 1 is chosen. With ‘InitLisflood’ = 1 the output is limited to <em>dis.tss,
lzavin.map, lzavin_forest.map</em> and some other initial maps if
additional option like e.g. the double kinematic wave is chosen.</p>

<p>In addition to these time series, by default LISFLOOD reports maps
of all state variables at the last timestep of a simulation<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.
These maps can be used to define the initial conditions of a succeeding
simulation. For instance, you can do a 1-year simulation on a daily
time step, and use the ‘end maps’ of this simulation to simulate a
flood event using an hourly time step. Table 8.2 and Annex 13 list all
these maps. Note that some state variables are valid for the whole
pixel, whereas others are only valid for a sub-domain of each pixel.
This is indicated in the last column of the table.</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p><em><strong>Table 8.2</strong> LISFLOOD default state variable
output maps. These maps can be used to define the initial conditions of
another simulation</em></p>
      </td>
    </tr>
    <tr class="even">
      <td><strong>AVERAGE RECHARGE MAP (for lower groundwater zone)</strong>
(option InitLisflood)</td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>File name</strong></td>
      <td><strong>Domain</strong></td>
    </tr>
    <tr class="even">
      <td><strong><sup>1</sup></strong> average inflow to lower zone</td>
      <td>mm timestep<sup>-1</sup></td>
      <td>lzavin.map</td>
      <td>other fraction</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>1</sup></strong> average inflow to lower zone
(forest)</td>
      <td>mm timestep<sup>-1</sup></td>
      <td>lzavin_forest.map</td>
      <td>forest fraction</td>
    </tr>
    <tr class="even">
      <td><strong>INITIAL CONDITION MAPS at defined time steps</strong><a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> (option <em>repStateMaps</em>)</td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>File name</strong><a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></td>
      <td><strong>Domain</strong></td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> waterdepth</td>
      <td>mm</td>
      <td>wdepth00.xxx</td>
      <td>whole pixel</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> channel cross-sectional area</td>
      <td>m<sup>2</sup></td>
      <td>chcro000.xxx</td>
      <td>channel</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> days since last rain variable</td>
      <td>days</td>
      <td>dslr0000.xxx</td>
      <td>other pixel</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> snow cover zone <em>A</em></td>
      <td>mm</td>
      <td>scova000.xxx</td>
      <td>snow zone A (1/3<sup>rd</sup> pixel)</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> snow cover zone <em>B</em></td>
      <td>mm</td>
      <td>scovb000.xxx</td>
      <td>snow zone B (1/3<sup>rd</sup> pixel)</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> snow cover zone <em>C</em></td>
      <td>mm</td>
      <td>scovc000.xxx</td>
      <td>snow zone C (1/3<sup>rd</sup> pixel)</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> frost index</td>
      <td>°C days<sup>-1</sup></td>
      <td>frost000.xxx</td>
      <td>other pixel</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> cumulative interception</td>
      <td>mm</td>
      <td>cumi0000.xxx</td>
      <td>other pixel</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> soil moisture upper layer</td>
      <td>mm<sup>3</sup> mm<sup>-3</sup></td>
      <td>thtop000.xxx</td>
      <td>other fraction</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> soil moisture lower layer</td>
      <td>mm<sup>3</sup> mm<sup>-3</sup></td>
      <td>thsub000.xxx</td>
      <td>other fraction</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> water in lower zone</td>
      <td>mm</td>
      <td>lz000000.xxx</td>
      <td>other fraction</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> water in upper zone</td>
      <td>mm</td>
      <td>uz000000.xxx</td>
      <td>other fraction</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> days since last rain variable
(forest)</td>
      <td>days</td>
      <td>dslF0000.xxx</td>
      <td>forest pixel</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> cumulative interception (forest)</td>
      <td>mm</td>
      <td>cumF0000.xxx</td>
      <td>forest pixel</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> soil moisture upper layer
(forest)</td>
      <td>mm<sup>3</sup> mm<sup>-3</sup></td>
      <td>thFt0000.xxx</td>
      <td>forest fraction</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> soil moisture lower layer
(forest)</td>
      <td>mm<sup>3</sup> mm<sup>-3</sup></td>
      <td>thFs0000.xxx</td>
      <td>forest fraction</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> water in lower zone (forest)</td>
      <td>mm</td>
      <td>lzF00000.xxx</td>
      <td>forest fraction</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> water in upper zone (forest)</td>
      <td>mm</td>
      <td>uzF00000.xxx</td>
      <td>forest fraction</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> water in depression storage
(sealed)</td>
      <td>mm</td>
      <td>cseal000.xxx</td>
      <td>sealed fraction</td>
    </tr>
    <tr class="odd">
      <td>
      <p><strong><sup>1</sup></strong> Output only if option
‘InitLisflood’ = 1 (pre-run)</p>
      <p><strong><sup>2</sup></strong> Output only if option
‘InitLisflood’ = 0</p>
      </td>
    </tr>
  </tbody>
</table>

<h2 id="additional-output">Additional output</h2>

<p>Apart from the default output, the model can –optionally- generate
some additional time series and maps. Roughly this additional output
falls in either of the following categories:</p>

<p><strong>Time series</strong></p>

<ol type="1">

  <li>
    <p>Time series with values of model state variables at user-defined
locations (sites); reporting of these time series can be activated
using the option <em>repStateSites=1.</em> Note that ‘sites’ can be
either individual pixels or larger areas (e.g. catchments,
administrative areas, and so on). In case of larger areas the model
reports the average value for each respective area.</p>
  </li>
  <li>
    <p>Time series with values of model rate variables at user-defined
locations (sites); reporting of these time series can be activated
using the option <em>repRateSites=1</em></p>
  </li>
  <li>
    <p>Time series with values of meteorological input variables,
averaged over the area upstream of each gauge location; reporting of
these time series can be activated using the option <em>repMeteoUpsGauges=1</em></p>
  </li>
  <li>
    <p>Time series with values of model state variables, averaged over
area upstream of each gauge location; reporting of these time series
can be activated using the option <em>repStateUpsGauges=1</em></p>
  </li>
  <li>
    <p>Time series with values of model rate variables, averaged over
area upstream of each gauge location; reporting of these time series
can be activated using the option <em>repRateUpsGauges=1</em></p>
  </li>
  <li>
    <p>Time series that are specific to other options (e.g. simulation
of reservoirs).</p>
  </li>
</ol>

<p><strong>Maps</strong></p>

<ol type="1">

  <li>
    <p>Maps of discharge at each time step; reporting of these maps can
be activated using the option <em>repDischargeMaps=1</em></p>
  </li>
  <li>
    <p>Maps with values of driving meteorological values at each time
step</p>
  </li>
  <li>
    <p>Maps with values of model rate variables at each time step</p>
  </li>
  <li>
    <p>Maps that are specific to other options (e.g. simulation of
reservoirs).</p>
  </li>
</ol>

<p>In addition, some additional maps and time series may be reported
for debugging purposes. In general these are not of any interest to the
LISFLOOD user, so they remain undocumented here.</p>

<p>Note that the options <em>repStateUpsGauges</em>, <em>repRateUpsGauges</em>
and <em>repDischargeMaps</em>
tend to slow down the execution of the model quite dramatically. For
applications of the model where performance is critical (e.g. automated
calibration runs), we advise to keep them switched off, if possible.
The additional time series are listed in the Annex 13. Note again the
domains for which variables are valid: all <em>rate variables</em> are
reported as pixel-average values. Soil moisture and groundwater storage
are reported for the permeable fraction of each pixel only. The
reported snow cover is the average of the snow depths in snow zones A,
B and C.</p>

<p>By default, the names of the reported discharge maps start with the
prefix ‘<em>dis</em>’
and end with the time step number (the naming conventions are identical
to the ones used for the input maps with meteorological variables,
which is explained in Chapter 4). Annex 13 summarises all options to
report additional output maps. The previous remarks related to the
domains for which the state variable values are valid also apply to the
maps listed in Annex 13.</p>

<h1 id="references"><br>
References</h1>

<p>Anderson, 2006Anderson, E., 2006. <em>Snow Accumulation and
Ablation Model – SNOW-17</em>. Technical report.</p>

<p>Aston, A.R., 1979. Rainfall interception by eight small trees.
Journal of Hydrology 42, 383-396.</p>

<p>Bódis, 2009Bódis, K., 2009. <em>Development of a data set for
continental hydrologic modelling</em>.
Technical Report EUR 24087 EN JRC Catalogue number: LB-NA-24087-EN-C,
Institute for Environment and Sustainability, Joint Research Centre of
the European Commission Land Management and Natural Hazards Unit Action
FLOOD. Input layers related to topography, channel geometry, land cover
and soil characteristics of European and African river basins.</p>

<p>Chow, V.T., Maidment, D.R., Mays, L.M., 1988. Applied Hydrology,
McGraw-Hill, Singapore, 572 pp.</p>

<p>De Roo, A., Thielen, J., Gouweleeuw, B., 2003. LISFLOOD, a
Distributed Water-Balance, Flood Simulation, and Flood Inundation
Model, User Manual version 1.2. Internal report, Joint Research Center
of the European Communities, Ispra, Italy, 74 pp.</p>

<p>Fröhlich, W., 1996. Wasserstandsvorhersage mit dem Prgramm ELBA.
Wasserwirtschaft Wassertechnik, ISSN: 0043-0986, Nr. 7, 1996, 34-37.</p>

<p>Goudriaan, J., 1977. Crop micrometeorology: a simulation study.
Simulation Monographs. Pudoc, Wageningen.</p>

<p>Hock, 2003Hock, R., 2003. Temperature index melt modelling in
mountain areas. <em>Journal of Hydrology</em>, 282(1-4), 104–115.</p>

<p>Lindström, G., Johansson, B., Persson, M., Gardelin, M., Bergström,
S., 1997. Development and test of the distributed HBV-96 hydrological
model. Journal of Hydrology 201, 272-288.</p>

<p>Maidment, D.R. (ed.), 1993. Handbook of Hydrology, McGraw-Hill.</p>

<p>Martinec, J., Rango, A., Roberts, R.T., 1998. Snowmelt Runoff Model
(SRM) User's Manual (Updated Edition 1998, Version 4.0). Geographica
Bernensia, Department of Geography - University of Bern, 1999. 84pp.</p>

<p>Merriam, R.A., 1960. A note on the interception loss equation.
Journal of Geophysical Research 65, 3850-3851.</p>

<p>Molnau, M., Bissell, V.C., 1983. A continuous frozen ground index
for flood forecasting. In: Proceedings 51<sup>st</sup> Annual Meeting
Western Snow Conference, 109-119.</p>

<p>Rao, C.X. and Maurer, E.P., 1996. A simplified model for predicting
daily transmission losses in a stream channel. Water Resources
Bulletin, Vol. 31, No. 6., 1139-1146.</p>

<p>Speers, D.D. , Versteeg, J.D., 1979. Runoff forecasting for
reservoir operations – the past and the future. In: Proceedings 52<sup>nd</sup>
Western Snow Conference, 149-156.</p>

<p>Stroosnijder, L., 1982. Simulation of the soil water balance. In:
Penning de Vries, F.W.T., Van Laar, H.H. (eds), Simulation of Plant
Growth and Crop Production, Simulation Monographs, Pudoc, Wageningen,
pp. 175-193.</p>

<p>Stroosnijder, L., 1987. Soil evaporation: test of a practical
approach under semi-arid conditions. Netherlands Journal of
Agricultural Science 35, 417-426.</p>

<p>Supit I., A.A. Hooijer, C.A. van Diepen (eds.), 1994. System
Description of the WOFOST 6.0 Crop Simulation Model Implemented in
CGMS. Volume 1: Theory and Algorithms. EUR 15956, Office for Official
Publications of the European Communities, Luxembourg.</p>

<p>Supit, I. , van der Goot, E. (eds.), 2003. Updated System
Description of the WOFOST Crop Growth Simulation Model as Implemented
in the Crop Growth Monitoring System Applied by the European
Commission, Treemail, Heelsum, The Netherlands, 120 pp.</p>

<p>Todini, E., 1996. The ARNO rainfall––runoff model. Journal of
Hydrology 175, 339-382.</p>

<p>Van Der Knijff, J., De Roo, A., 2006. LISFLOOD – Distributed Water
Balance and Flood Simulation Model, User Manual. EUR 22166 EN, Office
for Official Publications of the European Communities, Luxembourg, 88
pp.</p>

<p>Van der Knijff, J., 2008. LISVAP– Evaporation Pre-Processor for the
LISFLOOD Water Balance and Flood Simulation Model, Revised User Manual.
EUR 22639 EN/2, Office for Official Publications of the European
Communities, Luxembourg, 31 pp.</p>

<p>Van Der Knijff, J., De Roo, A., 2008. LISFLOOD – Distributed Water
Balance and Flood Simulation Model, Revised User Manual. EUR 22166
EN/2, Office for Official Publications of the European Communities,
Luxembourg, 109 pp.</p>

<p>van der Knijff, J. M., Younis, J. and de Roo, A. P. J.: LISFLOOD: A
GIS-based distributed model for river basin scale water balance and
flood simulation, Int. J. Geogr. Inf. Sci., 24(2), 189–212, 2010.</p>

<p>Van Genuchten, M.Th., 1980. A closed-form equation for predicting
the hydraulic conductivity of unsaturated soils. Soil Science Society
of America Journal 44, 892-898.</p>

<p>Viviroli et&nbsp;al., 2009Viviroli, D., Zappa, M., Gurtz, J., &amp;
Weingartner, R., 2009. An introduction to the hydrological modelling
system PREVAH and its pre- and post-processing-tools. <em>Environmental
Modelling &amp; Software</em>, 24(10), 1209–1222.</p>

<p>Vogt et&nbsp;al., 2007Vogt, J., Soille, P., de&nbsp;Jager, A.,
Rimaviciute, E., Mehl, W., Foisneau, S., Bodis, K., Dusart, M.,
Parachini, M., Hasstrup, P.,2007. <em>A pan-European River and
Catchment Database</em>.
JRC Reference Report EUR 22920 EN, Institute for Environment and
Sustainability, Joint Research Centre of the European Commission.</p>

<p>Von Hoyningen-Huene, J., 1981. Die Interzeption des Niederschlags in
landwirtschaftlichen Pflanzenbeständen (Rainfall interception in
agricultural plant stands). In: Arbeitsbericht Deutscher Verband für
Wasserwirtschaft und Kulturbau, DVWK, Braunschweig, p.63.</p>

<p>Wesseling, C.G., Karssenberg, D., Burrough, P.A. , Van Deursen,
W.P.A., 1996. Integrating dynamic environmental models in GIS: The
development of a Dynamic Modelling language. Transactions in GIS 1,
40-48.</p>

<p>World Meteorological Organization, 1986. Intercomparison of models
of snowmelt runoff. Operational Hydrology Report No. 23.</p>

<p>Young, G.J. (ed), 1985. Techniques for prediction of runoff from
glacierized areas. IAHS Publication 149, Institute of Hydrology,
Wallingford.</p>

<p>Zhao, R.J., Liu, X.R., 1995. The Xinanjiang model. In: Singh, V.P.
(ed.), Computer Models of Watershed Hydrology, pp. 215-232.</p>


<h1 id="annex-1-simulation-of-reservoirs">Annex 1: Simulation of
reservoirs</h1>

<h2 id="introduction-2">Introduction</h2>

<p>This annex describes the LISFLOOD reservoirs routine, and how it is
used. The simulation of reservoirs is <em>optional</em>, and it can be
activated by adding the following line to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="simulateReservoirs" choice="1" /&gt;</p>

<p>Reservoirs can be simulated on channel pixels where kinematic wave
routing is used. The routine does <em>not</em> work for channel
stretches where the dynamic wave is used!</p>

<h2 id="description-of-the-reservoir-routine">Description of the
reservoir routine </h2>

<p>Reservoirs are simulated as points in the channel network. The
inflow into each reservoir equals the channel flow upstream of the
reservoir. The outflow behaviour is described by a number of
parameters. First, each reservoir has a total storage capacity <em>S</em>
[m<sup>3</sup>]. The relative filling of a reservoir, <em>F</em>,
is a fraction between 0 and 1. There are three ‘special’ filling
levels. First, each reservoir has a ‘dead storage’ fraction, since
reservoirs never empty completely. The corresponding filling fraction
is the ‘conservative storage limit’, <em>L<sub>c</sub></em>. For
safety reasons a reservoir is never filled to the full storage
capacity. The ‘flood storage limit’ (<em>L<sub>f</sub></em>)
represents this maximum allowed storage fraction. The buffering
capacity of a reservoir is the storage available between the ‘flood
storage limit’ and the ‘normal storage limit’ (<em>L<sub>n</sub></em>).
Three additional parameters define the way the outflow of a reservoir
is regulated. For e.g. ecological reasons each reservoir has a ‘minimum
outflow’ (<em>O<sub>min</sub></em>, [m<sup>3</sup> s<sup>-1</sup>]).
For high discharge situations, the ‘non-damaging outflow’ (<em>O<sub>nd</sub></em>,
[m<sup>3</sup> s<sup>-1</sup>]) is the maximum possible outflow that
will not cause problems downstream. The ‘normal outflow’ (<em>O<sub>norm</sub></em>,
[m<sup>3</sup> s<sup>-1</sup>]) is valid once the reservoir reaches its
‘normal storage’ filling level.</p>

<p>Depending on the relative filling of the reservoir, outflow (<em>O<sub>res</sub></em>,
[m<sup>3</sup> s<sup>-1</sup>]) is calculated as:</p>

<p>with:</p>

<table>

  <thead>
  <tr class="header">
    <th>S</th>
    <th>: Reservoir storage capacity [m<sup>3</sup>]</th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>F</td>
      <td>: Reservoir fill (fraction, 1 at total storage capacity) [-]</td>
    </tr>
    <tr class="even">
      <td>L<sub>c</sub></td>
      <td>: Conservative storage limit [-]</td>
    </tr>
    <tr class="odd">
      <td>L<sub>n</sub></td>
      <td>: Normal storage limit [-]</td>
    </tr>
    <tr class="even">
      <td>L<sub>f</sub></td>
      <td>: Flood storage limit [-]</td>
    </tr>
    <tr class="odd">
      <td>O<sub>min</sub></td>
      <td>: Minimum outflow [m<sup>3</sup> s<sup>-1</sup>]</td>
    </tr>
    <tr class="even">
      <td>O<sub>norm</sub></td>
      <td>: Normal outflow [m<sup>3</sup> s<sup>-1</sup>]</td>
    </tr>
    <tr class="odd">
      <td>O<sub>nd</sub></td>
      <td>: Non-damaging outflow [m<sup>3</sup> s<sup>-1</sup>]</td>
    </tr>
    <tr class="even">
      <td>I<sub>res</sub></td>
      <td>: Reservoir inflow [m<sup>3</sup> s<sup>-1</sup>]</td>
    </tr>
  </tbody>
</table>

<p>In order to prevent numerical problems, the reservoir outflow is
calculated using a user-defined time interval (or <em>Δt</em>, if it
is smaller than this value).</p>

<h2 id="preparation-of-input-data">Preparation of input data </h2>

<p>For the simulation of reservoirs a number of addition input files
are necessary. First, the locations of the reservoirs are defined on a
(nominal) map called ‘<em>res.map</em>’. It is important that all
reservoirs are located on a channel pixel (you can verify this by
displaying the reservoirs map on top of the channel map). Also, since
each reservoir receives its inflow from its upstream neighbouring
channel pixel, you may want to check if each reservoir has any upstream
channel pixels at all (if not, the reservoir will gradually empty
during a model run!). The management of the reservoirs is described by
7 tables. The following table lists all required input:</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A1.1</strong> Input requirements reservoir
routine</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="odd">
      <td>ReservoirSites</td>
      <td>res.map</td>
      <td>reservoir locations</td>
      <td>-</td>
      <td>nominal</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Tables</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="even">
      <td>TabTotStorage</td>
      <td>rtstor.txt</td>
      <td>reservoir storage capacity</td>
      <td>m<sup>3</sup></td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>TabConservativeStorageLimit</td>
      <td>rclim.txt</td>
      <td>conservative storage limit</td>
      <td>-</td>
      <td>
      <p>fraction of</p>
      <p>storage</p>
      </td>
    </tr>
    <tr class="even">
      <td>TabNormalStorageLimit</td>
      <td>rnlim.txt</td>
      <td>normal storage limit</td>
      <td>-</td>
      <td>capacity</td>
    </tr>
    <tr class="odd">
      <td>TabFloodStorageLimit</td>
      <td>rflim.txt</td>
      <td>flood storage limit</td>
      <td>-</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td>TabMinOutflowQ</td>
      <td>rminq.txt</td>
      <td>minimum outflow</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>TabNormalOutflowQ</td>
      <td>rnormq.txt</td>
      <td>normal outflow</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td>TabNonDamagingOutflowQ</td>
      <td>rndq.txt</td>
      <td>non-damaging outflow</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<p>When you create the map with the reservoir sites, pay special
attention to the following: if a reservoir is on the most downstream
cell (i.e. the outflow point, see Figure A1.1), the reservoir routine
may produce erroneous output. In particular, the mass balance errors
cannot be calculated correctly in that case. The same applies if you
simulate only a sub-catchment of a larger map (by selecting the
subcatchment in the mask map). This situation can usually be avoided by
extending the mask map by one cell in downstream direction.</p>

<p><img src="e:%5Cgh-pages%5C/media/image111.png" alt="reservoirPlacementNew" style="width: 4.75in; height: 2.125in;"></p>

<p><em>Figure A1.1 Placement of the reservoirs: reservoirs on the
outflow point (left) result in erroneous behavior of the reservoir
routine.</em></p>

<h2 id="preparation-of-settings-file">Preparation of settings file</h2>

<p>All in- and output files need to be defined in the settings file. If
you are using a default LISFLOOD settings template, all file
definitions are already defined in the ‘lfbinding’ element. Just make
sure that the map with the reservoir locations is in the “maps”
directory, and all tables in the ‘tables” directory. If this is the
case, you only have to specify the time-step used for the reservoir
calculations and the initial reservoir filling level (expressed as a
fraction of the storage capacity). Both are defined in the ‘lfuser’
element of the settings file. For the reservoir time step (<em>DtSecReservoirs</em>)
it is recommended to start with a value of 14400 (4 hours), and try
smaller values if the simulated reservoir outflow shows large
oscillations. <em>ReservoirInitialFillValue</em> can be either a map
or a value (between 0 and 1). So we add this to the ‘lfuser’ element
(if it is not there already):</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;group&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>RESERVOIR OPTION</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="DtSecReservoirs" value="14400"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Sub time step used for reservoir simulation [s]. Within the
model,</p>
      <p>the smallest out of DtSecReservoirs and DtSec is used.</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="ReservoirInitialFillValue" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Initial reservoir fill fraction</p>
      <p>-9999 sets initial fill to normal storage limit</p>
      <p>if you're not using the reservoir option, enter some bogus
value</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;/group&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<p>The value -9999 tells the model to set the initial reservoir fill to
the normal storage limit. Note that this value is completely arbitrary.
However, if no other information is available this may be a reasonable
starting point.</p>

<p>Finally, you have to tell LISFLOOD that you want to simulate
reservoirs! To do this, add the following statement to the ‘lfoptions’
element:</p>

<p>&lt;setoption name="simulateReservoirs" choice="1" /&gt;</p>

<p>Now you are ready to run the model. If you want to compare the model
results both with and without the inclusion of reservoirs, you can
switch off the simulation of reservoirs either by:</p>

<ol type="1">

  <li>
    <p>Removing the ‘simulateReservoirs’ statement from the ‘lfoptions
element, or</p>
  </li>
  <li>
    <p>changing it into &lt;setoption name="simulateReservoirs"
choice="0" /&gt;</p>
  </li>
</ol>

<p>Both have exactly the same effect. You don’t need to change anything
in either ‘lfuser’ or ‘lfbinding’; all file definitions here are simply
ignored during the execution of the model.</p>

<h2 id="reservoir-output-files">Reservoir output files</h2>

<p>The reservoir routine produces 3 additional time series and one map,
as listed in the following table:</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A1.2</strong> Output of reservoir routine</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="odd">
      <td>ReservoirFillState</td>
      <td>rsfilxxx.xxx</td>
      <td>reservoir fill at last time step<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></td>
      <td>-</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Time series</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="even">
      <td>ReservoirInflowTS</td>
      <td>qresin.tss</td>
      <td>inflow into reservoirs</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>ReservoirOutflowTS</td>
      <td>qresout.tss</td>
      <td>outflow out of reservoirs</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td>ReservoirFillTS</td>
      <td>resfill.tss</td>
      <td>reservoir fill</td>
      <td>-</td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<p>Note that you can use the map with the reservoir fill at the last
time step to define the initial conditions of a succeeding simulation,
e.g.:</p>

<p>&lt;textvar name="ReservoirInitialFillValue"
value="/mycatchment/rsfil000.730"&gt;</p>

<h1 id="annex-2-polder-option">Annex 2: Polder option </h1>

<h2 id="introduction-3">Introduction</h2>

<p>This annex describes the LISFLOOD polder routine, and how it is
used. The simulation of polders is <em>optional</em>, and it can be
activated by adding the following line to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="simulatePolders" choice="1" /&gt;</p>

<p>Polders can be simulated on channel pixels where dynamic wave
routing is used. The routine does <em>not</em> work for channel
stretches where the kinematic wave is used!</p>

<h2 id="description-of-the-polder-routine">Description of the polder
routine </h2>

<p>Polders are simulated as points in the channel network. The polder
routine is adapted from Förster et. al (2004), and based on the weir
equation of Poleni (Bollrich &amp; Preißler, 1992). The flow rates from
the channel to the polder area and vice versa are calculated by
balancing out the water levels in the channel and in the polder, as
shown in Figure A2.1.</p>

<p><img src="e:%5Cgh-pages%5C/media/image112.png" alt="polders" style="width: 5.77083in; height: 1.91667in;"></p>

<p><em>Figure A2.1 Schematic overview of the simulation of polders.</em>
pb <em>is the polder bottom level (above the channel bottom);</em> w<sub>c</sub>
<em>is the water level in the channel;</em> h<sub>c</sub> <em>and</em>
h<sub>p</sub> <em>are the water levels above the polder in- / outflow,
respectively</em></p>

<p>From the Figure, it is easy to see that there can be three
situations:</p>

<ol type="1">

  <li>
    <p><strong><em>h<sub>c</sub></em> &gt; <em>h<sub>p</sub></em></strong>:
water flows out of the channel, into the polder. The flow rate, <em>q<sub>c,p</sub></em>,
is calculated using:</p>
  </li>
</ol>

<blockquote>
  <p>(A2.1)</p>
  <p>where <em>b</em> is the outflow width [m], <em>g</em> is the
acceleration due to gravity (9.81 m s<sup>-2</sup>) and <em>μ</em> is
a weir constant which has a value of 0.49. Furthermore <em>q<sub>c,p</sub></em>
is in [m<sup>3</sup> s<sup>-1</sup>].</p>
</blockquote>

<ol start="2" type="1">

  <li>
    <p><strong><em>h<sub>c</sub></em> &lt; <em>h<sub>p</sub></em></strong>:
water flows out of the polder back into the channel. The flow rate, <em>q<sub>p,c</sub></em>,
is now calculated using:</p>
  </li>
</ol>

<blockquote>
  <p>(A2.2)</p>
</blockquote>

<ol start="3" type="1">

  <li>
    <p><strong><em>h<sub>c</sub></em> = <em>h<sub>p</sub></em></strong>:
no water flowing into either direction (note here that the minimum
value of <em>h<sub>c</sub></em> is zero). In this case both <em>q<sub>c,p</sub></em>
and <em>q<sub>p,c</sub></em> are zero.</p>
  </li>
</ol>

<h2 id="regulated-and-unregulated-polders">Regulated and unregulated
polders</h2>

<p>The above equations are valid for <em>unregulated</em> polders. It
is also possible to simulated <em>regulated</em>
polders, which is illustrated in Figure A2.2. Regulated polders are
opened at a user-defined time (typically during the rising limb of a
flood peak). The polder closes automatically once it is full.
Subsequently, the polder is opened again to release the stored water
back into the channel, which also occurs at a user-defined time. The
opening- and release times for each polder are defined in two lookup
tables (see Table 2.1). In order to simulate the polders in <em>unregulated</em>
mode these times should both be set to a bogus value of -9999. <em>Only</em>
if <em>both</em>
opening- and release time are set to some other value, LISFLOOD will
simulate a polder in regulated mode. Since LISFLOOD only supports <em>one</em>
single regulated open-close-release cycle per simulation, you should
use regulated mode <em>only</em>
for single flood events. For continuous simulations (e.g. long-tem
waterbalance runs) you should only run the polders in unregulated mode.</p>

<p><img src="e:%5Cgh-pages%5C/media/image115.png" alt="poldersRegulated" style="width: 5.39583in; height: 3.39583in;"></p>

<p><em>Figure A2.2 Simulation of a regulated polder. Polder is closed
(inactive) until user-defined opening time, after which it fills up to
its capacity (flow rate according to Eq A2.1). Water stays in polder
until user-defined release time, after which water is released back to
the channel (flow rate according to Eq A2.2). </em></p>

<h2 id="preparation-of-input-data-1">Preparation of input data </h2>

<p>The locations of the reservoirs are defined on a (nominal) map
called ‘<em>polders.map</em>’. Any polders that are <em>not</em>
on a channel pixel are ignored by LISFLOOD, so you may want to check
the polder locations before running the model (you can do this by
displaying the reservoirs map on top of the channel map). The current
implementation of the polder routine may result in numerical
instabilities for kinematic wave pixels, so for the moment it is
recommended to define polders <em>only</em> on channels where the
dynamic wave is used. Furthermore, the properties of each polder are
described using a number of tables. All required input is listed in the
following table:</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A2.1</strong> Input requirements polder
routine</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="odd">
      <td>PolderSites</td>
      <td>polders.map</td>
      <td>polder locations</td>
      <td>-</td>
      <td>nominal</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Tables</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="even">
      <td>TabPolderArea</td>
      <td>poldarea.txt</td>
      <td>polder area</td>
      <td>m<sup>2</sup></td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>TabPolderOFWidth</td>
      <td>poldofw.txt</td>
      <td>polder in- and outflow width</td>
      <td>m</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td>TabPolderTotalCapacity</td>
      <td>poldcap.txt</td>
      <td>polder storage capacity</td>
      <td>m<sup>3</sup></td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>TabPolderBottomLevel</td>
      <td>poldblevel.txt</td>
      <td>Bottom level of polder, measured from channel bottom level
(see also Figure A4.1)</td>
      <td>m</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td>TabPolderOpeningTime</td>
      <td>poldtopen.txt</td>
      <td>Time at which polder is opened</td>
      <td>
      <p>time</p>
      <p>step</p>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>TabPolderReleaseTime</td>
      <td>poldtrelease.txt</td>
      <td>Time at which water stored in polder is released again</td>
      <td>
      <p>time</p>
      <p>step</p>
      </td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<p>Note that the polder opening- and release times are both defined a <em>time
step</em> numbers (<em>not</em> days or hours!!). For <em>unregulated</em>
polders, set both parameters to a bogus value of -9999, i.e.:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>10 -9999</p>
      <p>15 -9999</p>
      <p>16 -9999</p>
      <p>17 -9999</p>
      </td>
    </tr>
  </tbody>
</table>

<h2 id="preparation-of-settings-file-1">Preparation of settings file</h2>

<p>All in- and output files need to be defined in the settings file. If
you are using a default LISFLOOD settings template, all file
definitions are already defined in the ‘lfbinding’ element. Just make
sure that the map with the polder locations is in the “maps” directory,
and all tables in the ‘tables” directory. If this is the case, you only
have to specify the initial reservoir water level in the polders. <em>PolderInitialLevelValue</em>
is defined in the ‘lfuser’ element of the settings file, and it can be
either a map or a value. The value of the weir constant <em>μ</em>
is also defined here, although you should not change its default value.
So we add this to the ‘lfuser’ element (if it is not there already):</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;group&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>POLDER OPTION</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="mu" value="0.49"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Weir constant [-] (Do not change!)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PolderInitialLevelValue" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Initial water level in polder [m]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;/group&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<p>To switch on the polder routine, add the following line to the
‘lfoptions’ element:</p>

<p>&lt;setoption name="simulatePolders" choice="1" /&gt;</p>

<p>Now you are ready to run the model. If you want to compare the model
results both with and without the inclusion of polders, you can switch
off the simulation of polders either by:</p>

<ol start="3" type="1">

  <li>
    <p>Removing the ‘simulatePolders’ statement from the ‘lfoptions
element, or</p>
  </li>
  <li>
    <p>changing it into &lt;setoption name="simulatePolders" choice="0"
/&gt;</p>
  </li>
</ol>

<p>Both have exactly the same effect. You don’t need to change anything
in either ‘lfuser’ or ‘lfbinding’; all file definitions here are simply
ignored during the execution of the model.</p>

<h2 id="polder-output-files">Polder output files</h2>

<p>The polder routine produces 2 additional time series and one map (or
stack of maps, depending on the value of LISFLOOD variable <em>ReportSteps</em>),
as listed in the following table:</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A2.2</strong> Output of polder routine</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="odd">
      <td>PolderLevelState</td>
      <td>hpolxxxx.xxx</td>
      <td>water level in polder at last time step<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></td>
      <td>m</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Time series</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="even">
      <td>PolderLevelTS</td>
      <td>hPolder.tss</td>
      <td>water level in polder (at polder locations)</td>
      <td>m</td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>PolderFluxTS</td>
      <td>qPolder.tss</td>
      <td>Flux into and out of polder (positive for flow from channel
to polder, negative for flow from polder to channel)</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<p>Note that you can use the map with the polder level at the last time
step to define the initial conditions of a succeeding simulation, e.g.:</p>

<p>&lt;textvar name="PolderInitialLevelValue"
value="/mycatchment/hpol0000.730"&gt;</p>

<h2 id="limitations">Limitations</h2>

<p>For the moment, polders can be simulated on channel pixels where
dynamic wave routing is used. For channels where the kinematic wave is
used, the routine will not work and may lead to numerical instabilities
or even model crashes. This limitation may be resolved in future model
versions.</p>


<h1 id="annex-3-simulation-of-lakes">Annex 3: Simulation of lakes</h1>

<h2 id="introduction-4">Introduction</h2>

<p>This annex describes the LISFLOOD lake routine, and how it is used.
The simulation of lakes is <em>optional</em>, and it can be activated
by adding the following line to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="simulateLakes" choice="1" /&gt;</p>

<p>Lakes can be simulated on channel pixels where kinematic wave
routing is used. The routine does <em>not</em> work for channel
stretches where the dynamic wave is used!</p>

<h2 id="description-of-the-lake-routine">Description of the lake
routine </h2>

<p>Lakes are simulated as points in the channel network. Figure A3.1
shows all computed in- and outgoing fluxes. Lake inflow equals the
channel flow upstream of the lake location. The flow out of the lake is
computed using the following rating curve (e.g. Maidment, 1992):</p>

<table>

  <thead>
  <tr class="header">
    <th>O<sub>lake</sub></th>
    <th>: Lake outflow rate [m<sup>3</sup> s<sup>-1</sup>]</th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>H</td>
      <td>: Water level in lake [m]</td>
    </tr>
    <tr class="even">
      <td>H<sub>0</sub></td>
      <td>: Water level at which lake outflow is zero [m]</td>
    </tr>
    <tr class="odd">
      <td>A, B</td>
      <td>: Constants [-]</td>
    </tr>
  </tbody>
</table>

<p><img src="e:%5Cgh-pages%5C/media/image117.png" alt="lakes" style="width: 5.375in; height: 3.51042in;"></p>

<p><em>Figure A3.1 Schematic overview of the simulation of lakes.</em> H<sub>0</sub>
<em>is the water level at which the outflow is zero;</em> H <em>is the
water level in the lake and</em> EW <em>is the evaporation from the
lake</em></p>

<p>Both <em>H</em> and <em>H<sub>0</sub></em> can be defined relative
to an arbitrary reference level. Since the outflow is a function of the
<em>difference</em> between both levels, the actual value of this
reference level doesn’t matter if <em>H</em> &gt; <em>H<sub>0</sub></em>.
However, it is advised to define both <em>H</em> and <em>H<sub>0</sub></em>
relative to the <em>average bottom level</em> of the lake. This will
result in more realistic simulations during severe drought spells, when
the water level drops below <em>H<sub>0</sub></em> (in which case lake
outflow ceases). The value of constant <em>A</em> can be approximated
by the width of the lake outlet in meters, and <em>B</em> is within
the range 1.5-2 (reference?). Lake evaporation occurs at the potential
evaporation rate of an open water surface.</p>

<h2 id="initialisation-of-the-lake-routine">Initialisation of the lake
routine</h2>

<p>Because lakes (especially large ones) tend to produce a relatively
slow response over time, it is important to make sure that the initial
lake level is set to a more or less sensible value. Just as is the case
with the initialisation of the lower groundwater zone, LISFLOOD has a
special option that will compute a steady-state lake level and use this
as the initial value. The steady-state level is computed from the water
balance of the lake. If <em>V<sub>l</sub></em> is the total lake
volume [m<sup>3</sup>], the rate of change of <em>V<sub>l</sub></em>
at any moment is given by the continuity equation:</p>

<p>where <em>I</em> and <em>O</em> are the in- and outflow rates,
respectively. For a steady-state situation the storage remains
constant, so:</p>

<p>Substituting all in- and outflow terms gives:</p>

<p>where <em>I<sub>l</sub></em> is the inflow into the lake and <em>EW<sub>l</sub></em>
the lake evaporation (both expressed in m<sup>3</sup> s<sup>-1</sup>).
Re-arranging gives the steady-state lake level:</p>

<p>LISFLOOD calculates the steady-state lake level based on a
user-defined average net inflow (=<em>I<sub>l</sub></em> – <em>EW<sub>l</sub></em>).
The average net inflow can be estimated using measured discharge and
evaporation records. If measured discharge is available just <em>downstream</em>
of the lake (i.e. the <em>outflow</em>),
the (long-term) average outflow can be used as the net inflow estimate
(since, for a steady state situation, inflow equals outflow). If only
inflow is available, all average inflows should be summed, and the
average lake evaporation should be subtracted from this figure. Table
A3.1 gives a worked example. Be aware that the calculation can be less
straightforward for very large lakes with multiple inlets (which are
not well represented by the current point approach anyway).</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p><strong>Table A3.1: Calculation of average net lake inflow </strong></p>
      <p><em>Lake characteristics</em></p>
      <p>lake area: 215•10<sup>6</sup> m<sup>2</sup></p>
      <p>mean annual discharge downstream of lake: 293 m<sup>3</sup> s<sup>-1</sup></p>
      <p>mean annual discharge upstream of lake: 300 m<sup>3</sup> s<sup>-1</sup></p>
      <p>mean annual evaporation: 1100 mm yr<sup>-1</sup></p>
      <p><em>Calculation of average net inflow</em></p>
      <p><strong>METHOD 1: USING AVERAGE OUTFLOW</strong></p>
      <p>assuming lake is in quasi steady-state:</p>
      <blockquote>
        <p>average net inflow = average net outflow = <span class="underline">293 m<sup>3</sup> s<sup>-1</sup></span></p>
      </blockquote>
      <p><strong>METHOD 2: USING AVERAGE INFLOW AND EVAPORATION</strong></p>
      <p>Only use this method if no outflow data are available</p>
      <ol type="1">
        <li>
          <p><strong>Express lake evaporation in m<sup>3</sup> s<sup>-1</sup>:</strong></p>
        </li>
      </ol>
      <blockquote>
        <p>1100 mm yr<sup>-1</sup> / 1000 = 1.1 m yr<sup>-1</sup></p>
        <p>1.1 m yr<sup>-1</sup> x 215•10<sup>6</sup> m<sup>2</sup> =
2.37•10<sup>8</sup> m<sup>3</sup> yr<sup>-1</sup></p>
        <p>2.37•10<sup>8</sup> m<sup>3</sup> yr<sup>-1</sup> / (365
days x 86400 seconds) = <span class="underline">7.5 m<sup>3</sup> s<sup>-1</sup></span></p>
      </blockquote>
      <ol start="2" type="1">
        <li>
          <p><strong>Compute net inflow:</strong></p>
        </li>
      </ol>
      <blockquote>
        <p>net inflow = 300 m<sup>3</sup> s<sup>-1</sup> – 7.5 m<sup>3</sup>
s<sup>-1</sup> = <span class="underline">292.5 m<sup>3</sup> s<sup>-1</sup></span></p>
      </blockquote>
      </td>
    </tr>
  </tbody>
</table>

<h2 id="preparation-of-input-data-2">Preparation of input data </h2>

<p>The lake locations defined on a (nominal) map called ‘<em>lakes.map</em>’.
It is important that all reservoirs are located on a channel pixel (you
can verify this by displaying the reservoirs map on top of the channel
map). Also, since each lake receives its inflow from its upstream
neighbouring channel pixel, you may want to check if each lake has any
upstream channel pixels at all (if not, the lake will just gradually
empty during a model run!). The lake characteristics are described by 4
tables. Table 3.2 lists all required input.</p>

<p>When you create the map with the lake locations, pay special
attention to the following: if a lake is located on the most downstream
cell (i.e. the outflow point, see Figure A3.2), the lake routine may
produce erroneous output. In particular, the mass balance errors cannot
be calculated correctly in that case. The same applies if you simulate
only a sub-catchment of a larger map (by selecting the subcatchment in
the mask map). This situation can usually be avoided by extending the
mask map by one cell in downstream direction.</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A3.2</strong> Input requirements lake
routine</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="odd">
      <td>LakeSites</td>
      <td>lakes.map</td>
      <td>lake locations</td>
      <td>-</td>
      <td>nominal</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Tables</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="even">
      <td>TabLakeArea</td>
      <td>lakearea.txt</td>
      <td>lake surface area</td>
      <td>m<sup>2</sup></td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>TabLakeH0</td>
      <td>lakeh0.txt</td>
      <td>water level at which lake outflow is zero</td>
      <td>m</td>
      <td>relative to average lake bottom level</td>
    </tr>
    <tr class="even">
      <td>TabLakeA</td>
      <td>lakea.txt</td>
      <td>lake parameter A</td>
      <td>-</td>
      <td>≈ outlet width in meters</td>
    </tr>
    <tr class="odd">
      <td>TabLakeB</td>
      <td>lakeb.txt</td>
      <td>lake parameter B</td>
      <td>-</td>
      <td>1.5-2</td>
    </tr>
  </tbody>
</table>

<p><img src="e:%5Cgh-pages%5C/media/image111.png" alt="reservoirPlacementNew" style="width: 4.75in; height: 2.125in;"></p>

<p><em>Figure A3.2 Placement of the lakes: lakes on the outflow point
(left) result in erroneous behavior of the lake routine.</em></p>

<h2 id="preparation-of-settings-file-2">Preparation of settings file</h2>

<p>All in- and output files need to be defined in the settings file. If
you are using a default LISFLOOD settings template, all file
definitions are already defined in the ‘lfbinding’ element. Just make
sure that the map with the lake locations is in the “maps” directory,
and all tables in the ‘tables” directory. If this is the case, you only
have to specify the initial lake level and –if you are using the
steady-state option- the mean net lake inflow (make this a map if
you’re simulating multiple lakes simultaneously). Both can be set in
the ‘lfuser’ element. <em>LakeInitialLevelValue</em> can be either a
map or a single value. Setting <em>LakeInitialLevelValue</em> to <em>-9999</em>
will cause LISFLOOD to calculate the steady-state level. So we add this
to the ‘lfuser’ element (if it is not there already):</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;group&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>LAKE OPTION</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="LakeInitialLevelValue" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Initial lake level [m]</p>
      <p>-9999 sets initial value to steady-state level</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="LakeAvNetInflowEstimate" value="292.5"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Estimate of average net inflow into lake (=inflow –
evaporation) [cu m / s]</p>
      <p>Used to calculated steady-state lake level in case
LakeInitialLevelValue</p>
      <p>is set to -9999</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;/group&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<p>Finally, you have to tell LISFLOOD that you want to simulate lakes!
To do this, add the following statement to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="simulateLakes" choice="1" /&gt;</p>

<p>Now you are ready to run the model. If you want to compare the model
results both with and without the inclusion of lakes, you can switch
off the simulation of lakes either by:</p>

<ol start="5" type="1">

  <li>
    <p>Removing the ‘simulateLakes’ statement from the ‘lfoptions
element, or</p>
  </li>
  <li>
    <p>changing it into &lt;setoption name="simulateLakes" choice="0"
/&gt;</p>
  </li>
</ol>

<p>Both have exactly the same effect. You don’t need to change anything
in either ‘lfuser’ or ‘lfbinding’; all file definitions here are simply
ignored during the execution of the model.</p>

<h2 id="lake-output-files">Lake output files</h2>

<p>The lake routine produces 4 additional time series and one map (or
stack), as listed in the following table:</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A3.3</strong> Output of lake routine</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="odd">
      <td>LakeLevelState</td>
      <td>lakhxxxx.xxx</td>
      <td>lake level at last time step<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></td>
      <td>m</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Time series</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="even">
      <td>LakeInflowTS</td>
      <td>qLakeIn.tss</td>
      <td>inflow into lakes</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>LakeOutflowTS</td>
      <td>qLakeOut.tss</td>
      <td>flow out of lakes</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td>LakeEWTS</td>
      <td>EWLake.tss</td>
      <td>lake evaporation</td>
      <td>mm</td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>LakeLevelTS</td>
      <td>hLake.tss</td>
      <td>lake level</td>
      <td>m</td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<p>Note that you can use the map with the lake level at the last time
step to define the initial conditions of a succeeding simulation, e.g.:</p>

<p>&lt;textvar name="LakeInitialLevelValue"
value="/mycatchment/lakh0000.730"&gt;</p>


<p><span id="_Toc353538887" class="anchor"></span><strong>Annex 4:
Inflow hydrograph option</strong></p>

<h2 id="introduction-5">Introduction</h2>

<p>This annex describes the LISFLOOD inflow hydrograph routine, and how
it is used. Inflow hydrographs are <em>optional</em>, and can be
activated by adding the following line to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="inflow" choice="1" /&gt;</p>

<h2 id="description-of-the-inflow-hydrograph-routine">Description of
the inflow hydrograph routine</h2>

<p>When using the inflow hydrograph option, time series of discharge [m<sup>3</sup>/s]
are added at some user-defined location(s) on the channel network. The
inflow is added as side-flow in the channel routing equations (this
works for both kinematic and dynamic wave). <em>Negative</em> inflows
(i.e. outflows) are also possible, but large outflow rates may
sometimes result in numerical problems in the routing equations. If you
use a negative inflow rate, we advise to carefully inspect the model
output for any signs of numerical problems (i.e. strange oscillations
in simulated discharge, generation of missing values). Also check the
mass balance time series after your simulation (numerical problems
often result in unusually large mass balance errors).</p>

<h2 id="using-inflow-hydrographs">Using inflow hydrographs </h2>

<p>The table below lists the input requirements for the inflow
hydrograph option. All you need is a map that defines where you want to
add the inflow, and a time series with the corresponding inflow rates.</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A4.1</strong> Input requirements inflow
hydrograph routine</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="odd">
      <td>InflowPoints</td>
      <td>-</td>
      <td>locations for inflow hydrographs</td>
      <td>-</td>
      <td>nominal</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Time series</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="even">
      <td>QInTS</td>
      <td>-</td>
      <td>inflow hydrograph(s)</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<p>Using the inflow hydrograph option involves four steps:</p>

<ol type="1">

  <li>
    <p>Create a (nominal) PCRaster map with unique identifiers that
point to the location(s) where you want to insert the inflow
hydrograph(s)</p>
  </li>
  <li>
    <p>Save the inflow hydrograph(s) in PCRaster time series format;
inflow hydrographs need to be given in [m<sup>3</sup> s<sup>-1</sup>]</p>
  </li>
</ol>

<table>

  <tbody>
    <tr class="odd">
      <td><strong>IMPORTANT</strong>: PCRaster assumes that the first
data
series in the time series file (i.e. the second column, since the first
column contains the time step number) corresponds to unique identifier
1 on the <em>InflowPoints</em> map; the second series to unique
identifier 2, and so on. So, even if your <em>InflowPoints</em> map
only contains (as an example) identifiers 3 and 4, you <em>still need
to include the columns for identifiers 1 and 2</em>!!
The best thing to do in such a case is to fill any unused columns with
zeroes (0). Also, your inflow hydrograph time series should always
start at <em>t=1</em>, even if you set <em>StepStart</em> to some
higher value. For more info on time series files please have a look at
the PCRaster documentation.</td>
    </tr>
  </tbody>
</table>

<ol start="3" type="1">

  <li>
    <p>Make sure that the names of the map and time series are defined
in the settings file</p>
  </li>
</ol>

<p>In the ‘lfuser’ element (replace the file paths/names by the ones
you want to use):</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;group&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>INFLOW HYDROGRAPH (OPTIONAL)</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="InflowPoints"</p>
      <p>value="/floods2/yourhomedir/yourcatchment/maps/inlets.map"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>OPTIONAL: nominal map with locations of (measured)</p>
      <p>inflow hydrographs [cu m / s]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="QInTS"</p>
      <p>value="/floods2/yourhomedir/yourcatchment/inflow/inflow.tss"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>OPTIONAL: observed or simulated input hydrographs as</p>
      <p>time series [cu m / s]</p>
      <p>Note that identifiers in time series correspond to</p>
      <p>InflowPoints map (also optional)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;/group&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<ol start="4" type="1">

  <li>
    <p>Activate the inflow hydrograph option</p>
  </li>
</ol>

<p>Add the following line to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="inflow" choice="1" /&gt;</p>

<p>Now you are ready to run the model with the inflow hydrograph.</p>

<h2 id="substituting-subcatchments-with-measured-inflow-hydrographs">Substituting
subcatchments with measured inflow hydrographs</h2>

<p>One of the most common uses of the inflow hydrograph option is this:
suppose we have a catchment where we only want to simulate the
downstream part. If measured time series of discharge are available for
the upstream catchment(s), we can use these to represent the inflow
into the more downstream part. Figure A4.1 shows an example, where we
have measured discharge of subcatchment <em>A</em> (just before it
enters the main river). In this case it is important to pay special
attention to two issues.</p>

<h3 id="exclude-subcatchments-from-maskmap">Exclude subcatchments from
MaskMap </h3>

<p>First, make sure that subcatchment <em>A</em> is <em>excluded</em>
(i.e. have boolean(0) or missing value) on LISFLOOD’s <em>MaskMap</em>
(which defines which pixels are included in the calculations and which
are not). If you include it, LISFLOOD will first <em>simulate</em>
discharge coming out of subcatchment <em>A</em>, and then <em>add</em>
the (measured) inflow on top of it! Of course this doesn’t make any
sense, so always be careful which areas are included in your simulation
and which are not.</p>


<embed src="e:%5Cgh-pages%5C/media/image122.emf" style="width: 6in; height: 4.33333in;">
<p><em>Figure A4.1 Using the inflow hydrograph using measured discharge
of subcatchment A. MaskMap must have boolean(0) (or missing value) for
subcatchment A, see text for explanation.</em></p>

<h3 id="make-sure-your-inflow-points-are-where-you-need-them">Make sure
your inflow points are where you need them</h3>

<p>If you already have all gauge locations on a PCRaster map, these
mostly cannot be used directly as inflow hydrograph locations. The
reason is simple: suppose –in our previous example– we know the outflow
point of subcatchment <em>A</em>. This point is the most downstream
point within that subcatchment. However, the flow out of subcatchment <em>A</em>
is actually added to the main river one cell downstream! Also, if we
exclude subcatchment <em>A</em>
from our simulation (as explained in the foregoing), this means we also
exclude the outflow point of that subcatchment. Because of this, <em>inflow</em>
points into the main river are usually located one pixel downstream of
the <em>outflow</em>
points of the corresponding subcatchment. If you already have a
(nominal) map of of your subcatchments, a PCRaster script exists that
automatically calculates the corresponding out- and inflow points.</p>

<p><span id="_Toc353538894" class="anchor"></span><strong>Annex 5:
Double kinematic wave option</strong></p>

<h2 id="introduction-6">Introduction</h2>

<p>This annex describes the LISFLOOD double kinematic wave routine, and
how it is used. Double kinematic wave routing is <em>optional</em>,
and can be activated by adding the following line to the ‘lfoptions’
element:</p>

<p>&lt;setoption name="SplitRouting" choice="1" /&gt;</p>

<h2 id="background">Background</h2>

<p>The flow routing is done by the kinematic wave approach. Therefore
two equations have to be solved:</p>

<p>where</p>

<p>continuity equation momentum equation as expressed by Chow et al.
1988</p>

<p>Which decreasing inflow the peaks of the resulting outflow will be
later in time (see figure A5.1 for a simple kinematic wave
calculation). The wave propagation slows down because of more friction
on the boundaries.</p>


<embed src="e:%5Cgh-pages%5C/media/image126.emf" style="width: 5.86458in; height: 2.75in;">
<p><strong>Figure A5.1</strong> Simulated outflow for different amount
of inflow<br>
wave propagation gets slower</p>

<p>This is realistic if your channel looks like in figure A5.2:</p>


<embed src="e:%5Cgh-pages%5C/media/image127.emf" style="width: 2.05in; height: 1.52708in;">
<embed src="e:%5Cgh-pages%5C/media/image128.emf" style="width: 1.94653in; height: 1.45in;">
<p><strong>Figure A5.2</strong> Schematic cross section of a channel
with different water level</p>

<p>But a natural channel looks more like this:</p>


<embed src="e:%5Cgh-pages%5C/media/image129.emf" style="width: 4.03333in; height: 1.61736in;">
<p><strong>Figure A5.3</strong> Schematic cross section of a natural
channel</p>

<p>Which means, opposite to the kinematic wave theory, the wave
propagation gets slower as the discharge is increasing, because
friction is going up on floodplains with shrubs, trees, bridges. Some
of the water is even stored in the floodplains (e.g. retention areas,
seepage retention). As a result of this, a single kinematic wave cannot
cover these different characteristics of floods and floodplains.</p>

<h2 id="double-kinematic-wave-approach">Double kinematic wave approach</h2>

<p>The double kinematic approach splits up the channel in two parts
(see figure A5.4):</p>

<p>1. bankful routing</p>

<p>2. over bankful routing</p>


<embed src="e:%5Cgh-pages%5C/media/image133.emf" style="width: 3.14236in; height: 1.38333in;">
<embed src="e:%5Cgh-pages%5C/media/image134.emf" style="width: 1.95in; height: 1.375in;">
<p>F<strong>igure A5.4</strong> Channel is split in a bankful and over
bankful routing</p>

<p>Similar methods are used since the 1970s e.g. as multiple linear or
non linear storage cascade (Chow, 1988). The former forecasting model
for the River Elbe (ELBA) used a three stages approach depending on
discharge (Fröhlich, 1996).</p>

<h2 id="using-double-kinematic-wave">Using double kinematic wave </h2>

<p>No additional maps or tables are needed for initializing the double
kinematic wave. A normal run (‘InitLisflood’=0) requires an additional
map derived from the prerun (‘InitLisflood’=1). A ‘warm’ start (using
initial values from a previous run) requires two additional maps with
state variables for the second (over ‘bankful’ routing).</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A5.1</strong> Input/output double kinematic
wave</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="odd">
      <td>Average discharge</td>
      <td>avgdis.map</td>
      <td>Average discharge</td>
      <td>m<sup>3</sup>/s</td>
      <td>Produced by prerun</td>
    </tr>
    <tr class="even">
      <td>CrossSection2Area<br>
InitValue</td>
      <td>ch2cr000.xxx</td>
      <td>channel crosssection for 2nd routing channel</td>
      <td>m<sup>2</sup></td>
      <td>
      <p>Produced by option</p>
      <p>‘repStateMaps’ or</p>
      <p>‘repEndMaps’</p>
      </td>
    </tr>
    <tr class="odd">
      <td>PrevSideflowInitValue</td>
      <td>chside00.xxx</td>
      <td>sideflow into the channel</td>
      <td>mm</td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<p>Using the double kinematic wave approach option involves three steps:</p>

<ol type="1">

  <li>
    <p>In the ‘lfuser’ element (replace the file paths/names by the
ones you want to use):</p>
  </li>
</ol>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="CalChanMan2" value="8.5"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Channel Manning's n for second line of routing</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="QSplitMult" value="2.0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Multiplier applied to average Q to split into a second line of
routing</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>CalChanMan2</em> is a multiplier that is applied to the
Manning’s roughness maps of the over bankful routing [-]</p>
  <p><em>QSplitMult</em> is a factor to the average discharge to
determine the bankful discharge. The average discharge map is produced
in the initial run (the initial run is already needed to get the
groundwater storage) . Standard is set to 2.0 (assuming over bankful
discharge starts at 2.0·average discharge).</p>
</blockquote>

<ol start="2" type="1">

  <li>
    <p>Activate the transmission loss option</p>
  </li>
</ol>

<p>Add the following line to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="SplitRouting" choice="1" /&gt;</p>

<ol start="3" type="1">

  <li>
    <p>Run LISFLOOD first with</p>
    <p>&lt;setoption name="InitLisflood" choice="1" /&gt;</p>
  </li>
</ol>

<p>and it will produce a map of average discharge [m<sup>3</sup>/s] in
the initial folder. This map is used together with the QSplitMult
factor to set the value for the second line of routing to start.</p>

<p>For a ‘warm start’ these initial values are needed (see also table
A5.1)</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;textvar name="CrossSection2AreaInitValue" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial channel crosssection for 2nd routing channel</p>
      <p>-9999: use 0</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrevSideflowInitValue" value="-9999"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>initial sideflow for 2nd routing channel</p>
      <p>-9999: use 0</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>CrossSection2AreaInitValue</em> is the initial cross-sectional
area [m<sup>2</sup>] of the water in the river channels (a substitute
for initial discharge, which is directly dependent on this). A value of
  <em>-9999</em> sets the initial amount of water in the channel to 0.</p>
  <p><em>PrevSideflowInitValue</em> is the initial inflow from each
pixel to the channel [mm]. A value of <em>-9999</em> sets the initial
amount of sideflow to the channel to 0.</p>
</blockquote>

<h2 id="automatic-change-of-the-number-of-sub-steps-optional">Automatic
change of the number of sub steps (optional)</h2>

<p>For the new method the kinematic wave has to be applied two times.</p>

<p>The calculation of kinematic wave is the most time consuming part in
a LISFLOOD run (in general but also depending on the catchment). The
use of the double kinematic wave makes it necessary to calculate the
kinematic wave two times and increasing the computing time. To
counteract this, an option is put in place to change automatically the
number of sub steps for channel routing.</p>

<p>Double kinematic wave routing is <em>optional</em>, and can be
activated by adding the following line to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="VarNoSubStepChannel" choice="1" /&gt;</p>

<p>This will calculate the number of sub steps for the kinematic wave
according to the discharge. Less number of steps for low and average
flow condition, more sub steps for flooding condition because the
higher velocity of water.</p>

<p>Activating this option needs to be done before the prerun
(‘InitLisflood’=1) because the maximum celerity of wave propagation
(chanckinmax.map) is created as another initial map and used in the
‘normal’ runs.</p>

<p>The minimum and maximum number of sub steps can be set in the
settings file:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>Variable Channel NoSubStepChannel</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="UpLimit" value="1.0E+9"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Upstream area do be included in max. celerity</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="MinNoStep" value="5"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>minimum number of sub steps for channel</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="ChanA" value="30"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>max. NoSubStepsChannel = ChanA-ChanB</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="ChanB" value="10"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>For calculating the min. No. of substeps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>UpLimit</em> is the minimum upstream area do be included in
the calculation of the maximum celerity of wave propagation [m<sup>2</sup>]</p>
  <p><em>MinNoStep</em> is the absolute minimum number of sub steps for
channel routing [-]</p>
  <p><em>ChanA</em> for calculating the maximum number of sub steps for
channel routing [-]</p>
  <p><em>ChanB</em> for calculating the minimum number of sub steps for
channel routing [-]</p>
</blockquote>

<p><span id="_Toc353538900" class="anchor"></span><strong>Annex 6:
Dynamic wave option</strong></p>

<h2 id="introduction-7">Introduction</h2>

<p>This annex describes the LISFLOOD dynamic wave routine, and how it
is used. The current implementation of the dynamic wave function in
PCRaster is not a complete dynamic wave formulation according to the
summary of the Saint Venant equations as discussed in Chow (1988). The
implementation currently consists of the friction force term, the
gravity force term and the pressure force term and should therefore be
correctly characterised as a diffusion wave formulation. The equations
are solved as an explicit, finite forward difference scheme. A
straightforward iteration using an Euler solution scheme is used to
solve these equations. Dynamic wave routing is <em>optional</em>, and
can be activated by adding the following line to the ‘lfoptions’
element:</p>

<p>&lt;setoption name="dynamicWave" choice="1" /&gt;</p>

<h2 id="time-step-selection">Time step selection</h2>

<p>The current dynamic wave implementation requires that all equations
are solved using a time step that is much smaller (order of magnitude:
seconds-minutes) than the typical overall time step used by LISFLOOD
(order of magnitude: hours-day). More specifically, during one (sub)
time step no water should be allowed to travel more than 1 cell
downstream, i.e.:</p>

<p>where <em>∆’t<sub>dyn</sub></em> is the sub-step for the dynamic
wave [seconds], <em>∆x</em> is the length of one channel element
(pixel) [m], <em>V</em> is the flow velocity [m s<sup>-1</sup>] and <em>c<sub>d</sub></em>
is dynamic wave celerity [m s<sup>-1</sup>]. The dynamic wave celerity
can be calculated as (Chow, 1988):</p>

<p>where <em>g</em> is the acceleration by gravity [m s<sup>-2</sup>]
and <em>y</em> is the depth of flow [m]. For a cross-section of a
regular geometric shape, <em>y</em>
can be calculated from the channel dimensions. Since the current
dynamic wave routine uses irregularly shaped cross-section data, we
simply assume than <em>y</em> equals the water level above the channel
bed. The flow velocity is simply:</p>

<p>where <em>Q<sub>ch</sub></em> is the discharge in the channel [m<sup>3</sup>
s<sup>-1</sup>], and <em>A</em> the cross-sectional area [m<sup>2</sup>].</p>

<p>The Courant number for the dynamic wave, <em>C<sub>dyn</sub></em>,
can now be computed as:</p>

<p>where <em>∆t</em> is the overall model time step [s]. The number of
sub-steps is then given by:</p>

<p>where <em>C<sub>dyn,crit</sub></em> is the critical Courant number.
The maximum value of the critical Courant number is 1; in practice it
is safer to use a somewhat smaller value (although if you make it too
small the model becomes excessively slow). It is recommended to stick
to the default value (0.4) that is used the settings file template.</p>

<h2 id="input-data">Input data </h2>

<p>A number of addition input files are necessary to use the dynamic
wave option. First, the channel stretches for which the dynamic wave is
to be used are defined on a Boolean map. Next, a cross-section
identifier map is needed that links the (dynamic wave) channel pixels
to the cross-section table (see further on). A channel bottom level map
describes the bottom level of the channel (relative to sea level).
Finally, a cross-section table describes the relationship between water
height (<em>H</em>), channel cross-sectional area (<em>A</em>) and
wetted perimeter (<em>P</em>) for a succession of <em>H</em> levels.</p>

<p>The following table lists all required input:</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A6.1</strong> Input requirements dynamic
wave routine</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="odd">
      <td>ChannelsDynamic</td>
      <td>chandyn.map</td>
      <td>dynamic wave channels (1,0)</td>
      <td>-</td>
      <td>Boolean</td>
    </tr>
    <tr class="even">
      <td>ChanCrossSections</td>
      <td>chanxsect.map</td>
      <td>channel cross section IDs</td>
      <td>-</td>
      <td>nominal</td>
    </tr>
    <tr class="odd">
      <td>ChanBottomLevel</td>
      <td>chblevel.map</td>
      <td>channel bottom level</td>
      <td>[m]</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Tables</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="even">
      <td>TabCrossSections</td>
      <td>chanxsect.txt</td>
      <td>cross section parameter table (H,A,P)</td>
      <td>
      <p>H:[m]</p>
      <p>A:[m<sup>2</sup>]</p>
      <p>P:[m]</p>
      </td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<h2 id="layout-of-the-cross-section-parameter-table">Layout of the
cross-section parameter table</h2>

<p>The cross-section parameter table is a text file that contains –for
each cross-section- a sequence of water levels (<em>H</em>) with their
corresponding cross-sectional area (<em>A</em>) and wetted perimeter (<em>P</em>).
The format of each line is as follows:</p>

<blockquote>
  <p>ID H A P</p>
</blockquote>

<p>As an example:</p>

<table>

  <thead>
  <tr class="header">
    <th>
    <p>ID H A P</p>
    <p>167 0 0 0</p>
    <p>167 1.507 103.044 114.183</p>
    <p>167 3.015 362.28 302.652</p>
    <p>167 4.522 902.288 448.206</p>
    <p>167 6.03 1709.097 600.382</p>
    <p>167 6.217 1821.849 609.433</p>
    <p>167 6.591 2049.726 615.835</p>
    <p>167 6.778 2164.351 618.012</p>
    <p>167 6.965 2279.355 620.14</p>
    <p>167 7.152 2395.037 626.183</p>
    <p>167 7.526 2629.098 631.759</p>
    <p>167 7.713 2746.569 634.07</p>
    <p>167 7.9 2864.589 636.93</p>
    <p>167 307.9 192201.4874 5225.1652</p>
    </th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<p>Note here that the first <em>H</em>-level is always 0, for which <em>A</em>
and <em>P</em>
are (of course) 0 as well. For the last line for each cross-section it
is recommended to use some very (i.e. unrealistically) high <em>H</em>-level.
The reason for doing this is that the dynamic wave routine will crash
if during a simulation a water level (or cross-sectional area) is
simulated which is beyond the range of the table. This can occur due to
a number of reasons (e.g. if the measured cross-section is incomplete,
or during calibration of the model). To estimate the corresponding
values of <em>A</em> and <em>P</em> one could for example calculate <em>dA/dH</em>
and <em>dP/dH</em> over the last two ‘real’ (i.e. measured) <em>H</em>-levels,
and extrapolate the results to a very high <em>H</em>-level.</p>

<p>The number of H/A/P combinations that are used for each cross
section is user-defined. LISFLOOD automatically interpolates in between
the table values.</p>

<h2 id="using-the-dynamic-wave">Using the dynamic wave</h2>

<p>The ‘lfuser’ element contains two parameters that can be set by the
user: <em>CourantDynamicCrit</em> (which should always be smaller than
1) and a parameter called <em>DynWaveConstantHeadBoundary</em>,
which defines the boundary condition at the most downstream cell. All
remaining dynamic-wave related input is defined in the ‘lfbinding’
element, and doesn’t require any changes from the user (provided that
all default names are used, all maps are in the standard ‘maps’
directory and the profile table is in the ‘tables’ directory). In
‘lfuser’ this will look like this:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>DYNAMIC WAVE OPTION</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="CourantDynamicCrit" value="0.5"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Critical Courant number for dynamic wave</p>
      <p>value between 0-1 (smaller values result in greater numerical
accuracy,</p>
      <p>but also increase computational time)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="DynWaveConstantHeadBoundary" value="0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Constant head [m] at most downstream pixel (relative to
altitude</p>
      <p>at most downstream pixel)</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<h1 id="annex-7-using-the-transmission-loss-option">Annex 7: Using the
transmission loss option</h1>

<h2 id="introduction-8">Introduction</h2>

<p>This annex describes the LISFLOOD transmission loss routine, and how
it is used.</p>

<p>The term ‘transmission loss’ originate from electronic or
communication science and stands for: “The loss of power or voltage of
a transmitted wave or current in passing along a transmission line or
path or through a circuit device”. In river systems, particularly in
semi-arid and arid region a similar effect can be observed: The loss of
water along channel reaches mainly especially during low and average
flow periods. Main reasons for this loss might be:</p>

<ul>

  <li>
    <p>Evaporation of water inside the channel reach</p>
  </li>
  <li>
    <p>Use of water for domestic, industrial or agricultural use</p>
  </li>
  <li>
    <p>Leaching to lower groundwater zones</p>
  </li>
</ul>

<p>A simplified approach to model this effect has been chosen from Rao
and Maurer (1996), without the need of additional data and with only
three parameters, making calibration relatively simple.</p>

<p>Transmission loss is <em>optional</em>, and can be activated by
adding the following line to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="TransLoss" choice="1" /&gt;</p>

<h2 id="description-of-the-transmission-loss-approach">Description of
the transmission loss approach</h2>

<p>The approach by Rao and Maurer 1996 builds a one-parameter
relationship between the seepage ofa channel with the depth of flow. A
power relationship is then utilized for the stage-discharge
relationship, which is coupled with the seepage relationship.</p>

<blockquote>
  <p>with: Outflow: discharge at the outflow</p>
  <p>Inflow: discharge at the Inflow (upstream)</p>
  <p>TransPower: Parameter given by the rating curve</p>
  <p>TransSub: Parameter which is to calibrate</p>
</blockquote>

<p>As a main difference to the Rao and Maurer 1996, the TransPower
parameter is not calculated by using a rating curve but is estimated
(calibrated) as the parameter TransSub. Transmission loss takes place
where the channel gets bigger with more influence of river-aquifer
interaction and also with more river-floodplain interaction. Therefore
a minimum upstream area is defined where transmission loss starts to
get important.</p>

<h2 id="using-transmission-loss">Using transmission loss </h2>

<p>No additional maps or tables are needed. Using the transmission loss
option involves two steps:</p>

<ol type="1">

  <li>
    <p>In the ‘lfuser’ element (replace the file paths/names by the
ones you want to use):</p>
  </li>
</ol>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;group&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>TRANSMISSION LOSS PARAMETERS</p>
      <p>**************************************************************</p>
      <p>Suggested parameterisation strategy:</p>
      <p>Use TransSub as calibration constant leave all other
parameters at<br>
default values</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="TransSub" value="0.3"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Transmission loss function parameter</p>
      <p>Standard: 0.3 Range: 0.1 - 0.6</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="TransPower1" value="2.0"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Transmission loss function parameter</p>
      <p>Standard: 2.0 Range 1.3 – 2.0</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="TransArea" value="5.0E+10"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>downstream area taking into account for transmission loss</p>
      <p>Standard: 5.0E+10 Range: 1.0E+10 – 1.0E+11</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;/group&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>TransSub</em> is the linear transmission loss parameter.
Standard is set to 0.3 and the range should be between 01. – 0.6
(higher values lead to more loss)</p>
  <p><em>TransPower</em> is the power transmission loss parameter.
Standard is set to 2.0 and the range should be between 1.3 and 2.0
(higher values lead to more loss)</p>
  <p><em>TransArea</em> is the downstream area which is taken into
account for transmission loss. Standard is 5.0E+10 km<sup>2</sup> and
range should be 1.0E+10 km2 to 1.0E+11 km<sup>2</sup> (higher values
lead to less loss as less area is taken into account)</p>
</blockquote>

<ol start="2" type="1">

  <li>
    <p>Activate the transmission loss option</p>
  </li>
</ol>

<p>Add the following line to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="TransLoss" choice="1" /&gt;</p>

<p>Now you are ready to run the model with the transmission loss option</p>

<h2 id="transmission-loss-output-file">Transmission loss output file</h2>

<p>The transmission option can produce an additional time series as
listed in the following table:</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A7.3</strong> Output of transmission loss
routine – Average upstream of gauges</em></td>
    </tr>
    <tr class="even">
      <td><strong>Time series</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
    </tr>
    <tr class="odd">
      <td>TransLossAvUps</td>
      <td>TransLossAvUps.tss</td>
      <td>Transmission loss in the channel</td>
      <td>mm</td>
    </tr>
  </tbody>
</table>

<h1 id="annex-8-including-water-use">Annex 8: Including water use</h1>

<h2 id="introduction-9">Introduction</h2>

<p>This annex describes the LISFLOOD water use routine, and how it is
used.</p>

<p>The water use routine can be used to assess the effect of water
withdrawal from different sectors to the water balance. Sectors can be
public, industrial, agricultural or energy water withdrawal. As input
LISFLOOD needs a stack of maps for one representative year of total
water withdrawal demand. According to the available water LISFLOOD
calculates if this demand can be fulfilled and removes the possible
amount of withdrawal water from the river system. Water use is <em>optional</em>,
and can be activated by adding the following line to the ‘lfoptions’
element:</p>

<p>&lt;setoption name="wateruse" choice="1" /&gt;</p>

<h2 id="calculation-of-water-use">Calculation of water use</h2>

<p>The water is withdrawn only from discharge in the river network but
not from soil, groundwater or directly from precipitation.</p>

<ul>

  <li>
    <p>For each single day a total demand of withdrawal water is loaded
from a sparse stack of maps</p>
  </li>
  <li>
    <p>Water use is taken from the discharge in the river network.
First the water use is taken from the same grid cell (see figure A8.1 –
pixel No. 1)</p>
  </li>
  <li>
    <p>If the amount of water withdrawal is larger than the water
available in this grid cell water is taken from downstream moving along
the local drain direction. This is done by implementing a loop
substracting the remaining water from the next downstream cell till all
the water for water use is taken or a predefined number of iteration is
reached (see figure A8.1 – pixel No. 2 to 5)</p>
  </li>
</ul>


<embed src="e:%5Cgh-pages%5C/media/image141.emf" style="width: 4.08696in; height: 2.13451in;">
<p><strong>Figure A8.1</strong> Water withdrawal assessing demand and
availability along the flow path</p>

<p>In the settings.xml you can define:</p>

<ul>

  <li>
    <p>the percentage of water that must remain in a grid cell and is
not withdrawn by water use (WUsePercRemain)</p>
  </li>
  <li>
    <p>the maximum number of loops (= distance to the water demand
cell). For example in figure 8.1: maxNoWateruse = 5</p>
  </li>
</ul>

<h2 id="preparation-of-input-data-3">Preparation of input data </h2>

<p>Table A8.1 gives an overview about the maps and table needed for the
water use option.</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A8.1</strong> Input requirements water use</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
    </tr>
    <tr class="odd">
      <td>Yearly stack of water use maps</td>
      <td>wuse0000.xxx</td>
      <td>Total water withdrawal</td>
      <td>m<sup>3</sup>/s</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Table</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
    </tr>
    <tr class="even">
      <td>WUseofDay</td>
      <td>WUseofDays.txt</td>
      <td>Assignment of day of the year to map stack of water use</td>
      <td>-</td>
    </tr>
  </tbody>
</table>

<p>A sparse map stack of one year of total water withdrawal [m<sup>3</sup>/s]
with a map every 10 days or a month is needed. Because it is assumed
that water use follows a yearly circle, this map stack is used again
and again for the following years. For example:</p>

<table>

  <thead>
  <tr class="header">
    <th><strong>t </strong></th>
    <th><strong>map name</strong></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>1</td>
      <td>wuse0000.001</td>
    </tr>
    <tr class="even">
      <td>2</td>
      <td>wuse0000.032</td>
    </tr>
    <tr class="odd">
      <td>3</td>
      <td>wuse0000.060</td>
    </tr>
    <tr class="even">
      <td>4</td>
      <td>wuse0000.091</td>
    </tr>
    <tr class="odd">
      <td>5</td>
      <td>wuse0000.121</td>
    </tr>
    <tr class="even">
      <td>6</td>
      <td>wuse0000.152</td>
    </tr>
    <tr class="odd">
      <td>7</td>
      <td>wuse0000.182</td>
    </tr>
    <tr class="even">
      <td>8</td>
      <td>wuse0000.213</td>
    </tr>
    <tr class="odd">
      <td>9</td>
      <td>wuse0000.244</td>
    </tr>
    <tr class="even">
      <td>
      <p>10</p>
      <p>11</p>
      <p>12</p>
      </td>
      <td>
      <p>wuse0000.274</p>
      <p>wuse0000.305</p>
      <p>wuse0000.335</p>
      </td>
    </tr>
  </tbody>
</table>

<p>To assign each day of simulation the right map a lookup table
(WUseOfDay.txt) is necessary:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;,0.5&gt; 335</p>
      <p>[0.5,32&gt; 1</p>
      <p>[32,60&gt; 32</p>
      <p>[60,91&gt; 60</p>
      <p>[91,121&gt; 91</p>
      <p>[121,152&gt; 121</p>
      <p>[152,182&gt; 152</p>
      <p>[182,213&gt; 182</p>
      <p>[213,244&gt; 213</p>
      <p>[244,274&gt; 244</p>
      <p>[274,305&gt; 274</p>
      <p>[305,335&gt; 305</p>
      <p>[335,&gt; 335</p>
      </td>
    </tr>
  </tbody>
</table>

<h2 id="preparation-of-settings-file-3">Preparation of settings file</h2>

<p>All in- and output files need to be defined in the settings file. If
you are using a default LISFLOOD settings template, all file
definitions are already defined in the ‘lfbinding’ element.</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;textvar name="PathWaterUse" value="./wateruse"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Water use maps path</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PrefixWaterUse" value="wuse"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>prefix water use maps</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;group&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>**************************************************************</p>
      <p>INPUT WATER USE MAPS AND PARAMETERS</p>
      <p>**************************************************************</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="WaterUseMaps" value="$(PathOut)/wuse"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Reported water use [cu m/s], depending on the availability of
discharge</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="WaterUseTS"
value="$(PathOut)/wateruseUps.tss"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Time series of upstream water use at gauging stations</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="StepsWaterUseTS"
value="$(PathOut)/stepsWaterUse.tss"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Number of loops needed for water use</p>
      <p>routine</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="maxNoWateruse" value="5"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>maximum number of loops for calculating the use of water</p>
      <p>= distance water is taken for water consuption</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="WUsePercRemain" value="0.2"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>percentage of water which remains in the channel</p>
      <p>e.g. 0.2 -&gt; 20 percent of discharge is not taken out</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;/group&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><em>PathWaterUse</em> is the path to the map stack of water use</p>
  <p><em>PrefixWaterUse</em> is the prefix of the water use maps</p>
  <p><em>WaterUseMaps</em> is the path and prefix of the reported water
use [m<sup>3</sup>/s] as a result of demand and availability</p>
  <p><em>WaterUseTS</em> are time series of upstream water use [m<sup>3</sup>/s]
at gauging stations</p>
  <p><em>StepsWaterUseTS</em> is the number of loops needed for water
use [-]</p>
  <p><em>maxNoWateruse</em> is maximum number of loops for calculating
the use of water (distance water is taken for water consumption)</p>
  <p><em>WUsePercRemain</em> is the percentage of water which remains
in the channel</p>
  <p>(e.g. 0.2 -&gt; 20 percent of discharge is not taken out)</p>
</blockquote>

<p>Finally, you have to tell LISFLOOD that you want to simulate water
use. To do this, add the following statement to the ‘lfoptions’ element:</p>

<p>&lt;setoption name="wateruse" choice="1" /&gt;</p>

<h2 id="water-use-output-files">Water use output files</h2>

<p>The water use routine can produce 2 additional time series and one
map (or stack), as listed in the following table:</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A8.3</strong> Output of water use routine</em></td>
    </tr>
    <tr class="even">
      <td><strong>Maps</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Option</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="odd">
      <td>WaterUseMaps</td>
      <td>wusexxxx.xxx</td>
      <td>repwateruseMaps</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>Time series</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Option</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Remarks</strong></td>
    </tr>
    <tr class="even">
      <td>Number of loops</td>
      <td>stepsWaterUse.tss</td>
      <td><br>
      </td>
      <td>-</td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td>WaterUseTS</td>
      <td>wateruseUps.tss</td>
      <td>repwateruseTS</td>
      <td>m<sup>3</sup>/s</td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<h1 id="annex-9-simulation-and-reporting-of-water-levels">Annex 9:
Simulation and reporting of water levels</h1>

<h2 id="introduction-10">Introduction</h2>

<p>Within LISFLOOD it is possible to simulate and report water levels
in the channel. The simulation of water levels is <em>optional</em>,
and it can be activated by adding the following line to the ‘lfoptions’
element:</p>

<p>&lt;setoption name="simulateWaterLevels" choice="1" /&gt;</p>

<p>If the option is switched on, water levels are calculated for
channel pixels where either kinematic or dynamic wave routing is used.
Using this option does <em>not</em> influence the actual model results
in any way, and it is included only to allow the model user to report
water levels. The actual <em>reporting</em> of the simulated water
levels (as time series or maps) can be activated using two separate
options.</p>

<h2 id="calculation-of-water-levels">Calculation of water levels</h2>

<p>For channel stretches that are simulated using the dynamic wave, the
water level in the channel is simply the difference between the channel
head and the channel bottom level. For kinematic wave stretches, only
approximate water levels can be estimated from the cross-sectional
(wetted) channel area, <em>A<sub>ch</sub></em> for each time step.
Since the channel cross-section is described as a trapezoid, water
levels follow directly from <em>A<sub>ch</sub></em> , channel bottom
width, side slope and bankfull level. If <em>A<sub>ch</sub></em>
exceeds the bankfull cross-sectional area (<em>A<sub>bf</sub></em>),
the surplus is distributed evenly over the (rectangular) floodplain,
and the depth of water on the floodplain is added to the (bankfull)
channel depth. Figure A9.1 below further illustrates the cross-section
geometry. All water levels are relative to channel bottom level (<em>z<sub>bot</sub></em>
in the Figure).</p>

<p><img src="e:%5Cgh-pages%5C/media/image142.png" alt="chanDims" style="width: 5.77083in; height: 2.11458in;"></p>

<p><em>Figure A9.1 Geometry of channel cross-section in kinematic wave
routing.</em> W<sub>b</sub><em>: channel bottom width;</em> W<sub>u</sub><em>:
channel upper width;</em> z<sub>bot</sub><em>: channel bottom level;</em>
z<sub>fp</sub><em>: floodplain bottom level;</em> s<em>: channel side
slope;</em> W<sub>fp</sub><em>: floodplain width;</em> A<sub>bf</sub><em>:
channel cross-sectional area at bankfull;</em> A<sub>fp</sub><em>:
floodplain cross-sectional area;</em> D<sub>bf</sub><em>:</em> <em>bankfull
channel depth,</em> D<sub>fp</sub><em>: depth of water on the floodplain</em></p>

<p>In order to calculate water levels, LISFLOOD needs a map with the
with of the floodplain in [m], which is defined by ‘lfbinding’ variable
<em>FloodPlainWidth</em> (the default name of this map is <em>chanfpln.map</em>).</p>

<h2 id="reporting-of-water-levels">Reporting of water levels</h2>

<p>Water levels can be reported as time series (at the gauge locations
that are also used for reporting discharge), or as maps.</p>

<p>To generate a time series, add the following line to the ‘lfoptions’
element of your settings file:</p>

<p>&lt;setoption name="repWaterLevelTs" choice="1" /&gt;</p>

<p>For maps, use the following line instead:</p>

<p>&lt;setoption name="repWaterLevelMaps" choice="1" /&gt;</p>

<p>In either case, the reporting options should be used <em>in addition</em>
to the ‘simulateWaterLevels’ option. If you do not include the
‘simulateWaterLevels’ option, there will be nothing to report and
LISFLOOD will exit with an error message.</p>

<h2 id="preparation-of-settings-file-4">Preparation of settings file</h2>

<p>The naming of the reported water level time series and maps is
defined in the settings file. If you are using a default LISFLOOD
settings template, all file definitions are already defined in the
‘lfbinding’ element.</p>

<p>Time series:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;textvar name="WaterLevelTS"
value="$(PathOut)/waterLevel.tss"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Reported water level [m]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<p>Map stack:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;textvar name="WaterLevelMaps" value="$(PathOut)/wl"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Reported water level [m]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<h1 id="annex-10-simulation-and-reporting-of-soil-moisture-as-pf-values">Annex
10: Simulation and reporting of soil moisture as pF values</h1>

<h2 id="introduction-11">Introduction</h2>

<p>LISFLOOD offers the possibility to calculate pF values from the
moisture content of both soil layers. The calculation of pF values is <em>optional</em>,
and it can be activated by adding the following line to the ‘lfoptions’
element:</p>

<p>&lt;setoption name="simulatePF" choice="1" /&gt;</p>

<p>Using this option does <em>not</em> influence the actual model
results in any way, and it is included only to allow the model user to
report pF time series or maps. The actual <em>reporting</em> of the
computed pF values (as time series or maps) can be activated using
separate options (which are discussed further on).</p>

<h2 id="calculation-of-pf">Calculation of pF</h2>

<p>A soil’s pF is calculated as the logarithm of the capillary suction
head, <em>h</em>:</p>

<p>with <em>h</em> in [cm] (positive upwards). Values of pF are
typically within the range 1.0 (very wet) to 5.0 (very dry). The
relationship between soil moisture status and capillary suction head is
described by the Van Genuchten equation (here again re-written in terms
of mm water slice, instead of volume fractions):</p>

<p>where <em>h</em> is the suction head [cm], and <em>w</em>, <em>w<sub>r</sub></em>
and <em>w<sub>s</sub></em> are the actual, residual and maximum
amounts of moisture in the soil respectively (all in [mm]). Parameter <em>α</em>
is related to soil texture. Parameters <em>m</em> and <em>n</em> are
calculated from the pore-size index, <em>λ</em> (which is related to
soil texture as well):</p>

<p>If the soil contains no moisture at all (<em>w</em>=0), <em>h</em>
is set to a fixed (arbitrary) value of 1∙10<sup>7</sup> cm.</p>

<h2 id="reporting-of-pf"><br>
Reporting of pF</h2>

<p>pF can be reported as time series (at the locations defined on the
“sites” map or as average values upstream each gauge location), or as
maps. To generate time series at the “sites”, add the following line to
the ‘lfoptions’ element of your settings file:</p>

<p>&lt;setoption name="repPFTs" choice="1" /&gt;</p>

<p>For maps, use the following lines instead (for the upper and lower
soil layer, respectively):</p>

<p>&lt;setoption name="repPF1Maps" choice="1" /&gt;</p>

<p>&lt;setoption name="repPF2Maps" choice="1" /&gt;</p>

<p>In either case, the reporting options should be used <em>in addition</em>
to the ‘simulatePF’ option. If you do not include the ‘simulatePF’
option, there will be nothing to report and LISFLOOD will exit with an
error message.</p>

<h2 id="preparation-of-settings-file-5">Preparation of settings file</h2>

<p>The naming of the reported time series and maps is defined in the
settings file. Tables A7.1 and A7.2 list the settings variables default
output names. If you are using a default LISFLOOD settings template,
all file definitions are already defined in the ‘lfbinding’ element.</p>

<p>Time series:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>PF TIMESERIES, VALUES AT SITES</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="PF1TS" value="$(PathOut)/pFTop.tss"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Reported pF upper soil layer [-]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PF2TS" value="$(PathOut)/pFSub.tss"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Reported pF lower soil layer [-]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>PF TIMESERIES, AVERAGE VALUES UPSTREAM OF GAUGES</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="PF1AvUpsTS"
value="$(PathOut)/pFTopUps.tss"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Reported pF upper soil layer [-]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PF2AvUpsTS"
value="$(PathOut)/pFSubUps.tss"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Reported pF lower soil layer [-]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<p>Map stacks:</p>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p>&lt;comment&gt;</p>
      <p>PF MAPS</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;textvar name="PF1Maps" value="$(PathOut)/pftop"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Reported pF upper soil layer [-]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      <p>&lt;textvar name="PF2Maps" value="$(PathOut)/pfsub"&gt;</p>
      <p>&lt;comment&gt;</p>
      <p>Reported pF lower soil layer [-]</p>
      <p>&lt;/comment&gt;</p>
      <p>&lt;/textvar&gt;</p>
      </td>
    </tr>
  </tbody>
</table>

<table>

  <thead>
  <tr class="header">
    <th><em><strong>Table A10.1</strong> pF map output</em></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Option name</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Default prefix</strong></td>
    </tr>
    <tr class="even">
      <td>pF upper layer</td>
      <td>repPF1Maps</td>
      <td>PF1Maps</td>
      <td>pftop</td>
    </tr>
    <tr class="odd">
      <td>pF lower layer</td>
      <td>repPF2Maps</td>
      <td>PF2Maps</td>
      <td>pfsub</td>
    </tr>
  </tbody>
</table>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A10.2</strong> pF timeseries output</em></td>
    </tr>
    <tr class="even">
      <td><strong>pF at sites (option <em>repPFSites</em>)</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Default name</strong></td>
    </tr>
    <tr class="even">
      <td>pF upper layer</td>
      <td>PF1TS</td>
      <td>pFTop.tss</td>
    </tr>
    <tr class="odd">
      <td>pF lower layer</td>
      <td>PF2TS</td>
      <td>pFSub.tss</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>pF, average upstream of gauges (option <em>repPFUpsGauges</em>)</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Description</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Default name</strong></td>
    </tr>
    <tr class="odd">
      <td>pF upper layer</td>
      <td>PF1AvUpsTS</td>
      <td>pFTopUps.tss</td>
    </tr>
    <tr class="even">
      <td>pF lower layer</td>
      <td>PF2AvUpsTS</td>
      <td>pFSubUps.tss</td>
    </tr>
  </tbody>
</table>


<h1 id="annex-11-lisflood-options">Annex 11: LISFLOOD options</h1>

<p>As explained in Chapter 5, the ‘lfoptions’ element gives you
additional control over what LISFLOOD is doing. Using options it is
possible to switch certain parts of the model on or off. This way you
can tell the model exactly which output files are reported and which
ones aren’t. Also, they can be used to activate a number of additional
model features, such as the simulation of reservoirs and inflow
hydrographs.</p>

<p>The table below lists all currently implemented options and their
corresponding defaults. All currently implemented options are switches
(1= on, 0=off). You can set as many options as you want (or none at
all). Table 10.1 lists all currently implemented options<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>.
Note that each option generally requires additional items in the
settings file. For instance, using the inflow hydrograph option
requires an input map and time series, which have to be specified in
the settings file. If you want to report discharge maps at each time
step, you will first have to specify under which name they will be
written. The template settings file that is provided with LISFLOOD
always contains file definitions for all optional output maps and time
series. The use of the <em>output</em> options is described in detail
in Chapter 8.</p>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A11.1</strong> LISFLOOD options (continued
on next page)</em></td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>SIMULATION OPTIONS</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Option</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Default</strong></td>
    </tr>
    <tr class="odd">
      <td>gridSizeUserDefined</td>
      <td>Get grid size attributes (length, area) from user-defined
maps (instead of using map location attributes directly)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>simulateReservoirs</td>
      <td>Simulate retention and hydropower reservoirs (kin. wave only)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>simulateLakes</td>
      <td>Simulate unregulated lakes (kin. wave only)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>simulatePolders</td>
      <td>Simulate flood protection polders (dyn. wave only)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>inflow</td>
      <td>Use inflow hydrographs</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>dynamicWave</td>
      <td>Perform dynamic wave channel routing</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>simulateWaterLevels</td>
      <td>Simulate water levels in channel</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>TransLoss</td>
      <td>Simulate transmission loss</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>SplitRouting</td>
      <td>Simulate double kinematic wave</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>VarNoSubStepChannel</td>
      <td>Use variable number of sub step for channel routing</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>wateruse</td>
      <td>Simulate water use</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>OUTPUT, TIME SERIES</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Option</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Default</strong></td>
    </tr>
    <tr class="odd">
      <td>repDischargeTs</td>
      <td>Report timeseries of discharge at gauge locations</td>
      <td>1</td>
    </tr>
    <tr class="even">
      <td>repWaterLevelTs</td>
      <td>Report timeseries of water level at gauge locations<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a></td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repStateSites</td>
      <td>Report timeseries of all intermediate state variables at
'sites'</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repRateSites</td>
      <td>Report timeseries of all intermediate rate variables at
'sites'</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repMeteoUpsGauges</td>
      <td>Report timeseries of meteorological input, averaged over
contributing area of each gauging station</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repStateUpsGauges</td>
      <td>Report timeseries of model state variables, averaged over
contributing area of each gauging station</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repRateUpsGauges</td>
      <td>Report timeseries of model rate variables, averaged over
contributing area of each gauging station</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>OUTPUT, MASS BALANCE</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Option</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Default</strong></td>
    </tr>
    <tr class="odd">
      <td>repMBTs</td>
      <td>Report timeseries of absolute cumulative mass balance error</td>
      <td>1</td>
    </tr>
    <tr class="even">
      <td>repMBMMTs</td>
      <td>Report timeseries of cumulative mass balance error expressed
as mm water slice</td>
      <td>1</td>
    </tr>
    <tr class="odd">
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A11.1</strong> LISFLOOD options (continued
from previous page)</em></td>
    </tr>
    <tr class="even">
      <td><strong>OUTPUT, MAPS, DISCHARGE</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Option</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Default</strong></td>
    </tr>
    <tr class="even">
      <td>repDischargeMaps</td>
      <td>Report maps of discharge (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repWaterLevelMaps<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></td>
      <td>Report maps of water level in channel (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>OUTPUT, MAPS, STATE VARIABLES (all, at selected time
steps)</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Option</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Default</strong></td>
    </tr>
    <tr class="odd">
      <td>repStateMaps</td>
      <td>Report maps of model state variables (as defined by
"ReportSteps" variable)</td>
      <td>1</td>
    </tr>
    <tr class="even">
      <td>repEndMaps<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></td>
      <td>Report maps of model state variables (at last time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>OUTPUT, MAPS, STATE VARIABLES</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Option</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Default</strong></td>
    </tr>
    <tr class="even">
      <td>repDSLRMaps</td>
      <td>Report maps of days since last rain (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repFrostIndexMaps</td>
      <td>Report maps of frost index (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repWaterDepthMaps</td>
      <td>Report maps of depth of water layer on soil surface (for each
time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repSnowCoverMaps</td>
      <td>Report maps of snow cover (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repCumInterceptionMaps</td>
      <td>Report maps of interception storage (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repTheta1Maps</td>
      <td>Report maps of soil moisture layer 1(for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repTheta2Maps</td>
      <td>Report maps of soil moisture layer 2 (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repUZMaps</td>
      <td>Report maps of upper zone storage (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repLZMaps</td>
      <td>Report maps of lower zone storage (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>
      <p>repChanCrossSection</p>
      <p>Maps</p>
      </td>
      <td>Report maps of channel cross-sectional area (for each time
step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>OUTPUT, MAPS, METEOROLOGICAL FORCING VARIABLES</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Option</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Default</strong></td>
    </tr>
    <tr class="odd">
      <td>repPrecipitationMaps</td>
      <td>Report maps of precipitation (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repTavgMaps</td>
      <td>Report maps of average temperature (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repETRefMaps</td>
      <td>Report maps of potential reference evapotranspiration (for
each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repESRefMaps</td>
      <td>Report maps of potential soil evaporation (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repEWRefMaps</td>
      <td>Report maps of potential open water evaporation (for each
time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
    </tr>
  </tbody>
</table>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A11.1</strong> LISFLOOD options (continued
from previous page)</em></td>
    </tr>
    <tr class="even">
      <td><strong>OUTPUT, MAPS, RATE VARIABLES</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Option</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Default</strong></td>
    </tr>
    <tr class="even">
      <td>repRainMaps</td>
      <td>Report maps of rain (excluding snow!) (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repSnowMaps</td>
      <td>Report maps of snow (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repSnowMeltMaps</td>
      <td>Report maps of snowmelt (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repInterceptionMaps</td>
      <td>Report maps of interception (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repLeafDrainageMaps</td>
      <td>Report maps of leaf drainage (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repTaMaps</td>
      <td>Report maps of actual transpiration (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repESActMaps</td>
      <td>Report maps of actual soil evaporation (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repEWIntMaps</td>
      <td>Report maps of actual evaporation of intercepted water (for
each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repInfiltrationMaps</td>
      <td>Report maps of infiltration (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repPrefFlowMaps</td>
      <td>Report maps of preferential flow (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repPercolationMaps</td>
      <td>Report maps of percolation from upper to lower soil layer
(for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repSeepSubToGWMaps</td>
      <td>Report maps of seepage from lower soil layer to ground water
(for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repGwPercUZLZMaps</td>
      <td>Report maps of percolation from upper to lower ground water
zone (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repGwLossMaps</td>
      <td>Report maps of loss from lower ground water zone (for each
time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repSurfaceRunoffMaps</td>
      <td>Report maps of surface runoff (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repUZOutflowMaps</td>
      <td>Report maps of upper zone outflow (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repLZOutflowMaps</td>
      <td>Report maps of lower zone outflow (for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repTotalRunoffMaps</td>
      <td>Report maps of total runoff (surface + upper + lower zone)
(for each time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td><br>
      </td>
    </tr>
    <tr class="odd">
      <td><strong>OUTPUT, MAPS (MISCELLANEOUS)</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Option</strong></td>
      <td><strong>Description</strong></td>
      <td><strong>Default</strong></td>
    </tr>
    <tr class="odd">
      <td>repLZAvInflowMap</td>
      <td>Report computed average inflow rate into lower zone (map, at
last time step)</td>
      <td>0</td>
    </tr>
    <tr class="even">
      <td>repLZAvInflowSites</td>
      <td>Report computed average inflow rate into lower zone (time
series, at points defined on sites map)</td>
      <td>0</td>
    </tr>
    <tr class="odd">
      <td>repLZAvInflowUpsGauges</td>
      <td>Report computed average inflow rate into lower zone (time
series, averaged over upstream area of each gauge location)</td>
      <td>0</td>
    </tr>
  </tbody>
</table>

<h1 id="annex-12-lisflood-input-maps-and-tables"><br>
Annex 12: LISFLOOD input maps and tables</h1>

<h2 id="maps">Maps</h2>

<table>

  <thead>
  <tr class="header">
    <th><em><strong>Table A12.1</strong> LISFLOOD input maps (continued
on next pages)</em></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><strong>GENERAL</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Map</strong></td>
      <td><strong>Default name</strong><a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a></td>
      <td><strong>Units, range</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>MaskMap</td>
      <td>area.map</td>
      <td>
      <p>Unit: -</p>
      <p>Range: 0 or 1</p>
      </td>
      <td><em>Boolean</em> map that defines model boundaries</td>
    </tr>
    <tr class="even">
      <td><strong>TOPOGRAPHY</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Map</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Units, range</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="even">
      <td>Ldd</td>
      <td>ldd.map</td>
      <td>
      <p>U.: flow<br>
directions</p>
      <p>R.: 1 ≤ map ≤ 9</p>
      </td>
      <td>
      <p>local drain direction map (with value 1-9); this file contains
flow directions from each cell to its steepest downslope neighbour. Ldd
directions are coded according to the following diagram:</p>
      <p><img src="e:%5Cgh-pages%5C/media/image146.png" alt="ldd" style="width: 1.82292in; height: 1.84375in;"></p>
      <p>This resembles the numeric key pad of your PC’s keyboard,
except for
the value 5, which defines a cell without local drain direction (pit).
The pit cell at the end of the path is the outlet point of a catchment.</p>
      </td>
    </tr>
    <tr class="odd">
      <td>Grad</td>
      <td>gradient.map</td>
      <td>
      <p>U.: [m m<sup>-1</sup>]</p>
      <p>R.: map &gt; 0 <strong>!!!</strong></p>
      </td>
      <td>Slope gradient</td>
    </tr>
    <tr class="even">
      <td>Elevation Stdev</td>
      <td>elvstd.map</td>
      <td>U.: [m]<br>
R.: map ≥ 0</td>
      <td>Standard deviation of elevation</td>
    </tr>
  </tbody>
</table>

<table>

  <thead>
  <tr class="header">
    <th><em><strong>Table A12.1</strong> LISFLOOD input maps (continued
from previous page)</em></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><strong>LAND USE – fraction maps</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Map</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Units, range</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>Fraction of water</td>
      <td>fracwater.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 ≤ map ≤ 1</p>
      </td>
      <td>Fraction of inland water for each cell. Values range from 0
(no water at all) to 1 (pixel is 100% water)</td>
    </tr>
    <tr class="even">
      <td>Fraction of sealed surface</td>
      <td>fracsealed.map</td>
      <td>
      <p>U.: [-</p>
      <p>R.: 0 ≤ map ≤ 1</p>
      </td>
      <td>Fraction of impermeable surface for each cell. Values range
from 0
(100% permeable surface – no urban at all) to 1 (100% impermeable
surface).</td>
    </tr>
    <tr class="odd">
      <td>Fraction of forest</td>
      <td>fracforest.map</td>
      <td>
      <p>U.:[-]</p>
      <p>R.: 0 ≤ map ≤ 1</p>
      </td>
      <td>Forest fraction for each cell. Values range from 0 (no forest
at all) to 1 (pixel is 100% forest)</td>
    </tr>
    <tr class="even">
      <td>Fraction of other land cover</td>
      <td>fracother.map</td>
      <td>
      <p>U.: []</p>
      <p>R.: 0 ≤ map ≤ 1</p>
      </td>
      <td>Other (agricultural areas, non-forested natural area,
pervious surface of urban areas) fraction for each cell.</td>
    </tr>
    <tr class="odd">
      <td><strong>LAND COVER depending maps</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Map</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Units, range</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>Crop coef. for forest</td>
      <td>cropcoef_<br>
forest.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0.8≤ map ≤ 1.2</p>
      </td>
      <td>Crop coefficient for forest</td>
    </tr>
    <tr class="even">
      <td>Crop coef. for other</td>
      <td>cropcoef_<br>
other.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0.8≤ map ≤ 1.2</p>
      </td>
      <td>Crop coefficient for other</td>
    </tr>
    <tr class="odd">
      <td>Crop group number for forest</td>
      <td>crgrnum_<br>
forest.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 1 ≤ map ≤ 5</p>
      </td>
      <td>Crop group number for forest</td>
    </tr>
    <tr class="even">
      <td>Crop group number for forest</td>
      <td>crgrnum_<br>
other.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 1 ≤ map ≤ 5</p>
      </td>
      <td>Crop group number for other</td>
    </tr>
    <tr class="odd">
      <td>Manning for forest</td>
      <td>mannings_<br>
forest.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0.2≤ map ≤ 0.4</p>
      </td>
      <td>Manning’s roughness for forest</td>
    </tr>
    <tr class="even">
      <td>Manning for other</td>
      <td>mannings_<br>
other.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0.01≤ map ≤0.3</p>
      </td>
      <td>Manning’s roughness for other</td>
    </tr>
    <tr class="odd">
      <td>Soil depth for forest for layer1</td>
      <td>soildep1_<br>
forest.map</td>
      <td>
      <p>U.: [mm]</p>
      <p>R.: map ≥ 50</p>
      </td>
      <td>Forest soil depth for soil layer 1 (rooting depth)</td>
    </tr>
    <tr class="even">
      <td>Soil depth for other for layer2</td>
      <td>soildep1_<br>
other.map</td>
      <td>
      <p>U.: [mm]</p>
      <p>R.: map ≥ 50</p>
      </td>
      <td>Other soil depth for soil layer 1 (rooting depth)</td>
    </tr>
    <tr class="odd">
      <td>Soil depth for forest for layer2</td>
      <td>Soildep2_<br>
forest.map</td>
      <td>
      <p>U.: [mm]</p>
      <p>R.: map ≥ 50</p>
      </td>
      <td>Forest soil depth for soil layer 2</td>
    </tr>
    <tr class="even">
      <td>Soil depth for other for layer2</td>
      <td>Soildep2_<br>
other.map</td>
      <td>
      <p>U.: [mm]</p>
      <p>R.: map ≥ 50</p>
      </td>
      <td>Other soil depth for soil layer 2</td>
    </tr>
  </tbody>
</table>

<table>

  <thead>
  <tr class="header">
    <th><em><strong>Table A12.1</strong> LISFLOOD input maps (continued
from previous page)</em></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><strong>SOIL HYDRAULIC PROPERTIES (depending on soil texture)</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Map</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Units, range</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>ThetaSat1 for forest</td>
      <td>thetas1_<br>
forest.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Saturated volumetric soil moisture content layer 1</td>
    </tr>
    <tr class="even">
      <td>ThetaSat1 for other</td>
      <td>thetas1_<br>
other.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Saturated volumetric soil moisture content layer 1</td>
    </tr>
    <tr class="odd">
      <td>ThetaSat2 for forest and other</td>
      <td>thetas2.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Saturated volumetric soil moisture content layer 2</td>
    </tr>
    <tr class="even">
      <td>ThetaRes1 for forest</td>
      <td>thetar1_<br>
forest.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Residual volumetric soil moisture content layer 1</td>
    </tr>
    <tr class="odd">
      <td>ThetaRes1 for other</td>
      <td>thetar1_<br>
other.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Residual volumetric soil moisture content layer 1</td>
    </tr>
    <tr class="even">
      <td>ThetaRes2 for forest and other</td>
      <td>thetar2.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Residual volumetric soil moisture content layer 2</td>
    </tr>
    <tr class="odd">
      <td>Lambda1 for forest</td>
      <td>lambda1_<br>
forest.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Pore size index (λ) layer 1</td>
    </tr>
    <tr class="even">
      <td>Lambda1 for other</td>
      <td>lambda1_<br>
other.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Pore size index (λ) layer 1</td>
    </tr>
    <tr class="odd">
      <td>Lambda2 for forest and other</td>
      <td>lambda2.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Pore size index (λ) layer 2</td>
    </tr>
    <tr class="even">
      <td>GenuAlpha1 for forest</td>
      <td>alpha1_<br>
forest.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Van Genuchten parameter α layer 1</td>
    </tr>
    <tr class="odd">
      <td>GenuAlpha1 for other</td>
      <td>alpha1_<br>
other.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Van Genuchten parameter α layer 1</td>
    </tr>
    <tr class="even">
      <td>GenuAlpha2 for forest and other</td>
      <td>alpha2.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 &lt; map &lt; 1</p>
      </td>
      <td>Van Genuchten parameter α layer 2</td>
    </tr>
    <tr class="odd">
      <td>Sat1 for forest</td>
      <td>ksat1_<br>
forest.map</td>
      <td>
      <p>U.: [cm day<sup>-1</sup>]</p>
      <p>R.: 1 ≤ map ≤ 100</p>
      </td>
      <td>Saturated conductivity layer 1</td>
    </tr>
    <tr class="even">
      <td>Sat1 for other</td>
      <td>ksat1_<br>
other.map</td>
      <td>
      <p>U.: [cm day<sup>-1</sup>]</p>
      <p>R.: 1 ≤ map ≤ 100</p>
      </td>
      <td>Saturated conductivity layer 1</td>
    </tr>
    <tr class="odd">
      <td>Sat2 for forest and other</td>
      <td>ksat2.map</td>
      <td>
      <p>U.: [cm day<sup>-1</sup>]</p>
      <p>R.: 1 ≤ map ≤ 100</p>
      </td>
      <td>Saturated conductivity layer 2</td>
    </tr>
  </tbody>
</table>

<table>

  <thead>
  <tr class="header">
    <th><em><strong>Table A12.1</strong> LISFLOOD input maps (continued
from previous page)</em></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><strong>CHANNEL GEOMETRY</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Map</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Units, range</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>Channels</td>
      <td>chan.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: 0 or 1</p>
      </td>
      <td>Map with Boolean 1 for all channel pixels, and Boolean 0 for
all other pixels on MaskMap</td>
    </tr>
    <tr class="even">
      <td>ChanGrad</td>
      <td>changrad.map</td>
      <td>
      <p>U.: [m m<sup>-1</sup>]</p>
      <p>R.: map &gt; 0 <strong>!!!</strong></p>
      </td>
      <td>Channel gradient</td>
    </tr>
    <tr class="odd">
      <td>ChanMan</td>
      <td>chanman.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: map &gt; 0</p>
      </td>
      <td>Manning’s roughness coefficient for channels</td>
    </tr>
    <tr class="even">
      <td>ChanLength</td>
      <td>chanleng.map</td>
      <td>
      <p>U.: [m]</p>
      <p>R.: map &gt; 0</p>
      </td>
      <td>Channel length (can exceed grid size, to account for
meandering rivers)</td>
    </tr>
    <tr class="odd">
      <td>ChanBottomWidth</td>
      <td>chanbw.map</td>
      <td>
      <p>U.: [m]</p>
      <p>R.: map &gt; 0</p>
      </td>
      <td>Channel bottom width</td>
    </tr>
    <tr class="even">
      <td>ChanSdXdY</td>
      <td>chans.map</td>
      <td>
      <p>U.: [m m<sup>-1</sup>]</p>
      <p>R.: map ≥ 0</p>
      </td>
      <td>Channel side slope <strong>Important:</strong> defined as
horizontal divided by vertical distance (dx/dy); this may be confusing
because slope is usually defined the other way round (i.e. dy/dx)!</td>
    </tr>
    <tr class="odd">
      <td>ChanDepth<br>
Threshold</td>
      <td>chanbnkf.map</td>
      <td>
      <p>U.: [m]</p>
      <p>R.: map &gt; 0</p>
      </td>
      <td>Bankfull channel depth</td>
    </tr>
    <tr class="even">
      <td><strong>METEOROLOGICAL VARIABLES</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Map</strong></td>
      <td><strong>Default prefix</strong></td>
      <td><strong>Units, range</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="even">
      <td>Precipitation<br>
Maps</td>
      <td>pr</td>
      <td>
      <p>U.: [mm day<sup>-1</sup>]</p>
      <p>R.: map ≥ 0</p>
      </td>
      <td>Precipitation rate</td>
    </tr>
    <tr class="odd">
      <td>TavgMaps</td>
      <td>ta</td>
      <td>
      <p>U.: [°C]</p>
      <p>R.:-50 ≤map ≤ +50</p>
      </td>
      <td>Average <em>daily</em> temperature\</td>
    </tr>
    <tr class="even">
      <td>E0Maps</td>
      <td>e</td>
      <td>
      <p>U.: [mm day<sup>-1</sup>]</p>
      <p>R.: map ≥ 0</p>
      </td>
      <td>Daily potential evaporation rate, free water surface</td>
    </tr>
    <tr class="odd">
      <td>ES0Maps</td>
      <td>es</td>
      <td>
      <p>U.: [mm day<sup>-1</sup>]</p>
      <p>R.: map ≥ 0</p>
      </td>
      <td>Daily potential evaporation rate, bare soil</td>
    </tr>
    <tr class="even">
      <td>ET0Maps</td>
      <td>et</td>
      <td>
      <p>U.: [mm day<sup>-1</sup>]</p>
      <p>R.: map ≥ 0</p>
      </td>
      <td>Daily potential evapotranspiration rate, reference crop</td>
    </tr>
    <tr class="odd">
      <td><strong>DEVELOPMENT OF VEGETATION OVER TIME</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Map</strong></td>
      <td><strong>Default prefix</strong></td>
      <td><strong>Units, range</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>LAIMaps<br>
for forest</td>
      <td>lai_forest</td>
      <td>
      <p>U.: [m<sup>2</sup> m<sup>-2</sup>]</p>
      <p>R.: map ≥ 0</p>
      </td>
      <td>Pixel-average Leaf Area Index for forest</td>
    </tr>
    <tr class="even">
      <td>LAIMaps<br>
for other</td>
      <td>lai_other</td>
      <td>
      <p>U.: [m<sup>2</sup> m<sup>-2</sup>]</p>
      <p>R.: map ≥ 0</p>
      </td>
      <td>Pixel-average Leaf Area Index for other</td>
    </tr>
    <tr class="odd">
      <td><strong>DEFINITION OF INPUT/OUTPUT TIMESERIES</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Map</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Units, range</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>Gauges</td>
      <td>outlets.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: For each station an individual number</p>
      </td>
      <td>Nominal map with locations at which discharge timeseries are
reported (usually correspond to gauging stations)</td>
    </tr>
    <tr class="even">
      <td>Sites</td>
      <td>sites.map</td>
      <td>
      <p>U.: [-]</p>
      <p>R.: For each station an individual number</p>
      </td>
      <td>Nominal map with locations (individual pixels or areas) at
which
timeseries of intermediate state and rate variables are reported (soil
moisture, infiltration, snow, etcetera)</td>
    </tr>
  </tbody>
</table>

<table>

  <thead>
  <tr class="header">
    <th><em><strong>Table A12.2</strong> Optional maps that define grid
size</em></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>Map</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Units, range</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>PixelLengthUser</td>
      <td>pixleng.map</td>
      <td>
      <p>U.: [m]</p>
      <p>R.: map &gt; 0</p>
      </td>
      <td>Map with pixel length</td>
    </tr>
    <tr class="even">
      <td>PixelAreaUser</td>
      <td>pixarea.map</td>
      <td>
      <p>U.: [m]</p>
      <p>R.: map &gt; 0</p>
      </td>
      <td>Map with pixel area</td>
    </tr>
  </tbody>
</table>

<h2 id="tables">Tables</h2>

<p>In the previous version of LISFLOOD a number of model parameters are
read through tables that are linked to the classes on the land use and
soil (texture) maps. Those tables are replaced by maps (e.g. soil
hydraulic property maps) in order to include the sub-grid variability
of each parameter. Therefore only one default table is used in the
standard LISFLOOD setting</p>

<p>The following table gives an overview:</p>

<table>

  <thead>
  <tr class="header">
    <th><em><strong>Table A12.3</strong> LISFLOOD input tables</em></th>
  </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><strong>LAND USE</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Table</strong></td>
      <td><strong>Default name</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr class="odd">
      <td>Day of the year -&gt; LAI</td>
      <td>LaiOfDay.txt</td>
      <td>Lookup table: Day of the year -&gt; LAI map</td>
    </tr>
  </tbody>
</table>

<h1 id="annex-13-lisflood-output">Annex 13: LISFLOOD output</h1>

<h2 id="time-series">Time series</h2>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A13.1</strong> LISFLOOD default output time
series</em></td>
    </tr>
    <tr class="even">
      <td><strong>RATE VARIABLES AT GAUGES</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>File name</strong></td>
    </tr>
    <tr class="even">
      <td><strong><sup>1,2</sup></strong> channel discharge</td>
      <td>m<sup>3</sup> s<sup>-1</sup></td>
      <td>disTS</td>
      <td>dis.tss</td>
    </tr>
    <tr class="odd">
      <td><strong>NUMERICAL CHECKS</strong></td>
      <td><br>
      </td>
      <td><br>
      </td>
      <td><br>
      </td>
    </tr>
    <tr class="even">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><br>
      </td>
      <td><strong>File name</strong></td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> cumulative mass balance error</td>
      <td>m<sup>3</sup></td>
      <td>WaterMassBalanceTSS</td>
      <td>mbError.tss</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> cumulative mass balance error,
expressed as mm water slice (average over catchment)</td>
      <td>mm</td>
      <td>MassBalanceMM<br>
TSS</td>
      <td>mbErrorMm.tss</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> number of sub-steps needed for
channel routing</td>
      <td>-</td>
      <td>NoSubStepsChan</td>
      <td>NoSubStepsChannel.tss</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> number of sub-steps needed for
gravity-based soil moisture routine</td>
      <td>-</td>
      <td>StepsSoilTS</td>
      <td>steps.tss</td>
    </tr>
    <tr class="odd">
      <td>
      <p><strong><sup>1</sup></strong> Output only if option
‘InitLisflood’ = 1 (pre-run)</p>
      <p><strong><sup>2</sup></strong> Output only if option
‘InitLisflood’ = 0</p>
      </td>
    </tr>
  </tbody>
</table>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p><em><strong>Table A13.2</strong> LISFLOOD optional output time
series (</em>only ‘InitLisflood’ = 0)</p>
      <p><em>(continued on next pages)</em></p>
      </td>
    </tr>
    <tr class="even">
      <td><strong>STATE VARIABLES AT SITES (option <em>repStateSites</em>)</strong><a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a></td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Default name</strong></td>
    </tr>
    <tr class="even">
      <td>depth of water on soil surface</td>
      <td>mm</td>
      <td>WaterDepthTS</td>
      <td>wDepth.tss</td>
    </tr>
    <tr class="odd">
      <td>depth of snow cover on soil surface (pixel-average)</td>
      <td>mm</td>
      <td>SnowCoverTS</td>
      <td>snowCover.tss</td>
    </tr>
    <tr class="even">
      <td>depth of interception storage</td>
      <td>mm</td>
      <td>CumInterceptionTS</td>
      <td>cumInt.tss</td>
    </tr>
    <tr class="odd">
      <td>soil moisture content upper layer</td>
      <td>mm<sup>3</sup> / mm<sup>3</sup></td>
      <td>Theta1TS</td>
      <td>thTop.tss</td>
    </tr>
    <tr class="even">
      <td>soil moisture content lower layer</td>
      <td>mm<sup>3</sup> / mm<sup>3</sup></td>
      <td>Theta2TS</td>
      <td>thSub.tss</td>
    </tr>
    <tr class="odd">
      <td>storage in upper groundwater zone</td>
      <td>mm</td>
      <td>UZTS</td>
      <td>uz.tss</td>
    </tr>
    <tr class="even">
      <td>storage in lower groundwater zone</td>
      <td>mm</td>
      <td>LZTS</td>
      <td>lz.tss</td>
    </tr>
    <tr class="odd">
      <td>number of days since last rain</td>
      <td>days</td>
      <td>DSLRTS</td>
      <td>dslr.tss</td>
    </tr>
    <tr class="even">
      <td>frost index</td>
      <td>°C days<sup>-1</sup></td>
      <td>FrostIndexTS</td>
      <td>frost.tss</td>
    </tr>
  </tbody>
</table>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A13.2</strong> LISFLOOD optional output
time series (continued from previous page)</em></td>
    </tr>
    <tr class="even">
      <td><strong>RATE VARIABLES AT SITES (option <em>repRateSites</em>)</strong><a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a></td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Default name</strong></td>
    </tr>
    <tr class="even">
      <td>rain (excluding snow)</td>
      <td>mm/timestep</td>
      <td>RainTS</td>
      <td>rain.tss</td>
    </tr>
    <tr class="odd">
      <td>Snow</td>
      <td>mm/timestep</td>
      <td>SnowTS</td>
      <td>snow.tss</td>
    </tr>
    <tr class="even">
      <td>snow melt</td>
      <td>mm/timestep</td>
      <td>SnowmeltTS</td>
      <td>snowMelt.tss</td>
    </tr>
    <tr class="odd">
      <td>actual evaporation</td>
      <td>mm/timestep</td>
      <td>ESActTS</td>
      <td>esAct.tss</td>
    </tr>
    <tr class="even">
      <td>actual transpiration</td>
      <td>mm/timestep</td>
      <td>TaTS</td>
      <td>tAct.tss</td>
    </tr>
    <tr class="odd">
      <td>rainfall interception</td>
      <td>mm/timestep</td>
      <td>InterceptionTS</td>
      <td>interception.tss</td>
    </tr>
    <tr class="even">
      <td>evaporation of intercepted water</td>
      <td>mm/timestep</td>
      <td>EWIntTS</td>
      <td>ewIntAct.tss</td>
    </tr>
    <tr class="odd">
      <td>leaf drainage</td>
      <td>mm/timestep</td>
      <td>LeafDrainageTS</td>
      <td>leafDrainage.tss</td>
    </tr>
    <tr class="even">
      <td>infiltration</td>
      <td>mm/timestep</td>
      <td>InfiltrationTS</td>
      <td>infiltration.tss</td>
    </tr>
    <tr class="odd">
      <td>preferential (bypass) flow</td>
      <td>mm/timestep</td>
      <td>PrefFlowTS</td>
      <td>prefFlow.tss</td>
    </tr>
    <tr class="even">
      <td>percolation upper to lower soil layer</td>
      <td>mm/timestep</td>
      <td>PercolationTS</td>
      <td>dTopToSub.tss</td>
    </tr>
    <tr class="odd">
      <td>percolation lower soil layer to subsoil</td>
      <td>mm/timestep</td>
      <td>SeepSubToGWTS</td>
      <td>dSubToUz.tss</td>
    </tr>
    <tr class="even">
      <td>surface runoff</td>
      <td>mm/timestep</td>
      <td>SurfaceRunoffTS</td>
      <td>surfaceRunoff.tss</td>
    </tr>
    <tr class="odd">
      <td>outflow from upper zone</td>
      <td>mm/timestep</td>
      <td>UZOutflowTS</td>
      <td>qUz.tss</td>
    </tr>
    <tr class="even">
      <td>outflow from lower zone</td>
      <td>mm/timestep</td>
      <td>LZOutflowTS</td>
      <td>qLz.tss</td>
    </tr>
    <tr class="odd">
      <td>total runoff</td>
      <td>mm/timestep</td>
      <td>TotalRunoffTS</td>
      <td>totalRunoff.tss</td>
    </tr>
    <tr class="even">
      <td>percolation from upper to lower zone</td>
      <td>mm/timestep</td>
      <td>GwPercUZLZTS</td>
      <td>percUZLZ.tss</td>
    </tr>
    <tr class="odd">
      <td>loss from lower zone</td>
      <td>mm/timestep</td>
      <td>GwLossTS</td>
      <td>loss.tss</td>
    </tr>
  </tbody>
</table>

<table>

  <tbody>
    <tr class="odd">
      <td>TIME SERIES, AVERAGE UPSTREAM OF GAUGES</td>
    </tr>
    <tr class="even">
      <td><strong>METEOROLOGICAL INPUT VARIABLES (option <em>repMeteoUpsGauges</em>)</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Default name</strong></td>
    </tr>
    <tr class="even">
      <td>precipitation</td>
      <td>mm/timestep</td>
      <td>PrecipitationAvUpsTS</td>
      <td>precipUps.tss</td>
    </tr>
    <tr class="odd">
      <td>potential reference evapotranspiration</td>
      <td>mm/timestep</td>
      <td>ETRefAvUpsTS</td>
      <td>etUps.tss</td>
    </tr>
    <tr class="even">
      <td>potential evaporation from soil</td>
      <td>mm/timestep</td>
      <td>ESRefAvUpsTS</td>
      <td>esUps.tss</td>
    </tr>
    <tr class="odd">
      <td>potential open water evaporation</td>
      <td>mm/timestep</td>
      <td>EWRefAvUpsTS</td>
      <td>ewUps.tss</td>
    </tr>
    <tr class="even">
      <td>average daily temperature</td>
      <td>°C</td>
      <td>TavgAvUpsTS</td>
      <td>tAvgUps.tss</td>
    </tr>
    <tr class="odd">
      <td><em><strong>Table A13.2</strong> LISFLOOD optional output
time series (continued from previous page)</em></td>
    </tr>
    <tr class="even">
      <td><strong>STATE VARIABLES (option <em>repStateUpsGauges</em>)</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Default name</strong></td>
    </tr>
    <tr class="even">
      <td>depth of water on soil surface</td>
      <td>mm</td>
      <td>WaterDepthAvUpsTS</td>
      <td>wdepthUps.tss</td>
    </tr>
    <tr class="odd">
      <td>depth of snow cover on</td>
      <td>mm</td>
      <td>SnowCoverAvUpsTS</td>
      <td>snowCoverUps.tss</td>
    </tr>
    <tr class="even">
      <td>depth of interception storage</td>
      <td>mm</td>
      <td>CumInterceptionAvUpsTS</td>
      <td>cumInterceptionUps.tss</td>
    </tr>
    <tr class="odd">
      <td>soil moisture upper layer</td>
      <td>mm<sup>3</sup> / mm<sup>3</sup></td>
      <td>Theta1AvUpsTS</td>
      <td>thTopUps.tss</td>
    </tr>
    <tr class="even">
      <td>soil moisture lower layer</td>
      <td>mm<sup>3</sup> / mm<sup>3</sup></td>
      <td>Theta2AvUpsTS</td>
      <td>thSubUps.tss</td>
    </tr>
    <tr class="odd">
      <td>groundwater upper zone</td>
      <td>mm</td>
      <td>UZAvUpsTS</td>
      <td>uzUps.tss</td>
    </tr>
    <tr class="even">
      <td>groundwater lower zone</td>
      <td>mm</td>
      <td>LZAvUpsTS</td>
      <td>lzUps.tss</td>
    </tr>
    <tr class="odd">
      <td>number of days since last rain</td>
      <td>Days</td>
      <td>DSLRAvUpsTS</td>
      <td>dslrUps.tss</td>
    </tr>
    <tr class="even">
      <td>frost index</td>
      <td>°C days<sup>-1</sup></td>
      <td>FrostIndexAvUpsTS</td>
      <td>frostUps.tss</td>
    </tr>
    <tr class="odd">
      <td><em><strong>Table A13.2</strong> LISFLOOD optional output
time series (continued from previous page)</em></td>
    </tr>
    <tr class="even">
      <td><strong>RATE VARIABLES (option <em>repRateUpsGauges</em>)</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Default name</strong></td>
    </tr>
    <tr class="even">
      <td>rain (excluding snow)</td>
      <td>mm/timestep</td>
      <td>RainAvUpsTS</td>
      <td>rainUps.tss</td>
    </tr>
    <tr class="odd">
      <td>snow</td>
      <td>mm/timestep</td>
      <td>SnowAvUpsTS</td>
      <td>snowUps.tss</td>
    </tr>
    <tr class="even">
      <td>snow melt</td>
      <td>mm/timestep</td>
      <td>SnowmeltAvUpsTS</td>
      <td>snowMeltUps.tss</td>
    </tr>
    <tr class="odd">
      <td>actual evaporation</td>
      <td>mm/timestep</td>
      <td>ESActAvUpsTS</td>
      <td>esActUps.tss</td>
    </tr>
    <tr class="even">
      <td>actual transpiration</td>
      <td>mm/timestep</td>
      <td>TaAvUpsTS</td>
      <td>tActUps.tss</td>
    </tr>
    <tr class="odd">
      <td>rainfall interception</td>
      <td>mm/timestep</td>
      <td>InterceptionAvUpsTS</td>
      <td>interceptionUps.tss</td>
    </tr>
    <tr class="even">
      <td>evaporation of intercepted water</td>
      <td>mm/timestep</td>
      <td>EWIntAvUpsTS</td>
      <td>ewIntActUps.tss</td>
    </tr>
    <tr class="odd">
      <td>leaf drainage</td>
      <td>mm/timestep</td>
      <td>LeafDrainageAvUpsTS</td>
      <td>leafDrainageUps.tss</td>
    </tr>
    <tr class="even">
      <td>infiltration</td>
      <td>mm/timestep</td>
      <td>InfiltrationAvUpsTS</td>
      <td>infiltrationUps.tss</td>
    </tr>
    <tr class="odd">
      <td>preferential (bypass) flow</td>
      <td>mm/timestep</td>
      <td>PrefFlowAvUpsTS</td>
      <td>prefFlowUps.tss</td>
    </tr>
    <tr class="even">
      <td>
      <p>percolation upper to lower</p>
      <p>soil layer</p>
      </td>
      <td>mm/timestep</td>
      <td>PercolationAvUpsTS</td>
      <td>dTopToSubUps.tss</td>
    </tr>
    <tr class="odd">
      <td>
      <p>percolation lower soil layer</p>
      <p>to subsoil</p>
      </td>
      <td>mm/timestep</td>
      <td>SeepSubToGWAvUpsTS</td>
      <td>dSubToUzUps.tss</td>
    </tr>
    <tr class="even">
      <td>surface runoff</td>
      <td>mm/timestep</td>
      <td>SurfaceRunoffAvUpsTS</td>
      <td>surfaceRunoffUps.tss</td>
    </tr>
    <tr class="odd">
      <td>outflow from upper zone</td>
      <td>mm/timestep</td>
      <td>UZOutflowAvUpsTS</td>
      <td>qUzUps.tss</td>
    </tr>
    <tr class="even">
      <td>outflow from lower zone</td>
      <td>mm/timestep</td>
      <td>LZOutflowAvUpsTS</td>
      <td>qLzUps.tss</td>
    </tr>
    <tr class="odd">
      <td>total runoff</td>
      <td>mm/timestep</td>
      <td>TotalRunoffAvUpsTS</td>
      <td>totalRunoffUps.tss</td>
    </tr>
    <tr class="even">
      <td>percolation upper to lower zone</td>
      <td>mm/timestep</td>
      <td>GwPercUZLZAvUpsTS</td>
      <td>percUZLZUps.tss</td>
    </tr>
    <tr class="odd">
      <td>loss from lower zone</td>
      <td>mm/timestep</td>
      <td>GwLossTS</td>
      <td>lossUps.tss</td>
    </tr>
  </tbody>
</table>

<table>

  <tbody>
    <tr class="odd">
      <td><strong>WATER LEVEL IN CHANNEL (option <em>repWaterLevelTs</em>)</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Default name</strong></td>
    </tr>
    <tr class="odd">
      <td>water level in channel</td>
      <td>m (above channel bottom)</td>
      <td>WaterLevelTS</td>
      <td>waterLevel.tss</td>
    </tr>
  </tbody>
</table>

<p>Finally, some additional output options exist that don’t fit in any
of the above categories.</p>

<table>

  <tbody>
    <tr class="odd">
      <td><strong>OUTPUT RELATED TO LOWER ZONE INITIALISATION</strong></td>
    </tr>
    <tr class="even">
      <td><strong>Description</strong></td>
      <td><strong>Option</strong></td>
      <td><br>
      </td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Default name</strong></td>
    </tr>
    <tr class="odd">
      <td>average inflow into lower zone</td>
      <td>repLZAvInflowSites</td>
      <td>mm day<sup>-1</sup></td>
      <td>LZAvInflowTS</td>
      <td>lzAvIn.tss</td>
    </tr>
    <tr class="even">
      <td>average inflow into lower zone</td>
      <td>repLZAvInflowUpsGauges</td>
      <td>mm day<sup>-1</sup></td>
      <td>LZAvInflowAvUpsTS</td>
      <td>lzAvInUps.tss</td>
    </tr>
  </tbody>
</table>

<h2 id="maps-1"><br>
Maps</h2>

<table>

  <tbody>
    <tr class="odd">
      <td><em><strong>Table A13.3</strong> LISFLOOD default output maps</em></td>
    </tr>
    <tr class="even">
      <td><strong>AVERAGE RECHARGE MAP (for lower groundwater zone)</strong>
(option InitLisflood)</td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>File name</strong></td>
      <td><strong>Domain</strong></td>
    </tr>
    <tr class="even">
      <td><strong><sup>1</sup></strong> average inflow to lower zone</td>
      <td>mm day<sup>-1</sup></td>
      <td>lzavin.map</td>
      <td>other fraction</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>1</sup></strong> average inflow to lower zone
(forest)</td>
      <td>mm day<sup>-1</sup></td>
      <td>lzavin_forest.map</td>
      <td>forest fraction</td>
    </tr>
    <tr class="even">
      <td><strong>INITIAL CONDITION MAPS at defined time steps</strong><a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a>
(option <em>repStateMaps</em>)</td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>File name</strong><a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a></td>
      <td><strong>Domain</strong></td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> waterdepth</td>
      <td>mm</td>
      <td>wdepth00.xxx</td>
      <td>whole pixel</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> channel cross-sectional area</td>
      <td>m<sup>2</sup></td>
      <td>chcro000.xxx</td>
      <td>channel</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> days since last rain variable</td>
      <td>days</td>
      <td>dslr0000.xxx</td>
      <td>other pixel</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> snow cover zone <em>A</em></td>
      <td>mm</td>
      <td>scova000.xxx</td>
      <td>snow zone A (1/3<sup>rd</sup> pixel)</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> snow cover zone <em>B</em></td>
      <td>mm</td>
      <td>scovb000.xxx</td>
      <td>snow zone B (1/3<sup>rd</sup> pixel)</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> snow cover zone <em>C</em></td>
      <td>mm</td>
      <td>scovc000.xxx</td>
      <td>snow zone C (1/3<sup>rd</sup> pixel)</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> frost index</td>
      <td>°C days<sup>-1</sup></td>
      <td>frost000.xxx</td>
      <td>other pixel</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> cumulative interception</td>
      <td>mm</td>
      <td>cumi0000.xxx</td>
      <td>other pixel</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> soil moisture upper layer</td>
      <td>mm<sup>3</sup>/mm<sup>3</sup></td>
      <td>thtop000.xxx</td>
      <td>other fraction</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> soil moisture lower layer</td>
      <td>mm<sup>3</sup>/mm<sup>3</sup></td>
      <td>thsub000.xxx</td>
      <td>other fraction</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> water in lower zone</td>
      <td>mm</td>
      <td>lz000000.xxx</td>
      <td>other fraction</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> water in upper zone</td>
      <td>mm</td>
      <td>uz000000.xxx</td>
      <td>other fraction</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> days since last rain variable
(forest)</td>
      <td>days</td>
      <td>dslF0000.xxx</td>
      <td>forest pixel</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> cumulative interception (forest)</td>
      <td>mm</td>
      <td>cumF0000.xxx</td>
      <td>forest pixel</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> soil moisture upper layer
(forest)</td>
      <td>mm<sup>3</sup>/mm<sup>3</sup></td>
      <td>thFt0000.xxx</td>
      <td>forest fraction</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> soil moisture lower layer
(forest)</td>
      <td>mm<sup>3</sup>/mm<sup>3</sup></td>
      <td>thFs0000.xxx</td>
      <td>forest fraction</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> water in lower zone (forest)</td>
      <td>mm</td>
      <td>lzF00000.xxx</td>
      <td>forest fraction</td>
    </tr>
    <tr class="odd">
      <td><strong><sup>2</sup></strong> water in upper zone (forest)</td>
      <td>mm</td>
      <td>uzF00000.xxx</td>
      <td>forest fraction</td>
    </tr>
    <tr class="even">
      <td><strong><sup>2</sup></strong> water in depression storage
(sealed)</td>
      <td>mm</td>
      <td>cseal000.xxx</td>
      <td>sealed fraction</td>
    </tr>
    <tr class="odd">
      <td>
      <p><strong><sup>1</sup></strong> Output only if option
‘InitLisflood’ = 1 (pre-run)</p>
      <p><strong><sup>2</sup></strong> Output only if option
‘InitLisflood’ = 0</p>
      </td>
    </tr>
  </tbody>
</table>

<table>

  <tbody>
    <tr class="odd">
      <td>
      <p><strong><br>
      <em>Table A13.4</em></strong> <em>LISFLOOD optional output maps (</em>only
‘InitLisflood’ = 0)</p>
      <p><em>(continued on next page)</em></p>
      </td>
    </tr>
    <tr class="even">
      <td><strong>DISCHARGE AND WATER LEVEL</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Option</strong></td>
      <td><strong>Units</strong></td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Prefix</strong></td>
    </tr>
    <tr class="even">
      <td>discharge</td>
      <td>repDischargeMaps</td>
      <td>m<sup>3</sup>s<sup>-1</sup></td>
      <td>DischargeMaps</td>
      <td>dis</td>
    </tr>
    <tr class="odd">
      <td>water level</td>
      <td>repWaterLevelMaps</td>
      <td>m (above channel bottom)</td>
      <td>WaterLevelMaps</td>
      <td>wl</td>
    </tr>
    <tr class="even">
      <td><strong>METEOROLOGICAL INPUT VARIABLES</strong></td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Option</strong></td>
      <td><br>
      </td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Prefix</strong></td>
    </tr>
    <tr class="even">
      <td>precipitation</td>
      <td>repPrecipitationMaps</td>
      <td>mm</td>
      <td>PrecipitationMaps</td>
      <td>pr</td>
    </tr>
    <tr class="odd">
      <td>potential reference evapotranspiration</td>
      <td>repETRefMaps</td>
      <td>mm</td>
      <td>ETRefMaps</td>
      <td>et</td>
    </tr>
    <tr class="even">
      <td>potential evaporation from soil</td>
      <td>repESRefMaps</td>
      <td>mm</td>
      <td>ESRefMaps</td>
      <td>es</td>
    </tr>
    <tr class="odd">
      <td>potential open water evaporation</td>
      <td>repEWRefMaps</td>
      <td>mm</td>
      <td>EWRefMaps</td>
      <td>ew</td>
    </tr>
    <tr class="even">
      <td>average daily temperature</td>
      <td>repTavgMaps</td>
      <td>mm</td>
      <td>TavgMaps</td>
      <td>tav</td>
    </tr>
    <tr class="odd">
      <td><strong>STATE VARIABLES</strong><a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a></td>
    </tr>
    <tr class="even">
      <td><strong>Description</strong></td>
      <td><strong>Option</strong></td>
      <td><br>
      </td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Prefix</strong></td>
    </tr>
    <tr class="odd">
      <td>depth of water on soil surface</td>
      <td>repWaterDepthMaps</td>
      <td>mm</td>
      <td>WaterDepthMaps</td>
      <td>wdep</td>
    </tr>
    <tr class="even">
      <td>depth of snow cover on soil surface</td>
      <td>repSnowCoverMaps</td>
      <td>mm</td>
      <td>SnowCoverMaps</td>
      <td>scov</td>
    </tr>
    <tr class="odd">
      <td>depth of interception storage</td>
      <td>repCumInterceptionMaps</td>
      <td>mm</td>
      <td>
      <p>CumInterceptionMaps</p>
      <p>CumInterceptionForestMaps</p>
      </td>
      <td>
      <p>cumi</p>
      <p>cumF</p>
      </td>
    </tr>
    <tr class="even">
      <td>soil moisture content upper layer</td>
      <td>repTheta1Maps</td>
      <td>mm<sup>3</sup> /mm<sup>3</sup></td>
      <td>
      <p>Theta1Maps</p>
      <p>Theta1ForestMaps</p>
      </td>
      <td>
      <p>thtop</p>
      <p>thFt</p>
      </td>
    </tr>
    <tr class="odd">
      <td>soil moisture content lower layer</td>
      <td>repTheta2Maps</td>
      <td>mm<sup>3</sup> /mm<sup>3</sup></td>
      <td>
      <p>Theta2Maps</p>
      <p>Theta2ForestMaps</p>
      </td>
      <td>
      <p>thsub</p>
      <p>thFs</p>
      </td>
    </tr>
    <tr class="even">
      <td>storage in upper groundwater zone</td>
      <td>repUZMaps</td>
      <td>mm</td>
      <td>
      <p>UZMaps</p>
      <p>UZForestMaps</p>
      </td>
      <td>
      <p>uz</p>
      <p>uzF</p>
      </td>
    </tr>
    <tr class="odd">
      <td>storage in lower groundwater zone</td>
      <td>repLZMaps</td>
      <td>mm</td>
      <td>
      <p>LZMaps</p>
      <p>LZForestMaps</p>
      </td>
      <td>
      <p>lz</p>
      <p>lzF</p>
      </td>
    </tr>
    <tr class="even">
      <td>number of days since last rain</td>
      <td>repDSLRMaps</td>
      <td>days</td>
      <td>
      <p>DSLRMaps</p>
      <p>DSLRForestMaps</p>
      </td>
      <td>
      <p>dslr</p>
      <p>dslF</p>
      </td>
    </tr>
    <tr class="odd">
      <td>frost index</td>
      <td>repFrostIndexMaps</td>
      <td>°C days<sup>-1</sup></td>
      <td>FrostIndexMaps</td>
      <td>frost</td>
    </tr>
    <tr class="even">
      <td><strong>RATE VARIABLES</strong><a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a></td>
    </tr>
    <tr class="odd">
      <td><strong>Description</strong></td>
      <td><strong>Option</strong></td>
      <td><br>
      </td>
      <td><strong>Settings variable</strong></td>
      <td><strong>Prefix</strong></td>
    </tr>
    <tr class="even">
      <td>rain (excluding snow)</td>
      <td>repRainMaps</td>
      <td>mm/timestep</td>
      <td>RainMaps</td>
      <td>rain</td>
    </tr>
    <tr class="odd">
      <td>snow</td>
      <td>repSnowMaps</td>
      <td>mm/timestep</td>
      <td>SnowMaps</td>
      <td>snow</td>
    </tr>
    <tr class="even">
      <td>snow melt</td>
      <td>repSnowMeltMaps</td>
      <td>mm/timestep</td>
      <td>SnowMeltMaps</td>
      <td>smelt</td>
    </tr>
    <tr class="odd">
      <td>actual evaporation</td>
      <td>repESActMaps</td>
      <td>mm/timestep</td>
      <td>ESActMaps</td>
      <td>esact</td>
    </tr>
    <tr class="even">
      <td>actual transpiration</td>
      <td>repTaMaps</td>
      <td>mm/timestep</td>
      <td>TaMaps</td>
      <td>tact</td>
    </tr>
    <tr class="odd">
      <td>rainfall interception</td>
      <td>repInterceptionMaps</td>
      <td>mm/timestep</td>
      <td>InterceptionMaps</td>
      <td>int</td>
    </tr>
    <tr class="even">
      <td>evaporation of intercepted water</td>
      <td>repEWIntMaps</td>
      <td>mm/timestep</td>
      <td>EWIntMaps</td>
      <td>ewint</td>
    </tr>
    <tr class="odd">
      <td>leaf drainage</td>
      <td>repLeafDrainageMaps</td>
      <td>mm/timestep</td>
      <td>LeafDrainageMaps</td>
      <td>ldra</td>
    </tr>
    <tr class="even">
      <td>infiltration</td>
      <td>repInfiltrationMaps</td>
      <td>mm/timestep</td>
      <td>InfiltrationMaps</td>
      <td>inf</td>
    </tr>
    <tr class="odd">
      <td>preferential (bypass) flow</td>
      <td>repPrefFlowMaps</td>
      <td>mm/timestep</td>
      <td>PrefFlowMaps</td>
      <td>pflow</td>
    </tr>
    <tr class="even">
      <td>percolation upper to lower soil layer</td>
      <td>repPercolationMaps</td>
      <td>mm/timestep</td>
      <td>PercolationMaps</td>
      <td>to2su</td>
    </tr>
    <tr class="odd">
      <td><em><strong>Table 12.4</strong> LISFLOOD optional output maps
(continued from previous page)</em></td>
    </tr>
    <tr class="even">
      <td>percolation lower soil layer to subsoil</td>
      <td>repSeepSubToGWMaps</td>
      <td>mm/timestep</td>
      <td>SeepSubToGWMaps</td>
      <td>su2gw</td>
    </tr>
    <tr class="odd">
      <td>surface runoff</td>
      <td>repSurfaceRunoffMaps</td>
      <td>mm/timestep</td>
      <td>SurfaceRunoffMaps</td>
      <td>srun</td>
    </tr>
    <tr class="even">
      <td>outflow from upper zone</td>
      <td>repUZOutflowMaps</td>
      <td>mm/timestep</td>
      <td>UZOutflowMaps</td>
      <td>quz</td>
    </tr>
    <tr class="odd">
      <td>outflow from lower zone</td>
      <td>repLZOutflowMaps</td>
      <td>mm/timestep</td>
      <td>LZOutflowMaps</td>
      <td>qlz</td>
    </tr>
    <tr class="even">
      <td>total runoff</td>
      <td>repTotalRunoffMaps</td>
      <td>mm/timestep</td>
      <td>TotalRunoffMaps</td>
      <td>trun</td>
    </tr>
    <tr class="odd">
      <td>percolation upper to lower zone</td>
      <td>repGwPercUZLZMaps</td>
      <td>mm/timestep</td>
      <td>GwPercUZLZMaps</td>
      <td>uz2lz</td>
    </tr>
    <tr class="even">
      <td>loss from lower zone</td>
      <td>rep GwLossMaps</td>
      <td>mm/timestep</td>
      <td>GwLossMaps</td>
      <td>loss</td>
    </tr>
  </tbody>
</table>

<h1 id="index">Index</h1>

<p>Actual infiltration, 19Additional output, 74AvWaterRateThreshold,
48b_Xinanjiang, 51CalChanMan, 52CalendarDayStart, 46CalEvaporation,
48Channel routing, 25cold start, 63crop coefficient, 14Default LISFLOOD
output, 73degree-day factor, 5Direct evaporation, 16direct runoff
fraction’, 10Double kinematic, 101DtSec, 46DtSecChannel, 46Dynamic
wave, 107Evaporation, 13evapotranspiration, 5Frost index,
8FrostIndexThreshold, 50Groundwater, 22GwLoss, 52GwPercValue,
51icemelt, 7Impervious surface, 11Infiltration capacity, 17Inflow
hydrograph, 97Initial conditions, 56Initialisation, 62Input maps,
29Input tables, 32Interception, 12kdf, 48kinematic wave equations,
25Lakes, 91Leaf Area Index, 12Leaf area index maps,
32LeafDrainageTimeConstant, 48lfbinding, 36lfoption, 42lfuser,
36LISVAP, 5LowerZoneTimeConstant, 51map stack, 30mask map, 29number of
days since the last rain, 16PathMaps, 54PathOut, 54PathTables,
54PCRaster, 1pF values, 121Polder, 85PowerPrefFlow, 51Precipitation,
5Preferential bypass flow, 18Prefixes, 55pre-run, 68PrScaling,
48QSplitMult, 103Rain, 5Reduction of transpiration in case of water,
15ReportSteps, 46reservoirs, 79Routing of surface runoff, 23seasonal
variable melt factor, 6settings file, 35SMaxSealed, 48snow,
5SnowFactor, 50SnowMeltCoef, 50SnowSeasonAdj, 50SnowWaterEquivalent,
50Soil moisture redistribution, 20StepEnd, 46StepStart, 46sub-grid
variability, 9temperature lapse rate, 7TemperatureLapseRate,
50TempMelt, 50TempSnow, 50transmission loss, 111transpiration,
14UpperZoneTimeConstant, 51Using options, 61warm start, 70water
fraction, 10water levels, 119Water uptake by plant roots, 14water use,
115Xinanjiang model, 17</p>

<p><img src="e:%5Cgh-pages%5C/media/image147.jpeg" style="width: 1.31528in; height: 1.08472in;"><img src="e:%5Cgh-pages%5C/media/image148.png" style="width: 1.59306in; height: 0.75347in;"><img src="e:%5Cgh-pages%5C/media/image149.png" style="width: 8.26667in; height: 1.47639in;">z</p>

<section class="footnotes">
</section>
<hr>
<ol>

  <li id="fn1">
    <p>Note that the model needs <em>daily</em> average
temperature values, even if the model is run on a smaller time interval
(e.g. hourly). This is because the routines for snowmelt and soil
freezing are use empirical relations which are based on daily
temperature data. Just as an example, feeding hourly temperature data
into the snowmelt routine can result in a gross overestimation of
snowmelt. This is because even on a day on which the average
temperature is below <em>T<sub>m</sub></em> (no snowmelt), the
instantaneous (or hourly) temperature may be higher for a part of the
day, leading to unrealistically high simulated snowmelt rates.<a href="#fnref1" class="footnote-back">↩</a></p>
  </li>
  <li id="fn2">
    <p>In the LISFLOOD settings file this critical amount is currently
expressed as an <em>intensity</em> [mm day<sup>-1</sup>].
This is because the equation was originally designed for a daily time
step only. Because the current implementation will likely lead to <em>DSLR</em>
being reset too frequently, the exact formulation may change in future
versions (e.g. by keeping track of the accumulated available water of
the last 24 hours).<a href="#fnref2" class="footnote-back">↩</a></p>
  </li>
  <li id="fn3">
    <p>The file names listed in the table are not obligatory.
However, it is suggested to stick to the default names suggested in the
table. This will make both setting up the model for new catchments as
well as upgrading to possible future LISFLOOD versions much easier.<a href="#fnref3" class="footnote-back">↩</a></p>
  </li>
  <li id="fn4">
    <p>The reason why <em>–listoptions</em> produces
“default=0” for the reservoirs option, is that –internally within the
model- the reservoir option consists of two blocks of code: one block
is the actual reservoir code, and another one is some dummy code that
is activated if the reservoirs option is switched off (the dummy code
is needed because some internal model variables that are associated
with reservoirs need to be defined, even if no reservoirs are
simulated). Both blocks are associated with “<em>simulateReservoirs=1</em>”
and “<em>simulateReservoirs=0</em>”, respectively, where the “<em>simulateReservoirs=0</em>”
block is marked as the default choice. In case of the “<em>repDischargeMaps</em>”
option, there <em>is</em> no block of code that is associated with “<em>repDischargeMaps=0</em>”,
hence formally there is no default value.<a href="#fnref4" class="footnote-back">↩</a></p>
  </li>
  <li id="fn5">
    <p>Can be disabled by either option <em>repStateMaps=0 or setting
ReportSteps to a high value e.g. &lt;textvar name="ReportSteps"
value="99999"&gt;</em><a href="#fnref5" class="footnote-back">↩</a></p>
  </li>
  <li id="fn6">
    <p>Output time steps are defined with ReportSteps in the
settings file (see chapter 5) or only for the last time step with
option ‘repEndMaps’<a href="#fnref6" class="footnote-back">↩</a></p>
  </li>
  <li id="fn7">
    <p>xxx represents the number of the last time step; e.g.
or a 730-step simulation the end map of ‘waterdepth’ will be
‘wdepth00.730’, and so on.<a href="#fnref7" class="footnote-back">↩</a></p>
  </li>
  <li id="fn8">
    <p>xxx represents the number of the last time step; e.g. for a
730-step simulation the name will be ‘rsfil000.730’, and so on.<a href="#fnref8" class="footnote-back">↩</a></p>
  </li>
  <li id="fn9">
    <p>xxx represents the number of the last time step; e.g. for a
730-step simulation the name will be ‘hpol0000.730’, and so on.<a href="#fnref9" class="footnote-back">↩</a></p>
  </li>
  <li id="fn10">
    <p>xxx represents the number of the last time step; e.g. for a
730-step simulation the name will be ‘lakh0000.730’, and so on.<a href="#fnref10" class="footnote-back">↩</a></p>
  </li>
  <li id="fn11">
    <p>Actually, the –listoptions switch will show you a
couple of options that are not listed in Table 6.1. These are either
debugging options (which are irrelevant to the model user) or
experimental features that may not be completely finalised (and thus
remain undocumented here until they are)<a href="#fnref11" class="footnote-back">↩</a></p>
  </li>
  <li id="fn12">
    <p>This option can only be used in combination with the
‘simulateWaterLevels’ option!<a href="#fnref12" class="footnote-back">↩</a></p>
  </li>
  <li id="fn13">
    <p>This option can only be used in combination with the
‘simulateWaterLevels’ option!<a href="#fnref13" class="footnote-back">↩</a></p>
  </li>
  <li id="fn14">
    <p>Deprecated; this feature may not be supported in forthcoming
LISFLOOD releases. Use <em>repStateMaps</em> instead, which gives you
the same maps with the added possibility to report them for any
required time step(s).<a href="#fnref14" class="footnote-back">↩</a></p>
  </li>
  <li id="fn15">
    <p>The file names listed in the table are not obligatory.
However, it is suggested to stick to the default names suggested in the
table. This will make both setting up the model for new catchments as
well as upgrading to possible future LISFLOOD versions much easier.<a href="#fnref15" class="footnote-back">↩</a></p>
  </li>
  <li id="fn16">
    <p>State variables represents the state of a variable at
the end of a time step (or beginning of the next time step (e.g. Hiking
analogy: walked kilometer till the first break)<a href="#fnref16" class="footnote-back">↩</a></p>
  </li>
  <li id="fn17">
    <p>Rate variable represents the average flux between
beginning and end of a time step (e.g. hiking analogy: speed of walking
during the first part)<a href="#fnref17" class="footnote-back">↩</a></p>
  </li>
  <li id="fn18">
    <p>Output time steps are defined with ReportSteps in the
settings file (see chapter 5) or only for the last time step with
option ‘repEndMaps’<a href="#fnref18" class="footnote-back">↩</a></p>
  </li>
  <li id="fn19">
    <p>xxx represents the number of the last time step; e.g.
or a 730-step simulation the end map of ‘waterdepth’ will be
‘wdepth00.730’, and so on.<a href="#fnref19" class="footnote-back">↩</a></p>
  </li>
  <li id="fn20">
    <p>State variables represents the state of a variable at
the end of a time step (or beginning of the next time step (e.g. Hiking
analogy: walked kilometer till the first break)<a href="#fnref20" class="footnote-back">↩</a></p>
  </li>
  <li id="fn21">
    <p>Rate variable represents the average flux between
beginning and end of a time step (e.g. hiking analogy: speed of walking
during the first part)<a href="#fnref21" class="footnote-back">↩</a></p>
  </li>
</ol>

</body></html>
